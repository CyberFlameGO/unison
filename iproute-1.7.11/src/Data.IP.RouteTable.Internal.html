<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP           #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-comment">{-|
  IP routing table is a tree of 'AddrRange'
  to search one of them on the longest
  match base. It is a kind of TRIE with one
  way branching removed. Both IPv4 and IPv6
  are supported.
-}</span><span>
</span><span id="line-11"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.IP.RouteTable.Internal</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">empty</span></span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">A</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">empty</span></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bits</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Foldable</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.IP.Addr.html"><span class="hs-identifier">Data.IP.Addr</span></a></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.IP.Op.html"><span class="hs-identifier">Data.IP.Op</span></a></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.IP.Range.html"><span class="hs-identifier">Data.IP.Range</span></a></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.IntMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">IntMap</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.IntMap</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromList</span></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Monoid</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&lt;&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Semigroup</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Traversable</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Word</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Generic1</span></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">lookup</span></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-comment">----------------------------------------------------------------</span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="hs-comment">{-|
  A class to contain IPv4 and IPv6.
-}</span><span>
</span><span id="line-35"></span><span class="hs-keyword">class</span><span> </span><span class="annot"><a href="Data.IP.Op.html#Addr"><span class="hs-identifier hs-type">Addr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054266"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="Routable"><span class="annot"><a href="Data.IP.RouteTable.Internal.html#Routable"><span class="hs-identifier hs-var">Routable</span></a></span></span><span> </span><span id="local-6989586621679054266"><span class="annot"><a href="#local-6989586621679054266"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-comment">{-|
      The 'intToTBit' function takes 'Int' and returns an 'Routable' address
      whose only n-th bit is set.
    -}</span><span>
</span><span id="line-40"></span><span>    </span><span id="intToTBit"><span class="annot"><a href="Data.IP.RouteTable.Internal.html#intToTBit"><span class="hs-identifier hs-type">intToTBit</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679054266"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-comment">{-|
      The 'isZero' function takes an 'Routable' address and an test bit
      'Routable' address and returns 'True' is the bit is unset,
      otherwise returns 'False'.
    -}</span><span>
</span><span id="line-46"></span><span>    </span><span id="isZero"><span class="annot"><a href="Data.IP.RouteTable.Internal.html#isZero"><span class="hs-identifier hs-type">isZero</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679054266"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679054266"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#Routable"><span class="hs-identifier hs-type">Routable</span></a></span><span> </span><span class="annot"><a href="Data.IP.Addr.html#IPv4"><span class="hs-identifier hs-type">IPv4</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-49"></span><span>    </span><span id="local-6989586621679054044"><span class="annot"><span class="annottext">intToTBit :: Int -&gt; IPv4
</span><a href="#local-6989586621679054044"><span class="hs-identifier hs-var hs-var hs-var hs-var">intToTBit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IPv4
</span><a href="Data.IP.RouteTable.Internal.html#intToTBitIPv4"><span class="hs-identifier hs-var">intToTBitIPv4</span></a></span><span>
</span><span id="line-50"></span><span>    </span><span id="local-6989586621679054042"><span class="annot"><span class="annottext">isZero :: IPv4 -&gt; IPv4 -&gt; Bool
</span><a href="#local-6989586621679054042"><span class="hs-identifier hs-var hs-var hs-var hs-var">isZero</span></a></span></span><span> </span><span id="local-6989586621679054041"><span class="annot"><span class="annottext">IPv4
</span><a href="#local-6989586621679054041"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679054040"><span class="annot"><span class="annottext">IPv4
</span><a href="#local-6989586621679054040"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IPv4
</span><a href="#local-6989586621679054041"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">IPv4 -&gt; IPv4 -&gt; IPv4
forall a. Addr a =&gt; a -&gt; a -&gt; a
</span><a href="Data.IP.Op.html#masked"><span class="hs-operator hs-var">`masked`</span></a></span><span> </span><span class="annot"><span class="annottext">IPv4
</span><a href="#local-6989586621679054040"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">IPv4 -&gt; IPv4 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">IPv4Addr -&gt; IPv4
</span><a href="Data.IP.Addr.html#IP4"><span class="hs-identifier hs-var">IP4</span></a></span><span> </span><span class="annot"><span class="annottext">IPv4Addr
</span><span class="hs-number">0</span></span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#Routable"><span class="hs-identifier hs-type">Routable</span></a></span><span> </span><span class="annot"><a href="Data.IP.Addr.html#IPv6"><span class="hs-identifier hs-type">IPv6</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-53"></span><span>    </span><span id="local-6989586621679054034"><span class="annot"><span class="annottext">intToTBit :: Int -&gt; IPv6
</span><a href="#local-6989586621679054034"><span class="hs-identifier hs-var hs-var hs-var hs-var">intToTBit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IPv6
</span><a href="Data.IP.RouteTable.Internal.html#intToTBitIPv6"><span class="hs-identifier hs-var">intToTBitIPv6</span></a></span><span>
</span><span id="line-54"></span><span>    </span><span id="local-6989586621679054032"><span class="annot"><span class="annottext">isZero :: IPv6 -&gt; IPv6 -&gt; Bool
</span><a href="#local-6989586621679054032"><span class="hs-identifier hs-var hs-var hs-var hs-var">isZero</span></a></span></span><span> </span><span id="local-6989586621679054031"><span class="annot"><span class="annottext">IPv6
</span><a href="#local-6989586621679054031"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679054030"><span class="annot"><span class="annottext">IPv6
</span><a href="#local-6989586621679054030"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IPv6
</span><a href="#local-6989586621679054031"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">IPv6 -&gt; IPv6 -&gt; IPv6
forall a. Addr a =&gt; a -&gt; a -&gt; a
</span><a href="Data.IP.Op.html#masked"><span class="hs-operator hs-var">`masked`</span></a></span><span> </span><span class="annot"><span class="annottext">IPv6
</span><a href="#local-6989586621679054030"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">IPv6 -&gt; IPv6 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">IPv6Addr -&gt; IPv6
</span><a href="Data.IP.Addr.html#IP6"><span class="hs-identifier hs-var">IP6</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IPv4Addr
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">IPv4Addr
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">IPv4Addr
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">IPv4Addr
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="hs-comment">----------------------------------------------------------------</span><span>
</span><span id="line-57"></span><span class="hs-comment">--</span><span>
</span><span id="line-58"></span><span class="hs-comment">-- Test Bit</span><span>
</span><span id="line-59"></span><span class="hs-comment">--</span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#intToTBitIPv4"><span class="hs-identifier hs-type">intToTBitIPv4</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.IP.Addr.html#IPv4"><span class="hs-identifier hs-type">IPv4</span></a></span><span>
</span><span id="line-62"></span><span id="intToTBitIPv4"><span class="annot"><span class="annottext">intToTBitIPv4 :: Int -&gt; IPv4
</span><a href="Data.IP.RouteTable.Internal.html#intToTBitIPv4"><span class="hs-identifier hs-var hs-var">intToTBitIPv4</span></a></span></span><span> </span><span id="local-6989586621679054028"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054028"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IPv4Addr -&gt; IPv4
</span><a href="Data.IP.Addr.html#IP4"><span class="hs-identifier hs-var">IP4</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap IPv4Addr
</span><a href="Data.IP.RouteTable.Internal.html#intToTBitsIPv4"><span class="hs-identifier hs-var">intToTBitsIPv4</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap IPv4Addr -&gt; Int -&gt; IPv4Addr
forall a. IntMap a -&gt; Int -&gt; a
</span><span class="hs-glyph hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054028"><span class="hs-identifier hs-var">len</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#intToTBitIPv6"><span class="hs-identifier hs-type">intToTBitIPv6</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.IP.Addr.html#IPv6"><span class="hs-identifier hs-type">IPv6</span></a></span><span>
</span><span id="line-65"></span><span id="intToTBitIPv6"><span class="annot"><span class="annottext">intToTBitIPv6 :: Int -&gt; IPv6
</span><a href="Data.IP.RouteTable.Internal.html#intToTBitIPv6"><span class="hs-identifier hs-var hs-var">intToTBitIPv6</span></a></span></span><span> </span><span id="local-6989586621679054026"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054026"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IPv6Addr -&gt; IPv6
</span><a href="Data.IP.Addr.html#IP6"><span class="hs-identifier hs-var">IP6</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap IPv6Addr
</span><a href="Data.IP.RouteTable.Internal.html#intToTBitsIPv6"><span class="hs-identifier hs-var">intToTBitsIPv6</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap IPv6Addr -&gt; Int -&gt; IPv6Addr
forall a. IntMap a -&gt; Int -&gt; a
</span><span class="hs-glyph hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054026"><span class="hs-identifier hs-var">len</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#intToTBitsWord32"><span class="hs-identifier hs-type">intToTBitsWord32</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">]</span><span>
</span><span id="line-68"></span><span id="intToTBitsWord32"><span class="annot"><span class="annottext">intToTBitsWord32 :: [IPv4Addr]
</span><a href="Data.IP.RouteTable.Internal.html#intToTBitsWord32"><span class="hs-identifier hs-var hs-var">intToTBitsWord32</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(IPv4Addr -&gt; IPv4Addr) -&gt; IPv4Addr -&gt; [IPv4Addr]
forall a. (a -&gt; a) -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">iterate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IPv4Addr -&gt; Int -&gt; IPv4Addr
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`shift`</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IPv4Addr
</span><span class="hs-number">0x80000000</span></span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#intToTBitsIPv4"><span class="hs-identifier hs-type">intToTBitsIPv4</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IntMap</span></span><span> </span><span class="annot"><a href="Data.IP.Addr.html#IPv4Addr"><span class="hs-identifier hs-type">IPv4Addr</span></a></span><span>
</span><span id="line-71"></span><span id="intToTBitsIPv4"><span class="annot"><span class="annottext">intToTBitsIPv4 :: IntMap IPv4Addr
</span><a href="Data.IP.RouteTable.Internal.html#intToTBitsIPv4"><span class="hs-identifier hs-var hs-var">intToTBitsIPv4</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Int, IPv4Addr)] -&gt; IntMap IPv4Addr
forall a. [(Int, a)] -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(Int, IPv4Addr)] -&gt; IntMap IPv4Addr)
-&gt; [(Int, IPv4Addr)] -&gt; IntMap IPv4Addr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; [IPv4Addr] -&gt; [(Int, IPv4Addr)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[IPv4Addr]
</span><a href="Data.IP.RouteTable.Internal.html#intToTBitsWord32"><span class="hs-identifier hs-var">intToTBitsWord32</span></a></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#intToTBitsIPv6"><span class="hs-identifier hs-type">intToTBitsIPv6</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IntMap</span></span><span> </span><span class="annot"><a href="Data.IP.Addr.html#IPv6Addr"><span class="hs-identifier hs-type">IPv6Addr</span></a></span><span>
</span><span id="line-74"></span><span id="intToTBitsIPv6"><span class="annot"><span class="annottext">intToTBitsIPv6 :: IntMap IPv6Addr
</span><a href="Data.IP.RouteTable.Internal.html#intToTBitsIPv6"><span class="hs-identifier hs-var hs-var">intToTBitsIPv6</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Int, IPv6Addr)] -&gt; IntMap IPv6Addr
forall a. [(Int, a)] -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(Int, IPv6Addr)] -&gt; IntMap IPv6Addr)
-&gt; [(Int, IPv6Addr)] -&gt; IntMap IPv6Addr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; [IPv6Addr] -&gt; [(Int, IPv6Addr)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">128</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[IPv6Addr]
</span><a href="#local-6989586621679054021"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-76"></span><span>    </span><span id="local-6989586621679054021"><span class="annot"><span class="annottext">bs :: [IPv6Addr]
</span><a href="#local-6989586621679054021"><span class="hs-identifier hs-var hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[IPv6Addr]
</span><a href="#local-6989586621679054020"><span class="hs-identifier hs-var">b1</span></a></span><span> </span><span class="annot"><span class="annottext">[IPv6Addr] -&gt; [IPv6Addr] -&gt; [IPv6Addr]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[IPv6Addr]
</span><a href="#local-6989586621679054019"><span class="hs-identifier hs-var">b2</span></a></span><span> </span><span class="annot"><span class="annottext">[IPv6Addr] -&gt; [IPv6Addr] -&gt; [IPv6Addr]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[IPv6Addr]
</span><a href="#local-6989586621679054018"><span class="hs-identifier hs-var">b3</span></a></span><span> </span><span class="annot"><span class="annottext">[IPv6Addr] -&gt; [IPv6Addr] -&gt; [IPv6Addr]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[IPv6Addr]
</span><a href="#local-6989586621679054017"><span class="hs-identifier hs-var">b4</span></a></span><span> </span><span class="annot"><span class="annottext">[IPv6Addr] -&gt; [IPv6Addr] -&gt; [IPv6Addr]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[IPv6Addr]
</span><a href="#local-6989586621679054016"><span class="hs-identifier hs-var">b5</span></a></span><span>
</span><span id="line-77"></span><span>    </span><span id="local-6989586621679054020"><span class="annot"><span class="annottext">b1 :: [IPv6Addr]
</span><a href="#local-6989586621679054020"><span class="hs-identifier hs-var hs-var">b1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(IPv4Addr -&gt; IPv6Addr) -&gt; [IPv4Addr] -&gt; [IPv6Addr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679054015"><span class="annot"><span class="annottext">IPv4Addr
</span><a href="#local-6989586621679054015"><span class="hs-identifier hs-var">vbit</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IPv4Addr
</span><a href="#local-6989586621679054015"><span class="hs-identifier hs-var">vbit</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">IPv4Addr
</span><a href="#local-6989586621679054014"><span class="hs-identifier hs-var">all0</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">IPv4Addr
</span><a href="#local-6989586621679054014"><span class="hs-identifier hs-var">all0</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">IPv4Addr
</span><a href="#local-6989586621679054014"><span class="hs-identifier hs-var">all0</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[IPv4Addr]
</span><a href="#local-6989586621679054013"><span class="hs-identifier hs-var">intToTBits</span></a></span><span>
</span><span id="line-78"></span><span>    </span><span id="local-6989586621679054019"><span class="annot"><span class="annottext">b2 :: [IPv6Addr]
</span><a href="#local-6989586621679054019"><span class="hs-identifier hs-var hs-var">b2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(IPv4Addr -&gt; IPv6Addr) -&gt; [IPv4Addr] -&gt; [IPv6Addr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679054012"><span class="annot"><span class="annottext">IPv4Addr
</span><a href="#local-6989586621679054012"><span class="hs-identifier hs-var">vbit</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IPv4Addr
</span><a href="#local-6989586621679054014"><span class="hs-identifier hs-var">all0</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">IPv4Addr
</span><a href="#local-6989586621679054012"><span class="hs-identifier hs-var">vbit</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">IPv4Addr
</span><a href="#local-6989586621679054014"><span class="hs-identifier hs-var">all0</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">IPv4Addr
</span><a href="#local-6989586621679054014"><span class="hs-identifier hs-var">all0</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[IPv4Addr]
</span><a href="#local-6989586621679054013"><span class="hs-identifier hs-var">intToTBits</span></a></span><span>
</span><span id="line-79"></span><span>    </span><span id="local-6989586621679054018"><span class="annot"><span class="annottext">b3 :: [IPv6Addr]
</span><a href="#local-6989586621679054018"><span class="hs-identifier hs-var hs-var">b3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(IPv4Addr -&gt; IPv6Addr) -&gt; [IPv4Addr] -&gt; [IPv6Addr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679054011"><span class="annot"><span class="annottext">IPv4Addr
</span><a href="#local-6989586621679054011"><span class="hs-identifier hs-var">vbit</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IPv4Addr
</span><a href="#local-6989586621679054014"><span class="hs-identifier hs-var">all0</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">IPv4Addr
</span><a href="#local-6989586621679054014"><span class="hs-identifier hs-var">all0</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">IPv4Addr
</span><a href="#local-6989586621679054011"><span class="hs-identifier hs-var">vbit</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">IPv4Addr
</span><a href="#local-6989586621679054014"><span class="hs-identifier hs-var">all0</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[IPv4Addr]
</span><a href="#local-6989586621679054013"><span class="hs-identifier hs-var">intToTBits</span></a></span><span>
</span><span id="line-80"></span><span>    </span><span id="local-6989586621679054017"><span class="annot"><span class="annottext">b4 :: [IPv6Addr]
</span><a href="#local-6989586621679054017"><span class="hs-identifier hs-var hs-var">b4</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(IPv4Addr -&gt; IPv6Addr) -&gt; [IPv4Addr] -&gt; [IPv6Addr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679054010"><span class="annot"><span class="annottext">IPv4Addr
</span><a href="#local-6989586621679054010"><span class="hs-identifier hs-var">vbit</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IPv4Addr
</span><a href="#local-6989586621679054014"><span class="hs-identifier hs-var">all0</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">IPv4Addr
</span><a href="#local-6989586621679054014"><span class="hs-identifier hs-var">all0</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">IPv4Addr
</span><a href="#local-6989586621679054014"><span class="hs-identifier hs-var">all0</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">IPv4Addr
</span><a href="#local-6989586621679054010"><span class="hs-identifier hs-var">vbit</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[IPv4Addr]
</span><a href="#local-6989586621679054013"><span class="hs-identifier hs-var">intToTBits</span></a></span><span>
</span><span id="line-81"></span><span>    </span><span id="local-6989586621679054016"><span class="annot"><span class="annottext">b5 :: [IPv6Addr]
</span><a href="#local-6989586621679054016"><span class="hs-identifier hs-var hs-var">b5</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>              </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">IPv4Addr
</span><a href="#local-6989586621679054014"><span class="hs-identifier hs-var">all0</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">IPv4Addr
</span><a href="#local-6989586621679054014"><span class="hs-identifier hs-var">all0</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">IPv4Addr
</span><a href="#local-6989586621679054014"><span class="hs-identifier hs-var">all0</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">IPv4Addr
</span><a href="#local-6989586621679054014"><span class="hs-identifier hs-var">all0</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-82"></span><span>    </span><span id="local-6989586621679054013"><span class="annot"><span class="annottext">intToTBits :: [IPv4Addr]
</span><a href="#local-6989586621679054013"><span class="hs-identifier hs-var hs-var">intToTBits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [IPv4Addr] -&gt; [IPv4Addr]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span> </span><span class="annot"><span class="annottext">[IPv4Addr]
</span><a href="Data.IP.RouteTable.Internal.html#intToTBitsWord32"><span class="hs-identifier hs-var">intToTBitsWord32</span></a></span><span>
</span><span id="line-83"></span><span>    </span><span id="local-6989586621679054014"><span class="annot"><span class="annottext">all0 :: IPv4Addr
</span><a href="#local-6989586621679054014"><span class="hs-identifier hs-var hs-var">all0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IPv4Addr
</span><span class="hs-number">0x00000000</span></span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="hs-comment">----------------------------------------------------------------</span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-comment">{-|
  The Tree structure for IP routing table based on TRIE with
  one way branching removed. This is an abstract data type,
  so you cannot touch its inside. Please use 'insert' or 'lookup', instead.
-}</span><span>
</span><span id="line-92"></span><span id="local-6989586621679054005"><span id="local-6989586621679054006"><span id="local-6989586621679054007"><span id="local-6989586621679054008"></span></span></span></span><span class="hs-keyword">data</span><span> </span><span id="IPRTable"><span class="annot"><a href="Data.IP.RouteTable.Internal.html#IPRTable"><span class="hs-identifier hs-var">IPRTable</span></a></span></span><span> </span><span id="local-6989586621679054221"><span class="annot"><a href="#local-6989586621679054221"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679054220"><span class="annot"><a href="#local-6989586621679054220"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-93"></span><span>    </span><span id="Nil"><span class="annot"><a href="Data.IP.RouteTable.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span></span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Node"><span class="annot"><a href="Data.IP.RouteTable.Internal.html#Node"><span class="hs-identifier hs-var">Node</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Data.IP.Range.html#AddrRange"><span class="hs-identifier hs-type">AddrRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054221"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679054221"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679054220"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#IPRTable"><span class="hs-identifier hs-type">IPRTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054221"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054220"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#IPRTable"><span class="hs-identifier hs-type">IPRTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054221"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054220"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679053999"><span id="local-6989586621679054001"><span class="annot"><span class="annottext">IPRTable k a -&gt; IPRTable k a -&gt; Bool
(IPRTable k a -&gt; IPRTable k a -&gt; Bool)
-&gt; (IPRTable k a -&gt; IPRTable k a -&gt; Bool) -&gt; Eq (IPRTable k a)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall k a. (Eq k, Eq a) =&gt; IPRTable k a -&gt; IPRTable k a -&gt; Bool
/= :: IPRTable k a -&gt; IPRTable k a -&gt; Bool
$c/= :: forall k a. (Eq k, Eq a) =&gt; IPRTable k a -&gt; IPRTable k a -&gt; Bool
== :: IPRTable k a -&gt; IPRTable k a -&gt; Bool
$c== :: forall k a. (Eq k, Eq a) =&gt; IPRTable k a -&gt; IPRTable k a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. IPRTable k a -&gt; Rep (IPRTable k a) x)
-&gt; (forall x. Rep (IPRTable k a) x -&gt; IPRTable k a)
-&gt; Generic (IPRTable k a)
forall x. Rep (IPRTable k a) x -&gt; IPRTable k a
forall x. IPRTable k a -&gt; Rep (IPRTable k a) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall k a x. Rep (IPRTable k a) x -&gt; IPRTable k a
forall k a x. IPRTable k a -&gt; Rep (IPRTable k a) x
$cto :: forall k a x. Rep (IPRTable k a) x -&gt; IPRTable k a
$cfrom :: forall k a x. IPRTable k a -&gt; Rep (IPRTable k a) x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall a. IPRTable k a -&gt; Rep1 (IPRTable k) a)
-&gt; (forall a. Rep1 (IPRTable k) a -&gt; IPRTable k a)
-&gt; Generic1 (IPRTable k)
forall a. Rep1 (IPRTable k) a -&gt; IPRTable k a
forall a. IPRTable k a -&gt; Rep1 (IPRTable k) a
forall k a. Rep1 (IPRTable k) a -&gt; IPRTable k a
forall k a. IPRTable k a -&gt; Rep1 (IPRTable k) a
forall k (f :: k -&gt; *).
(forall (a :: k). f a -&gt; Rep1 f a)
-&gt; (forall (a :: k). Rep1 f a -&gt; f a) -&gt; Generic1 f
$cto1 :: forall k a. Rep1 (IPRTable k) a -&gt; IPRTable k a
$cfrom1 :: forall k a. IPRTable k a -&gt; Rep1 (IPRTable k) a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic1</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679053986"><span id="local-6989586621679053988"><span id="local-6989586621679053990"><span class="annot"><span class="annottext">Int -&gt; IPRTable k a -&gt; ShowS
[IPRTable k a] -&gt; ShowS
IPRTable k a -&gt; String
(Int -&gt; IPRTable k a -&gt; ShowS)
-&gt; (IPRTable k a -&gt; String)
-&gt; ([IPRTable k a] -&gt; ShowS)
-&gt; Show (IPRTable k a)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall k a. (Show k, Show a) =&gt; Int -&gt; IPRTable k a -&gt; ShowS
forall k a. (Show k, Show a) =&gt; [IPRTable k a] -&gt; ShowS
forall k a. (Show k, Show a) =&gt; IPRTable k a -&gt; String
showList :: [IPRTable k a] -&gt; ShowS
$cshowList :: forall k a. (Show k, Show a) =&gt; [IPRTable k a] -&gt; ShowS
show :: IPRTable k a -&gt; String
$cshow :: forall k a. (Show k, Show a) =&gt; IPRTable k a -&gt; String
showsPrec :: Int -&gt; IPRTable k a -&gt; ShowS
$cshowsPrec :: forall k a. (Show k, Show a) =&gt; Int -&gt; IPRTable k a -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span class="hs-comment">----------------------------------------------------------------</span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="hs-comment">{-|
  The 'empty' function returns an empty IP routing table.

&gt;&gt;&gt; (empty :: IPRTable IPv4 ()) == fromList []
True
-}</span><span>
</span><span id="line-105"></span><span id="local-6989586621679053983"><span id="local-6989586621679053984"><span class="annot"><a href="Data.IP.RouteTable.Internal.html#empty"><span class="hs-identifier hs-type">empty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#Routable"><span class="hs-identifier hs-type">Routable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053984"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#IPRTable"><span class="hs-identifier hs-type">IPRTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053984"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053983"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-106"></span><span id="empty"><span class="annot"><span class="annottext">empty :: IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#empty"><span class="hs-identifier hs-var hs-var">empty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IPRTable k a
forall k a. IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span id="local-6989586621679053981"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679053978"><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#IPRTable"><span class="hs-identifier hs-type">IPRTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053981"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-109"></span><span>    </span><span id="local-6989586621679053976"><span class="annot"><span class="annottext">fmap :: (a -&gt; b) -&gt; IPRTable k a -&gt; IPRTable k b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fmap</span></span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IPRTable k b
forall k a. IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span>
</span><span id="line-110"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">fmap</span></span><span> </span><span id="local-6989586621679053975"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679053975"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span id="local-6989586621679053974"><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053974"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679053973"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679053973"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679053972"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679053972"><span class="hs-identifier hs-var">mv</span></a></span></span><span> </span><span id="local-6989586621679053971"><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053971"><span class="hs-identifier hs-var">b1</span></a></span></span><span> </span><span id="local-6989586621679053970"><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053970"><span class="hs-identifier hs-var">b2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AddrRange k
-&gt; k -&gt; Maybe b -&gt; IPRTable k b -&gt; IPRTable k b -&gt; IPRTable k b
forall k a.
AddrRange k
-&gt; k -&gt; Maybe a -&gt; IPRTable k a -&gt; IPRTable k a -&gt; IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#Node"><span class="hs-identifier hs-var">Node</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053974"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679053973"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679053975"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679053972"><span class="hs-identifier hs-var">mv</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; IPRTable k a -&gt; IPRTable k b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679053975"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053971"><span class="hs-identifier hs-var">b1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; IPRTable k a -&gt; IPRTable k b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679053975"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053970"><span class="hs-identifier hs-var">b2</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span id="local-6989586621679053968"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679053935"><span id="local-6989586621679053937"><span id="local-6989586621679053939"><span id="local-6989586621679053941"><span id="local-6989586621679053943"><span id="local-6989586621679053945"><span id="local-6989586621679053947"><span id="local-6989586621679053949"><span id="local-6989586621679053951"><span id="local-6989586621679053953"><span id="local-6989586621679053955"><span id="local-6989586621679053957"><span id="local-6989586621679053959"><span id="local-6989586621679053961"><span id="local-6989586621679053963"><span id="local-6989586621679053966"><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#IPRTable"><span class="hs-identifier hs-type">IPRTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053968"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-113"></span><span>    </span><span id="local-6989586621679053933"><span class="annot"><span class="annottext">foldMap :: (a -&gt; m) -&gt; IPRTable k a -&gt; m
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">foldMap</span></span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-114"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span id="local-6989586621679053931"><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679053931"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">k
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679053930"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679053930"><span class="hs-identifier hs-var">mv</span></a></span></span><span> </span><span id="local-6989586621679053929"><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053929"><span class="hs-identifier hs-var">b1</span></a></span></span><span> </span><span id="local-6989586621679053928"><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053928"><span class="hs-identifier hs-var">b2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; m) -&gt; Maybe a -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679053931"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679053930"><span class="hs-identifier hs-var">mv</span></a></span><span> </span><span class="annot"><span class="annottext">m -&gt; m -&gt; m
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; m) -&gt; IPRTable k a -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679053931"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053929"><span class="hs-identifier hs-var">b1</span></a></span><span> </span><span class="annot"><span class="annottext">m -&gt; m -&gt; m
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; m) -&gt; IPRTable k a -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679053931"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053928"><span class="hs-identifier hs-var">b2</span></a></span></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span id="local-6989586621679053927"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679053918"><span id="local-6989586621679053920"><span id="local-6989586621679053922"><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#IPRTable"><span class="hs-identifier hs-type">IPRTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053927"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-117"></span><span>    </span><span id="local-6989586621679053916"><span class="annot"><span class="annottext">traverse :: (a -&gt; f b) -&gt; IPRTable k a -&gt; f (IPRTable k b)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">traverse</span></span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IPRTable k b -&gt; f (IPRTable k b)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">IPRTable k b
forall k a. IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span>
</span><span id="line-118"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">traverse</span></span><span> </span><span id="local-6989586621679053914"><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621679053914"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span id="local-6989586621679053913"><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053913"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679053912"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679053912"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679053911"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679053911"><span class="hs-identifier hs-var">mv</span></a></span></span><span> </span><span id="local-6989586621679053910"><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053910"><span class="hs-identifier hs-var">b1</span></a></span></span><span> </span><span id="local-6989586621679053909"><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053909"><span class="hs-identifier hs-var">b2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AddrRange k
-&gt; k -&gt; Maybe b -&gt; IPRTable k b -&gt; IPRTable k b -&gt; IPRTable k b
forall k a.
AddrRange k
-&gt; k -&gt; Maybe a -&gt; IPRTable k a -&gt; IPRTable k a -&gt; IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#Node"><span class="hs-identifier hs-var">Node</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053913"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679053912"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe b -&gt; IPRTable k b -&gt; IPRTable k b -&gt; IPRTable k b)
-&gt; f (Maybe b) -&gt; f (IPRTable k b -&gt; IPRTable k b -&gt; IPRTable k b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; f b) -&gt; Maybe a -&gt; f (Maybe b)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621679053914"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679053911"><span class="hs-identifier hs-var">mv</span></a></span><span> </span><span class="annot"><span class="annottext">f (IPRTable k b -&gt; IPRTable k b -&gt; IPRTable k b)
-&gt; f (IPRTable k b) -&gt; f (IPRTable k b -&gt; IPRTable k b)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; f b) -&gt; IPRTable k a -&gt; f (IPRTable k b)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621679053914"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053910"><span class="hs-identifier hs-var">b1</span></a></span><span> </span><span class="annot"><span class="annottext">f (IPRTable k b -&gt; IPRTable k b)
-&gt; f (IPRTable k b) -&gt; f (IPRTable k b)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; f b) -&gt; IPRTable k a -&gt; f (IPRTable k b)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621679053914"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053909"><span class="hs-identifier hs-var">b2</span></a></span></span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="hs-comment">-- | Note that Semigroup and Monoid instances are right-biased.</span><span>
</span><span id="line-121"></span><span class="hs-comment">--   That is, if both arguments have the same key, the value from the right</span><span>
</span><span id="line-122"></span><span class="hs-comment">--   argument will be used.</span><span>
</span><span id="line-123"></span><span class="hs-comment">--   Since: 1.7.5</span><span>
</span><span id="line-124"></span><span id="local-6989586621679053907"><span id="local-6989586621679053908"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679053904"><span class="annot"><a href="Data.IP.RouteTable.Internal.html#Routable"><span class="hs-identifier hs-type">Routable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053908"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#IPRTable"><span class="hs-identifier hs-type">IPRTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053908"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053907"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-125"></span><span>    </span><span id="local-6989586621679053901"><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053901"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679053900"><span class="annot"><span class="annottext">&lt;&gt; :: IPRTable k a -&gt; IPRTable k a -&gt; IPRTable k a
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span id="local-6989586621679053899"><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053899"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(IPRTable k a -&gt; AddrRange k -&gt; a -&gt; IPRTable k a)
-&gt; IPRTable k a -&gt; IPRTable k a -&gt; IPRTable k a
forall b k a.
(b -&gt; AddrRange k -&gt; a -&gt; b) -&gt; b -&gt; IPRTable k a -&gt; b
</span><a href="Data.IP.RouteTable.Internal.html#foldlWithKey"><span class="hs-identifier hs-var">foldlWithKey</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679053897"><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053897"><span class="hs-identifier hs-var">rt</span></a></span></span><span> </span><span id="local-6989586621679053896"><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053896"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679053895"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679053895"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AddrRange k -&gt; a -&gt; IPRTable k a -&gt; IPRTable k a
forall k a.
Routable k =&gt;
AddrRange k -&gt; a -&gt; IPRTable k a -&gt; IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#insert"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053896"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679053895"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053897"><span class="hs-identifier hs-var">rt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053901"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053899"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-126"></span><span>    </span><span id="local-6989586621679053893"><span class="annot"><span class="annottext">stimes :: b -&gt; IPRTable k a -&gt; IPRTable k a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">stimes</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; IPRTable k a -&gt; IPRTable k a
forall b a. Integral b =&gt; b -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">stimesIdempotent</span></span></span></span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span class="hs-comment">-- | Since: 1.7.5</span><span>
</span><span id="line-129"></span><span id="local-6989586621679053889"><span id="local-6989586621679053890"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679053884"><span class="annot"><a href="Data.IP.RouteTable.Internal.html#Routable"><span class="hs-identifier hs-type">Routable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053890"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#IPRTable"><span class="hs-identifier hs-type">IPRTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053890"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053889"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-130"></span><span>    </span><span id="local-6989586621679053882"><span class="annot"><span class="annottext">mempty :: IPRTable k a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IPRTable k a
forall k a. Routable k =&gt; IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-131"></span><span>    </span><span id="local-6989586621679053881"><span class="annot"><span class="annottext">mappend :: IPRTable k a -&gt; IPRTable k a -&gt; IPRTable k a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mappend</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IPRTable k a -&gt; IPRTable k a -&gt; IPRTable k a
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span></span></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="hs-comment">----------------------------------------------------------------</span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span class="hs-comment">{-|
  The 'insert' function inserts a value with a key of 'AddrRange' to 'IPRTable'
  and returns a new 'IPRTable'.

&gt;&gt;&gt; (insert (&quot;127.0.0.1&quot; :: AddrRange IPv4) () empty) == fromList [(&quot;127.0.0.1&quot;,())]
True
-}</span><span>
</span><span id="line-142"></span><span id="local-6989586621679054130"><span id="local-6989586621679054131"><span class="annot"><a href="Data.IP.RouteTable.Internal.html#insert"><span class="hs-identifier hs-type">insert</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#Routable"><span class="hs-identifier hs-type">Routable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054131"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.IP.Range.html#AddrRange"><span class="hs-identifier hs-type">AddrRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054131"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679054130"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#IPRTable"><span class="hs-identifier hs-type">IPRTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054131"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054130"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#IPRTable"><span class="hs-identifier hs-type">IPRTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054131"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054130"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-143"></span><span id="insert"><span class="annot"><span class="annottext">insert :: AddrRange k -&gt; a -&gt; IPRTable k a -&gt; IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#insert"><span class="hs-identifier hs-var hs-var">insert</span></a></span></span><span> </span><span id="local-6989586621679053880"><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053880"><span class="hs-identifier hs-var">k1</span></a></span></span><span> </span><span id="local-6989586621679053879"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679053879"><span class="hs-identifier hs-var">v1</span></a></span></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AddrRange k
-&gt; k -&gt; Maybe a -&gt; IPRTable k a -&gt; IPRTable k a -&gt; IPRTable k a
forall k a.
AddrRange k
-&gt; k -&gt; Maybe a -&gt; IPRTable k a -&gt; IPRTable k a -&gt; IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#Node"><span class="hs-identifier hs-var">Node</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053880"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679053878"><span class="hs-identifier hs-var">tb1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679053879"><span class="hs-identifier hs-var">v1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IPRTable k a
forall k a. IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
forall k a. IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span>
</span><span id="line-144"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-145"></span><span>    </span><span id="local-6989586621679053878"><span class="annot"><span class="annottext">tb1 :: k
</span><a href="#local-6989586621679053878"><span class="hs-identifier hs-var hs-var">tb1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AddrRange k -&gt; k
forall k. Routable k =&gt; AddrRange k -&gt; k
</span><a href="Data.IP.RouteTable.Internal.html#keyToTestBit"><span class="hs-identifier hs-var">keyToTestBit</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053880"><span class="hs-identifier hs-var">k1</span></a></span><span>
</span><span id="line-146"></span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#insert"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span id="local-6989586621679053876"><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053876"><span class="hs-identifier hs-var">k1</span></a></span></span><span> </span><span id="local-6989586621679053875"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679053875"><span class="hs-identifier hs-var">v1</span></a></span></span><span> </span><span id="local-6989586621679053874"><span class="annot"><span class="annottext">s :: IPRTable k a
</span><a href="#local-6989586621679053874"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span id="local-6989586621679053873"><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053873"><span class="hs-identifier hs-var">k2</span></a></span></span><span> </span><span id="local-6989586621679053872"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679053872"><span class="hs-identifier hs-var">tb2</span></a></span></span><span> </span><span id="local-6989586621679053871"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679053871"><span class="hs-identifier hs-var">v2</span></a></span></span><span> </span><span id="local-6989586621679053870"><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053870"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679053869"><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053869"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053876"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k -&gt; AddrRange k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053873"><span class="hs-identifier hs-var">k2</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AddrRange k
-&gt; k -&gt; Maybe a -&gt; IPRTable k a -&gt; IPRTable k a -&gt; IPRTable k a
forall k a.
AddrRange k
-&gt; k -&gt; Maybe a -&gt; IPRTable k a -&gt; IPRTable k a -&gt; IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#Node"><span class="hs-identifier hs-var">Node</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053876"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679053868"><span class="hs-identifier hs-var">tb1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679053875"><span class="hs-identifier hs-var">v1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053870"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053869"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053873"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k -&gt; AddrRange k -&gt; Bool
forall a. Addr a =&gt; AddrRange a -&gt; AddrRange a -&gt; Bool
</span><a href="Data.IP.Op.html#%3E%3A%3E"><span class="hs-operator hs-var">&gt;:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053876"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">AddrRange k -&gt; k -&gt; Bool
forall k. Routable k =&gt; AddrRange k -&gt; k -&gt; Bool
</span><a href="Data.IP.RouteTable.Internal.html#isLeft"><span class="hs-identifier hs-var">isLeft</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053876"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679053872"><span class="hs-identifier hs-var">tb2</span></a></span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-149"></span><span>                    </span><span class="annot"><span class="annottext">AddrRange k
-&gt; k -&gt; Maybe a -&gt; IPRTable k a -&gt; IPRTable k a -&gt; IPRTable k a
forall k a.
AddrRange k
-&gt; k -&gt; Maybe a -&gt; IPRTable k a -&gt; IPRTable k a -&gt; IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#Node"><span class="hs-identifier hs-var">Node</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053873"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679053872"><span class="hs-identifier hs-var">tb2</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679053871"><span class="hs-identifier hs-var">v2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrRange k -&gt; a -&gt; IPRTable k a -&gt; IPRTable k a
forall k a.
Routable k =&gt;
AddrRange k -&gt; a -&gt; IPRTable k a -&gt; IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#insert"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053876"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679053875"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053870"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053869"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-150"></span><span>                  </span><span class="hs-keyword">else</span><span>
</span><span id="line-151"></span><span>                    </span><span class="annot"><span class="annottext">AddrRange k
-&gt; k -&gt; Maybe a -&gt; IPRTable k a -&gt; IPRTable k a -&gt; IPRTable k a
forall k a.
AddrRange k
-&gt; k -&gt; Maybe a -&gt; IPRTable k a -&gt; IPRTable k a -&gt; IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#Node"><span class="hs-identifier hs-var">Node</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053873"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679053872"><span class="hs-identifier hs-var">tb2</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679053871"><span class="hs-identifier hs-var">v2</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053870"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrRange k -&gt; a -&gt; IPRTable k a -&gt; IPRTable k a
forall k a.
Routable k =&gt;
AddrRange k -&gt; a -&gt; IPRTable k a -&gt; IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#insert"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053876"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679053875"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053869"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053876"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k -&gt; AddrRange k -&gt; Bool
forall a. Addr a =&gt; AddrRange a -&gt; AddrRange a -&gt; Bool
</span><a href="Data.IP.Op.html#%3E%3A%3E"><span class="hs-operator hs-var">&gt;:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053873"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">AddrRange k -&gt; k -&gt; Bool
forall k. Routable k =&gt; AddrRange k -&gt; k -&gt; Bool
</span><a href="Data.IP.RouteTable.Internal.html#isLeft"><span class="hs-identifier hs-var">isLeft</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053873"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679053868"><span class="hs-identifier hs-var">tb1</span></a></span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-153"></span><span>                    </span><span class="annot"><span class="annottext">AddrRange k
-&gt; k -&gt; Maybe a -&gt; IPRTable k a -&gt; IPRTable k a -&gt; IPRTable k a
forall k a.
AddrRange k
-&gt; k -&gt; Maybe a -&gt; IPRTable k a -&gt; IPRTable k a -&gt; IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#Node"><span class="hs-identifier hs-var">Node</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053876"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679053868"><span class="hs-identifier hs-var">tb1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679053875"><span class="hs-identifier hs-var">v1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053874"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
forall k a. IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span>
</span><span id="line-154"></span><span>                  </span><span class="hs-keyword">else</span><span>
</span><span id="line-155"></span><span>                    </span><span class="annot"><span class="annottext">AddrRange k
-&gt; k -&gt; Maybe a -&gt; IPRTable k a -&gt; IPRTable k a -&gt; IPRTable k a
forall k a.
AddrRange k
-&gt; k -&gt; Maybe a -&gt; IPRTable k a -&gt; IPRTable k a -&gt; IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#Node"><span class="hs-identifier hs-var">Node</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053876"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679053868"><span class="hs-identifier hs-var">tb1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679053875"><span class="hs-identifier hs-var">v1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IPRTable k a
forall k a. IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053874"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-156"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679053865"><span class="annot"><span class="annottext">n :: IPRTable k a
</span><a href="#local-6989586621679053865"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AddrRange k
-&gt; k -&gt; Maybe a -&gt; IPRTable k a -&gt; IPRTable k a -&gt; IPRTable k a
forall k a.
AddrRange k
-&gt; k -&gt; Maybe a -&gt; IPRTable k a -&gt; IPRTable k a -&gt; IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#Node"><span class="hs-identifier hs-var">Node</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053876"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679053868"><span class="hs-identifier hs-var">tb1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679053875"><span class="hs-identifier hs-var">v1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IPRTable k a
forall k a. IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
forall k a. IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span>
</span><span id="line-157"></span><span>                </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">IPRTable k a -&gt; IPRTable k a -&gt; IPRTable k a
forall k a.
Routable k =&gt;
IPRTable k a -&gt; IPRTable k a -&gt; IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#link"><span class="hs-identifier hs-var">link</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053865"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053874"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-158"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-159"></span><span>    </span><span id="local-6989586621679053868"><span class="annot"><span class="annottext">tb1 :: k
</span><a href="#local-6989586621679053868"><span class="hs-identifier hs-var hs-var">tb1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AddrRange k -&gt; k
forall k. Routable k =&gt; AddrRange k -&gt; k
</span><a href="Data.IP.RouteTable.Internal.html#keyToTestBit"><span class="hs-identifier hs-var">keyToTestBit</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053876"><span class="hs-identifier hs-var">k1</span></a></span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span id="local-6989586621679053862"><span id="local-6989586621679053863"><span class="annot"><a href="Data.IP.RouteTable.Internal.html#link"><span class="hs-identifier hs-type">link</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#Routable"><span class="hs-identifier hs-type">Routable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053863"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#IPRTable"><span class="hs-identifier hs-type">IPRTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053863"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053862"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#IPRTable"><span class="hs-identifier hs-type">IPRTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053863"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053862"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#IPRTable"><span class="hs-identifier hs-type">IPRTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053863"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053862"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-162"></span><span id="link"><span class="annot"><span class="annottext">link :: IPRTable k a -&gt; IPRTable k a -&gt; IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#link"><span class="hs-identifier hs-var hs-var">link</span></a></span></span><span> </span><span id="local-6989586621679053861"><span class="annot"><span class="annottext">s1 :: IPRTable k a
</span><a href="#local-6989586621679053861"><span class="hs-identifier hs-var">s1</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span id="local-6989586621679053860"><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053860"><span class="hs-identifier hs-var">k1</span></a></span></span><span> </span><span class="annot"><span class="annottext">k
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679053859"><span class="annot"><span class="annottext">s2 :: IPRTable k a
</span><a href="#local-6989586621679053859"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span id="local-6989586621679053858"><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053858"><span class="hs-identifier hs-var">k2</span></a></span></span><span> </span><span class="annot"><span class="annottext">k
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">AddrRange k -&gt; k -&gt; Bool
forall k. Routable k =&gt; AddrRange k -&gt; k -&gt; Bool
</span><a href="Data.IP.RouteTable.Internal.html#isLeft"><span class="hs-identifier hs-var">isLeft</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053860"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679053857"><span class="hs-identifier hs-var">tbg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AddrRange k
-&gt; k -&gt; Maybe a -&gt; IPRTable k a -&gt; IPRTable k a -&gt; IPRTable k a
forall k a.
AddrRange k
-&gt; k -&gt; Maybe a -&gt; IPRTable k a -&gt; IPRTable k a -&gt; IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#Node"><span class="hs-identifier hs-var">Node</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053856"><span class="hs-identifier hs-var">kg</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679053857"><span class="hs-identifier hs-var">tbg</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053861"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053859"><span class="hs-identifier hs-var">s2</span></a></span><span>
</span><span id="line-164"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AddrRange k
-&gt; k -&gt; Maybe a -&gt; IPRTable k a -&gt; IPRTable k a -&gt; IPRTable k a
forall k a.
AddrRange k
-&gt; k -&gt; Maybe a -&gt; IPRTable k a -&gt; IPRTable k a -&gt; IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#Node"><span class="hs-identifier hs-var">Node</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053856"><span class="hs-identifier hs-var">kg</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679053857"><span class="hs-identifier hs-var">tbg</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053859"><span class="hs-identifier hs-var">s2</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053861"><span class="hs-identifier hs-var">s1</span></a></span><span>
</span><span id="line-165"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-166"></span><span>    </span><span id="local-6989586621679053856"><span class="annot"><span class="annottext">kg :: AddrRange k
</span><a href="#local-6989586621679053856"><span class="hs-identifier hs-var hs-var">kg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; AddrRange k -&gt; AddrRange k -&gt; AddrRange k
forall k.
Routable k =&gt;
Int -&gt; AddrRange k -&gt; AddrRange k -&gt; AddrRange k
</span><a href="Data.IP.RouteTable.Internal.html#glue"><span class="hs-identifier hs-var">glue</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053860"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053858"><span class="hs-identifier hs-var">k2</span></a></span><span>
</span><span id="line-167"></span><span>    </span><span id="local-6989586621679053857"><span class="annot"><span class="annottext">tbg :: k
</span><a href="#local-6989586621679053857"><span class="hs-identifier hs-var hs-var">tbg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AddrRange k -&gt; k
forall k. Routable k =&gt; AddrRange k -&gt; k
</span><a href="Data.IP.RouteTable.Internal.html#keyToTestBit"><span class="hs-identifier hs-var">keyToTestBit</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053856"><span class="hs-identifier hs-var">kg</span></a></span><span>
</span><span id="line-168"></span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#link"><span class="hs-identifier hs-var">link</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; IPRTable k a
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;link&quot;</span></span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span id="local-6989586621679054116"><span class="annot"><a href="Data.IP.RouteTable.Internal.html#glue"><span class="hs-identifier hs-type">glue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#Routable"><span class="hs-identifier hs-type">Routable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054116"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.IP.Range.html#AddrRange"><span class="hs-identifier hs-type">AddrRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054116"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.IP.Range.html#AddrRange"><span class="hs-identifier hs-type">AddrRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054116"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.IP.Range.html#AddrRange"><span class="hs-identifier hs-type">AddrRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054116"><span class="hs-identifier hs-type">k</span></a></span></span><span>
</span><span id="line-171"></span><span id="glue"><span class="annot"><span class="annottext">glue :: Int -&gt; AddrRange k -&gt; AddrRange k -&gt; AddrRange k
</span><a href="Data.IP.RouteTable.Internal.html#glue"><span class="hs-identifier hs-var hs-var">glue</span></a></span></span><span> </span><span id="local-6989586621679053853"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679053853"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679053852"><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053852"><span class="hs-identifier hs-var">k1</span></a></span></span><span> </span><span id="local-6989586621679053851"><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053851"><span class="hs-identifier hs-var">k2</span></a></span></span><span>
</span><span id="line-172"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">AddrRange k -&gt; k
forall a. AddrRange a -&gt; a
</span><a href="Data.IP.Range.html#addr"><span class="hs-identifier hs-var hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053852"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; k -&gt; k
forall a. Addr a =&gt; a -&gt; a -&gt; a
</span><a href="Data.IP.Op.html#masked"><span class="hs-operator hs-var">`masked`</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679053849"><span class="hs-identifier hs-var">mk</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">AddrRange k -&gt; k
forall a. AddrRange a -&gt; a
</span><a href="Data.IP.Range.html#addr"><span class="hs-identifier hs-var hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053851"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; k -&gt; k
forall a. Addr a =&gt; a -&gt; a -&gt; a
</span><a href="Data.IP.Op.html#masked"><span class="hs-operator hs-var">`masked`</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679053849"><span class="hs-identifier hs-var">mk</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; AddrRange k -&gt; AddrRange k -&gt; AddrRange k
forall k.
Routable k =&gt;
Int -&gt; AddrRange k -&gt; AddrRange k -&gt; AddrRange k
</span><a href="Data.IP.RouteTable.Internal.html#glue"><span class="hs-identifier hs-var">glue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679053853"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053852"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053851"><span class="hs-identifier hs-var">k2</span></a></span><span>
</span><span id="line-173"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; Int -&gt; AddrRange k
forall a. Addr a =&gt; a -&gt; Int -&gt; AddrRange a
</span><a href="Data.IP.Op.html#makeAddrRange"><span class="hs-identifier hs-var">makeAddrRange</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrRange k -&gt; k
forall a. AddrRange a -&gt; a
</span><a href="Data.IP.Range.html#addr"><span class="hs-identifier hs-var hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053852"><span class="hs-identifier hs-var">k1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679053853"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-175"></span><span>    </span><span id="local-6989586621679053849"><span class="annot"><span class="annottext">mk :: k
</span><a href="#local-6989586621679053849"><span class="hs-identifier hs-var hs-var">mk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; k
forall a. Addr a =&gt; Int -&gt; a
</span><a href="Data.IP.Op.html#intToMask"><span class="hs-identifier hs-var">intToMask</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679053853"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span id="local-6989586621679054121"><span class="annot"><a href="Data.IP.RouteTable.Internal.html#keyToTestBit"><span class="hs-identifier hs-type">keyToTestBit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#Routable"><span class="hs-identifier hs-type">Routable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054121"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.IP.Range.html#AddrRange"><span class="hs-identifier hs-type">AddrRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054121"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679054121"><span class="hs-identifier hs-type">k</span></a></span></span><span>
</span><span id="line-178"></span><span id="keyToTestBit"><span class="annot"><span class="annottext">keyToTestBit :: AddrRange k -&gt; k
</span><a href="Data.IP.RouteTable.Internal.html#keyToTestBit"><span class="hs-identifier hs-var hs-var">keyToTestBit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; k
forall a. Routable a =&gt; Int -&gt; a
</span><a href="Data.IP.RouteTable.Internal.html#intToTBit"><span class="hs-identifier hs-var">intToTBit</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; k) -&gt; (AddrRange k -&gt; Int) -&gt; AddrRange k -&gt; k
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">AddrRange k -&gt; Int
forall a. AddrRange a -&gt; Int
</span><a href="Data.IP.Range.html#mlen"><span class="hs-identifier hs-var hs-var">mlen</span></a></span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span id="local-6989586621679054119"><span class="annot"><a href="Data.IP.RouteTable.Internal.html#isLeft"><span class="hs-identifier hs-type">isLeft</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#Routable"><span class="hs-identifier hs-type">Routable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054119"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.IP.Range.html#AddrRange"><span class="hs-identifier hs-type">AddrRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054119"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679054119"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-181"></span><span id="isLeft"><span class="annot"><span class="annottext">isLeft :: AddrRange k -&gt; k -&gt; Bool
</span><a href="Data.IP.RouteTable.Internal.html#isLeft"><span class="hs-identifier hs-var hs-var">isLeft</span></a></span></span><span> </span><span id="local-6989586621679053843"><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053843"><span class="hs-identifier hs-var">adr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Routable a =&gt; a -&gt; a -&gt; Bool
</span><a href="Data.IP.RouteTable.Internal.html#isZero"><span class="hs-identifier hs-var">isZero</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrRange k -&gt; k
forall a. AddrRange a -&gt; a
</span><a href="Data.IP.Range.html#addr"><span class="hs-identifier hs-var hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053843"><span class="hs-identifier hs-var">adr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="hs-comment">----------------------------------------------------------------</span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="hs-comment">{-|
  The 'delete' function deletes a value by a key of 'AddrRange' from 'IPRTable'
  and returns a new 'IPRTable'.

&gt;&gt;&gt; delete &quot;127.0.0.1&quot; (insert &quot;127.0.0.1&quot; () empty) == (empty :: IPRTable IPv4 ())
True
-}</span><span>
</span><span id="line-192"></span><span id="local-6989586621679054098"><span id="local-6989586621679054099"><span class="annot"><a href="Data.IP.RouteTable.Internal.html#delete"><span class="hs-identifier hs-type">delete</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#Routable"><span class="hs-identifier hs-type">Routable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054099"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.IP.Range.html#AddrRange"><span class="hs-identifier hs-type">AddrRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054099"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#IPRTable"><span class="hs-identifier hs-type">IPRTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054099"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054098"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#IPRTable"><span class="hs-identifier hs-type">IPRTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054099"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054098"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-193"></span><span id="delete"><span class="annot"><span class="annottext">delete :: AddrRange k -&gt; IPRTable k a -&gt; IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#delete"><span class="hs-identifier hs-var hs-var">delete</span></a></span></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IPRTable k a
forall k a. IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span>
</span><span id="line-194"></span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#delete"><span class="hs-identifier hs-var">delete</span></a></span><span> </span><span id="local-6989586621679053841"><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053841"><span class="hs-identifier hs-var">k1</span></a></span></span><span> </span><span id="local-6989586621679053840"><span class="annot"><span class="annottext">s :: IPRTable k a
</span><a href="#local-6989586621679053840"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span id="local-6989586621679053839"><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053839"><span class="hs-identifier hs-var">k2</span></a></span></span><span> </span><span id="local-6989586621679053838"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679053838"><span class="hs-identifier hs-var">tb2</span></a></span></span><span> </span><span id="local-6989586621679053837"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679053837"><span class="hs-identifier hs-var">v2</span></a></span></span><span> </span><span id="local-6989586621679053836"><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053836"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679053835"><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053835"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053841"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k -&gt; AddrRange k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053839"><span class="hs-identifier hs-var">k2</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AddrRange k
-&gt; k -&gt; Maybe a -&gt; IPRTable k a -&gt; IPRTable k a -&gt; IPRTable k a
forall k a.
Routable k =&gt;
AddrRange k
-&gt; k -&gt; Maybe a -&gt; IPRTable k a -&gt; IPRTable k a -&gt; IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#node"><span class="hs-identifier hs-var">node</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053839"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679053838"><span class="hs-identifier hs-var">tb2</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053836"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053835"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-196"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053839"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k -&gt; AddrRange k -&gt; Bool
forall a. Addr a =&gt; AddrRange a -&gt; AddrRange a -&gt; Bool
</span><a href="Data.IP.Op.html#%3E%3A%3E"><span class="hs-operator hs-var">&gt;:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053841"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">AddrRange k -&gt; k -&gt; Bool
forall k. Routable k =&gt; AddrRange k -&gt; k -&gt; Bool
</span><a href="Data.IP.RouteTable.Internal.html#isLeft"><span class="hs-identifier hs-var">isLeft</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053841"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679053838"><span class="hs-identifier hs-var">tb2</span></a></span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-197"></span><span>                    </span><span class="annot"><span class="annottext">AddrRange k
-&gt; k -&gt; Maybe a -&gt; IPRTable k a -&gt; IPRTable k a -&gt; IPRTable k a
forall k a.
Routable k =&gt;
AddrRange k
-&gt; k -&gt; Maybe a -&gt; IPRTable k a -&gt; IPRTable k a -&gt; IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#node"><span class="hs-identifier hs-var">node</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053839"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679053838"><span class="hs-identifier hs-var">tb2</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679053837"><span class="hs-identifier hs-var">v2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrRange k -&gt; IPRTable k a -&gt; IPRTable k a
forall k a.
Routable k =&gt;
AddrRange k -&gt; IPRTable k a -&gt; IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#delete"><span class="hs-identifier hs-var">delete</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053841"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053836"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053835"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-198"></span><span>                  </span><span class="hs-keyword">else</span><span>
</span><span id="line-199"></span><span>                    </span><span class="annot"><span class="annottext">AddrRange k
-&gt; k -&gt; Maybe a -&gt; IPRTable k a -&gt; IPRTable k a -&gt; IPRTable k a
forall k a.
Routable k =&gt;
AddrRange k
-&gt; k -&gt; Maybe a -&gt; IPRTable k a -&gt; IPRTable k a -&gt; IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#node"><span class="hs-identifier hs-var">node</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053839"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679053838"><span class="hs-identifier hs-var">tb2</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679053837"><span class="hs-identifier hs-var">v2</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053836"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrRange k -&gt; IPRTable k a -&gt; IPRTable k a
forall k a.
Routable k =&gt;
AddrRange k -&gt; IPRTable k a -&gt; IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#delete"><span class="hs-identifier hs-var">delete</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053841"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053835"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053840"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span id="local-6989586621679054100"><span id="local-6989586621679054101"><span class="annot"><a href="Data.IP.RouteTable.Internal.html#node"><span class="hs-identifier hs-type">node</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#Routable"><span class="hs-identifier hs-type">Routable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054101"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.IP.Range.html#AddrRange"><span class="hs-identifier hs-type">AddrRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054101"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679054101"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679054100"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#IPRTable"><span class="hs-identifier hs-type">IPRTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054101"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054100"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#IPRTable"><span class="hs-identifier hs-type">IPRTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054101"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054100"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#IPRTable"><span class="hs-identifier hs-type">IPRTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054101"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054100"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-203"></span><span id="node"><span class="annot"><span class="annottext">node :: AddrRange k
-&gt; k -&gt; Maybe a -&gt; IPRTable k a -&gt; IPRTable k a -&gt; IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#node"><span class="hs-identifier hs-var hs-var">node</span></a></span></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">k
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span> </span><span id="local-6989586621679053833"><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053833"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053833"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-204"></span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#node"><span class="hs-identifier hs-var">node</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">k
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span id="local-6989586621679053832"><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053832"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053832"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-205"></span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#node"><span class="hs-identifier hs-var">node</span></a></span><span> </span><span id="local-6989586621679053831"><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053831"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679053830"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679053830"><span class="hs-identifier hs-var">tb</span></a></span></span><span> </span><span id="local-6989586621679053829"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679053829"><span class="hs-identifier hs-var">v</span></a></span></span><span>      </span><span id="local-6989586621679053828"><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053828"><span class="hs-identifier hs-var">l</span></a></span></span><span>   </span><span id="local-6989586621679053827"><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053827"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AddrRange k
-&gt; k -&gt; Maybe a -&gt; IPRTable k a -&gt; IPRTable k a -&gt; IPRTable k a
forall k a.
AddrRange k
-&gt; k -&gt; Maybe a -&gt; IPRTable k a -&gt; IPRTable k a -&gt; IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#Node"><span class="hs-identifier hs-var">Node</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053831"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679053830"><span class="hs-identifier hs-var">tb</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679053829"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053828"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053827"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="hs-comment">----------------------------------------------------------------</span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="hs-comment">{-|
  The 'lookup' function looks up 'IPRTable' with a key of 'AddrRange'.
  If a routing information in 'IPRTable' matches the key, its value
  is returned.

&gt;&gt;&gt; let v4 = [&quot;133.4.0.0/16&quot;,&quot;133.5.0.0/16&quot;,&quot;133.5.16.0/24&quot;,&quot;133.5.23.0/24&quot;] :: [AddrRange IPv4]
&gt;&gt;&gt; let rt = fromList $ zip v4 v4
&gt;&gt;&gt; lookup &quot;127.0.0.1&quot; rt
Nothing
&gt;&gt;&gt; lookup &quot;133.3.0.1&quot; rt
Nothing
&gt;&gt;&gt; lookup &quot;133.4.0.0&quot; rt
Just 133.4.0.0/16
&gt;&gt;&gt; lookup &quot;133.4.0.1&quot; rt
Just 133.4.0.0/16
&gt;&gt;&gt; lookup &quot;133.5.16.0&quot; rt
Just 133.5.16.0/24
&gt;&gt;&gt; lookup &quot;133.5.16.1&quot; rt
Just 133.5.16.0/24
-}</span><span>
</span><span id="line-229"></span><span id="local-6989586621679053825"><span id="local-6989586621679053826"><span class="annot"><a href="Data.IP.RouteTable.Internal.html#lookup"><span class="hs-identifier hs-type">lookup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#Routable"><span class="hs-identifier hs-type">Routable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053826"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.IP.Range.html#AddrRange"><span class="hs-identifier hs-type">AddrRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053826"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#IPRTable"><span class="hs-identifier hs-type">IPRTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053826"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053825"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679053825"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-230"></span><span id="lookup"><span class="annot"><span class="annottext">lookup :: AddrRange k -&gt; IPRTable k a -&gt; Maybe a
</span><a href="Data.IP.RouteTable.Internal.html#lookup"><span class="hs-identifier hs-var hs-var">lookup</span></a></span></span><span> </span><span id="local-6989586621679053823"><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053823"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679053822"><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053822"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((AddrRange k, a) -&gt; a) -&gt; Maybe (AddrRange k, a) -&gt; Maybe a
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(AddrRange k, a) -&gt; a
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrRange k
-&gt; IPRTable k a -&gt; Maybe (AddrRange k, a) -&gt; Maybe (AddrRange k, a)
forall k a.
Routable k =&gt;
AddrRange k
-&gt; IPRTable k a -&gt; Maybe (AddrRange k, a) -&gt; Maybe (AddrRange k, a)
</span><a href="Data.IP.RouteTable.Internal.html#search"><span class="hs-identifier hs-var">search</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053823"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053822"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (AddrRange k, a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span class="hs-comment">{-|
  The 'lookupKeyValue' function looks up 'IPRTable' with a key of 'AddrRange'.
  If a routing information in 'IPRTable' matches the key, both key and value
  are returned.

&gt;&gt;&gt; :set -XOverloadedStrings
&gt;&gt;&gt; let rt = fromList ([(&quot;192.168.0.0/24&quot;, 1), (&quot;10.10.0.0/16&quot;, 2)] :: [(AddrRange IPv4, Int)])
&gt;&gt;&gt; lookupKeyValue &quot;127.0.0.1&quot; rt
Nothing
&gt;&gt;&gt; lookupKeyValue &quot;192.168.0.1&quot; rt
Just (192.168.0.0/24,1)
&gt;&gt;&gt; lookupKeyValue &quot;10.10.0.1&quot; rt
Just (10.10.0.0/16,2)
-}</span><span>
</span><span id="line-246"></span><span id="local-6989586621679053819"><span id="local-6989586621679053820"><span class="annot"><a href="Data.IP.RouteTable.Internal.html#lookupKeyValue"><span class="hs-identifier hs-type">lookupKeyValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#Routable"><span class="hs-identifier hs-type">Routable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053820"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.IP.Range.html#AddrRange"><span class="hs-identifier hs-type">AddrRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053820"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#IPRTable"><span class="hs-identifier hs-type">IPRTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053820"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053819"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.IP.Range.html#AddrRange"><span class="hs-identifier hs-type">AddrRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053820"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679053819"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-247"></span><span id="lookupKeyValue"><span class="annot"><span class="annottext">lookupKeyValue :: AddrRange k -&gt; IPRTable k a -&gt; Maybe (AddrRange k, a)
</span><a href="Data.IP.RouteTable.Internal.html#lookupKeyValue"><span class="hs-identifier hs-var hs-var">lookupKeyValue</span></a></span></span><span> </span><span id="local-6989586621679053817"><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053817"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679053816"><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053816"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AddrRange k
-&gt; IPRTable k a -&gt; Maybe (AddrRange k, a) -&gt; Maybe (AddrRange k, a)
forall k a.
Routable k =&gt;
AddrRange k
-&gt; IPRTable k a -&gt; Maybe (AddrRange k, a) -&gt; Maybe (AddrRange k, a)
</span><a href="Data.IP.RouteTable.Internal.html#search"><span class="hs-identifier hs-var">search</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053817"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053816"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (AddrRange k, a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span id="local-6989586621679054090"><span id="local-6989586621679054091"><span class="annot"><a href="Data.IP.RouteTable.Internal.html#search"><span class="hs-identifier hs-type">search</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#Routable"><span class="hs-identifier hs-type">Routable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054091"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.IP.Range.html#AddrRange"><span class="hs-identifier hs-type">AddrRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054091"><span class="hs-identifier hs-type">k</span></a></span><span>
</span><span id="line-250"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#IPRTable"><span class="hs-identifier hs-type">IPRTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054091"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054090"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-251"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.IP.Range.html#AddrRange"><span class="hs-identifier hs-type">AddrRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054091"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679054090"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.IP.Range.html#AddrRange"><span class="hs-identifier hs-type">AddrRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054091"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679054090"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-253"></span><span id="search"><span class="annot"><span class="annottext">search :: AddrRange k
-&gt; IPRTable k a -&gt; Maybe (AddrRange k, a) -&gt; Maybe (AddrRange k, a)
</span><a href="Data.IP.RouteTable.Internal.html#search"><span class="hs-identifier hs-var hs-var">search</span></a></span></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span> </span><span id="local-6989586621679053815"><span class="annot"><span class="annottext">Maybe (AddrRange k, a)
</span><a href="#local-6989586621679053815"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (AddrRange k, a)
</span><a href="#local-6989586621679053815"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-254"></span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#search"><span class="hs-identifier hs-var">search</span></a></span><span> </span><span id="local-6989586621679053814"><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053814"><span class="hs-identifier hs-var">k1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span id="local-6989586621679053813"><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053813"><span class="hs-identifier hs-var">k2</span></a></span></span><span> </span><span id="local-6989586621679053812"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679053812"><span class="hs-identifier hs-var">tb2</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span id="local-6989586621679053811"><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053811"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679053810"><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053810"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679053809"><span class="annot"><span class="annottext">Maybe (AddrRange k, a)
</span><a href="#local-6989586621679053809"><span class="hs-identifier hs-var">res</span></a></span></span><span>
</span><span id="line-255"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053814"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k -&gt; AddrRange k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053813"><span class="hs-identifier hs-var">k2</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (AddrRange k, a)
</span><a href="#local-6989586621679053809"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-256"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053813"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k -&gt; AddrRange k -&gt; Bool
forall a. Addr a =&gt; AddrRange a -&gt; AddrRange a -&gt; Bool
</span><a href="Data.IP.Op.html#%3E%3A%3E"><span class="hs-operator hs-var">&gt;:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053814"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">AddrRange k -&gt; k -&gt; Bool
forall k. Routable k =&gt; AddrRange k -&gt; k -&gt; Bool
</span><a href="Data.IP.RouteTable.Internal.html#isLeft"><span class="hs-identifier hs-var">isLeft</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053814"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679053812"><span class="hs-identifier hs-var">tb2</span></a></span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-257"></span><span>                    </span><span class="annot"><span class="annottext">AddrRange k
-&gt; IPRTable k a -&gt; Maybe (AddrRange k, a) -&gt; Maybe (AddrRange k, a)
forall k a.
Routable k =&gt;
AddrRange k
-&gt; IPRTable k a -&gt; Maybe (AddrRange k, a) -&gt; Maybe (AddrRange k, a)
</span><a href="Data.IP.RouteTable.Internal.html#search"><span class="hs-identifier hs-var">search</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053814"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053811"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (AddrRange k, a)
</span><a href="#local-6989586621679053809"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-258"></span><span>                  </span><span class="hs-keyword">else</span><span>
</span><span id="line-259"></span><span>                    </span><span class="annot"><span class="annottext">AddrRange k
-&gt; IPRTable k a -&gt; Maybe (AddrRange k, a) -&gt; Maybe (AddrRange k, a)
forall k a.
Routable k =&gt;
AddrRange k
-&gt; IPRTable k a -&gt; Maybe (AddrRange k, a) -&gt; Maybe (AddrRange k, a)
</span><a href="Data.IP.RouteTable.Internal.html#search"><span class="hs-identifier hs-var">search</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053814"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053810"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (AddrRange k, a)
</span><a href="#local-6989586621679053809"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-260"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (AddrRange k, a)
</span><a href="#local-6989586621679053809"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-261"></span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#search"><span class="hs-identifier hs-var">search</span></a></span><span> </span><span id="local-6989586621679053808"><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053808"><span class="hs-identifier hs-var">k1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span id="local-6989586621679053807"><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053807"><span class="hs-identifier hs-var">k2</span></a></span></span><span> </span><span id="local-6989586621679053806"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679053806"><span class="hs-identifier hs-var">tb2</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679053805"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679053805"><span class="hs-identifier hs-var">vl</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679053804"><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053804"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679053803"><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053803"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679053802"><span class="annot"><span class="annottext">Maybe (AddrRange k, a)
</span><a href="#local-6989586621679053802"><span class="hs-identifier hs-var">res</span></a></span></span><span>
</span><span id="line-262"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053808"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k -&gt; AddrRange k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053807"><span class="hs-identifier hs-var">k2</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(AddrRange k, a) -&gt; Maybe (AddrRange k, a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053808"><span class="hs-identifier hs-var">k1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679053805"><span class="hs-identifier hs-var">vl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053807"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k -&gt; AddrRange k -&gt; Bool
forall a. Addr a =&gt; AddrRange a -&gt; AddrRange a -&gt; Bool
</span><a href="Data.IP.Op.html#%3E%3A%3E"><span class="hs-operator hs-var">&gt;:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053808"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">AddrRange k -&gt; k -&gt; Bool
forall k. Routable k =&gt; AddrRange k -&gt; k -&gt; Bool
</span><a href="Data.IP.RouteTable.Internal.html#isLeft"><span class="hs-identifier hs-var">isLeft</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053808"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679053806"><span class="hs-identifier hs-var">tb2</span></a></span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-264"></span><span>                    </span><span class="annot"><span class="annottext">AddrRange k
-&gt; IPRTable k a -&gt; Maybe (AddrRange k, a) -&gt; Maybe (AddrRange k, a)
forall k a.
Routable k =&gt;
AddrRange k
-&gt; IPRTable k a -&gt; Maybe (AddrRange k, a) -&gt; Maybe (AddrRange k, a)
</span><a href="Data.IP.RouteTable.Internal.html#search"><span class="hs-identifier hs-var">search</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053808"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053804"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (AddrRange k, a) -&gt; Maybe (AddrRange k, a))
-&gt; Maybe (AddrRange k, a) -&gt; Maybe (AddrRange k, a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(AddrRange k, a) -&gt; Maybe (AddrRange k, a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053807"><span class="hs-identifier hs-var">k2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679053805"><span class="hs-identifier hs-var">vl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span>                  </span><span class="hs-keyword">else</span><span>
</span><span id="line-266"></span><span>                    </span><span class="annot"><span class="annottext">AddrRange k
-&gt; IPRTable k a -&gt; Maybe (AddrRange k, a) -&gt; Maybe (AddrRange k, a)
forall k a.
Routable k =&gt;
AddrRange k
-&gt; IPRTable k a -&gt; Maybe (AddrRange k, a) -&gt; Maybe (AddrRange k, a)
</span><a href="Data.IP.RouteTable.Internal.html#search"><span class="hs-identifier hs-var">search</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053808"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053803"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (AddrRange k, a) -&gt; Maybe (AddrRange k, a))
-&gt; Maybe (AddrRange k, a) -&gt; Maybe (AddrRange k, a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(AddrRange k, a) -&gt; Maybe (AddrRange k, a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053807"><span class="hs-identifier hs-var">k2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679053805"><span class="hs-identifier hs-var">vl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-267"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (AddrRange k, a)
</span><a href="#local-6989586621679053802"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span class="hs-comment">{-|
  'lookupAll' is a version of 'lookup' that returns all entries matching the
   given key, not just the longest match.

&gt;&gt;&gt; :set -XOverloadedStrings
&gt;&gt;&gt; let rt = fromList ([(&quot;192.168.0.0/24&quot;, 1), (&quot;10.10.0.0/16&quot;, 2), (&quot;10.0.0.0/8&quot;, 3)] :: [(AddrRange IPv4, Int)])
&gt;&gt;&gt; lookupAll &quot;127.0.0.1&quot; rt
[]
&gt;&gt;&gt; lookupAll &quot;192.168.0.1&quot; rt
[(192.168.0.0/24,1)]
&gt;&gt;&gt; lookupAll &quot;10.10.0.1&quot; rt
[(10.10.0.0/16,2),(10.0.0.0/8,3)]
-}</span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span id="local-6989586621679053800"><span id="local-6989586621679053801"><span class="annot"><a href="Data.IP.RouteTable.Internal.html#lookupAll"><span class="hs-identifier hs-type">lookupAll</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#Routable"><span class="hs-identifier hs-type">Routable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053801"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.IP.Range.html#AddrRange"><span class="hs-identifier hs-type">AddrRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053801"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#IPRTable"><span class="hs-identifier hs-type">IPRTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053801"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053800"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Data.IP.Range.html#AddrRange"><span class="hs-identifier hs-type">AddrRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053801"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679053800"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-284"></span><span id="lookupAll"><span class="annot"><span class="annottext">lookupAll :: AddrRange k -&gt; IPRTable k a -&gt; [(AddrRange k, a)]
</span><a href="Data.IP.RouteTable.Internal.html#lookupAll"><span class="hs-identifier hs-var hs-var">lookupAll</span></a></span></span><span> </span><span id="local-6989586621679053798"><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053798"><span class="hs-identifier hs-var">range</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(AddrRange k, a)] -&gt; IPRTable k a -&gt; [(AddrRange k, a)]
forall b. [(AddrRange k, b)] -&gt; IPRTable k b -&gt; [(AddrRange k, b)]
</span><a href="#local-6989586621679053797"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-285"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-286"></span><span>    </span><span id="local-6989586621679053797"><span class="annot"><span class="annottext">go :: [(AddrRange k, b)] -&gt; IPRTable k b -&gt; [(AddrRange k, b)]
</span><a href="#local-6989586621679053797"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679053796"><span class="annot"><span class="annottext">[(AddrRange k, b)]
</span><a href="#local-6989586621679053796"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="annot"><span class="annottext">IPRTable k b
</span><a href="Data.IP.RouteTable.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(AddrRange k, b)]
</span><a href="#local-6989586621679053796"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-287"></span><span>    </span><span class="annot"><a href="#local-6989586621679053797"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679053795"><span class="annot"><span class="annottext">[(AddrRange k, b)]
</span><a href="#local-6989586621679053795"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span id="local-6989586621679053794"><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053794"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679053793"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679053793"><span class="hs-identifier hs-var">tb</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe b
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span id="local-6989586621679053792"><span class="annot"><span class="annottext">IPRTable k b
</span><a href="#local-6989586621679053792"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679053791"><span class="annot"><span class="annottext">IPRTable k b
</span><a href="#local-6989586621679053791"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-288"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053794"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k -&gt; AddrRange k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053798"><span class="hs-identifier hs-var">range</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(AddrRange k, b)]
</span><a href="#local-6989586621679053795"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-289"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053794"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k -&gt; AddrRange k -&gt; Bool
forall a. Addr a =&gt; AddrRange a -&gt; AddrRange a -&gt; Bool
</span><a href="Data.IP.Op.html#%3E%3A%3E"><span class="hs-operator hs-var">&gt;:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053798"><span class="hs-identifier hs-var">range</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(AddrRange k, b)] -&gt; IPRTable k b -&gt; [(AddrRange k, b)]
</span><a href="#local-6989586621679053797"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[(AddrRange k, b)]
</span><a href="#local-6989586621679053795"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">(IPRTable k b -&gt; [(AddrRange k, b)])
-&gt; IPRTable k b -&gt; [(AddrRange k, b)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">AddrRange k -&gt; k -&gt; Bool
forall k. Routable k =&gt; AddrRange k -&gt; k -&gt; Bool
</span><a href="Data.IP.RouteTable.Internal.html#isLeft"><span class="hs-identifier hs-var">isLeft</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053798"><span class="hs-identifier hs-var">range</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679053793"><span class="hs-identifier hs-var">tb</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">IPRTable k b
</span><a href="#local-6989586621679053792"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">IPRTable k b
</span><a href="#local-6989586621679053791"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-290"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(AddrRange k, b)]
</span><a href="#local-6989586621679053795"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-291"></span><span>    </span><span class="annot"><a href="#local-6989586621679053797"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679053790"><span class="annot"><span class="annottext">[(AddrRange k, b)]
</span><a href="#local-6989586621679053790"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span id="local-6989586621679053789"><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053789"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679053788"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679053788"><span class="hs-identifier hs-var">tb</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679053787"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679053787"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679053786"><span class="annot"><span class="annottext">IPRTable k b
</span><a href="#local-6989586621679053786"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679053785"><span class="annot"><span class="annottext">IPRTable k b
</span><a href="#local-6989586621679053785"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-292"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053789"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k -&gt; AddrRange k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053798"><span class="hs-identifier hs-var">range</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053789"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679053787"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(AddrRange k, b) -&gt; [(AddrRange k, b)] -&gt; [(AddrRange k, b)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[(AddrRange k, b)]
</span><a href="#local-6989586621679053790"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-293"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053789"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k -&gt; AddrRange k -&gt; Bool
forall a. Addr a =&gt; AddrRange a -&gt; AddrRange a -&gt; Bool
</span><a href="Data.IP.Op.html#%3E%3A%3E"><span class="hs-operator hs-var">&gt;:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053798"><span class="hs-identifier hs-var">range</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(AddrRange k, b)] -&gt; IPRTable k b -&gt; [(AddrRange k, b)]
</span><a href="#local-6989586621679053797"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053789"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679053787"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(AddrRange k, b) -&gt; [(AddrRange k, b)] -&gt; [(AddrRange k, b)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[(AddrRange k, b)]
</span><a href="#local-6989586621679053790"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IPRTable k b -&gt; [(AddrRange k, b)])
-&gt; IPRTable k b -&gt; [(AddrRange k, b)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">AddrRange k -&gt; k -&gt; Bool
forall k. Routable k =&gt; AddrRange k -&gt; k -&gt; Bool
</span><a href="Data.IP.RouteTable.Internal.html#isLeft"><span class="hs-identifier hs-var">isLeft</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053798"><span class="hs-identifier hs-var">range</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679053788"><span class="hs-identifier hs-var">tb</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">IPRTable k b
</span><a href="#local-6989586621679053786"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">IPRTable k b
</span><a href="#local-6989586621679053785"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-294"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(AddrRange k, b)]
</span><a href="#local-6989586621679053790"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span>
</span><span id="line-297"></span><span class="hs-comment">----------------------------------------------------------------</span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span class="hs-comment">{-|
  The 'findMatch' function looks up 'IPRTable' with a key of 'AddrRange'.
  If the key matches routing informations in 'IPRTable', they are
  returned.

&gt;&gt;&gt; let v4 = [&quot;133.4.0.0/16&quot;,&quot;133.5.0.0/16&quot;,&quot;133.5.16.0/24&quot;,&quot;133.5.23.0/24&quot;] :: [AddrRange IPv4]
&gt;&gt;&gt; let rt = fromList $ zip v4 $ repeat ()
&gt;&gt;&gt; findMatch &quot;133.4.0.0/15&quot; rt :: [(AddrRange IPv4,())]
[(133.4.0.0/16,()),(133.5.0.0/16,()),(133.5.16.0/24,()),(133.5.23.0/24,())]
-}</span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span id="local-6989586621679054074"><span id="local-6989586621679054075"><span id="local-6989586621679054076"><span class="annot"><a href="Data.IP.RouteTable.Internal.html#findMatch"><span class="hs-identifier hs-type">findMatch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Alternative</span></span><span> </span><span class="annot"><a href="#local-6989586621679054076"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#Routable"><span class="hs-identifier hs-type">Routable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054075"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.IP.Range.html#AddrRange"><span class="hs-identifier hs-type">AddrRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054075"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#IPRTable"><span class="hs-identifier hs-type">IPRTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054075"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054074"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679054076"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.IP.Range.html#AddrRange"><span class="hs-identifier hs-type">AddrRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054075"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679054074"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-311"></span><span id="findMatch"><span class="annot"><span class="annottext">findMatch :: AddrRange k -&gt; IPRTable k a -&gt; m (AddrRange k, a)
</span><a href="Data.IP.RouteTable.Internal.html#findMatch"><span class="hs-identifier hs-var hs-var">findMatch</span></a></span></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (AddrRange k, a)
forall (f :: * -&gt; *) a. Alternative f =&gt; f a
</span><span class="hs-identifier hs-var">A.empty</span></span><span>
</span><span id="line-312"></span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#findMatch"><span class="hs-identifier hs-var">findMatch</span></a></span><span> </span><span id="local-6989586621679053783"><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053783"><span class="hs-identifier hs-var">k1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span id="local-6989586621679053782"><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053782"><span class="hs-identifier hs-var">k2</span></a></span></span><span> </span><span class="annot"><span class="annottext">k
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span id="local-6989586621679053781"><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053781"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679053780"><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053780"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053783"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k -&gt; AddrRange k -&gt; Bool
forall a. Addr a =&gt; AddrRange a -&gt; AddrRange a -&gt; Bool
</span><a href="Data.IP.Op.html#%3E%3A%3E"><span class="hs-operator hs-var">&gt;:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053782"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AddrRange k -&gt; IPRTable k a -&gt; m (AddrRange k, a)
forall (m :: * -&gt; *) k a.
(Alternative m, Routable k) =&gt;
AddrRange k -&gt; IPRTable k a -&gt; m (AddrRange k, a)
</span><a href="Data.IP.RouteTable.Internal.html#findMatch"><span class="hs-identifier hs-var">findMatch</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053783"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053781"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">m (AddrRange k, a) -&gt; m (AddrRange k, a) -&gt; m (AddrRange k, a)
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">AddrRange k -&gt; IPRTable k a -&gt; m (AddrRange k, a)
forall (m :: * -&gt; *) k a.
(Alternative m, Routable k) =&gt;
AddrRange k -&gt; IPRTable k a -&gt; m (AddrRange k, a)
</span><a href="Data.IP.RouteTable.Internal.html#findMatch"><span class="hs-identifier hs-var">findMatch</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053783"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053780"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-314"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053782"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k -&gt; AddrRange k -&gt; Bool
forall a. Addr a =&gt; AddrRange a -&gt; AddrRange a -&gt; Bool
</span><a href="Data.IP.Op.html#%3E%3A%3E"><span class="hs-operator hs-var">&gt;:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053783"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AddrRange k -&gt; IPRTable k a -&gt; m (AddrRange k, a)
forall (m :: * -&gt; *) k a.
(Alternative m, Routable k) =&gt;
AddrRange k -&gt; IPRTable k a -&gt; m (AddrRange k, a)
</span><a href="Data.IP.RouteTable.Internal.html#findMatch"><span class="hs-identifier hs-var">findMatch</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053783"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053781"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">m (AddrRange k, a) -&gt; m (AddrRange k, a) -&gt; m (AddrRange k, a)
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">AddrRange k -&gt; IPRTable k a -&gt; m (AddrRange k, a)
forall (m :: * -&gt; *) k a.
(Alternative m, Routable k) =&gt;
AddrRange k -&gt; IPRTable k a -&gt; m (AddrRange k, a)
</span><a href="Data.IP.RouteTable.Internal.html#findMatch"><span class="hs-identifier hs-var">findMatch</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053783"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053780"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-315"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (AddrRange k, a)
forall (f :: * -&gt; *) a. Alternative f =&gt; f a
</span><span class="hs-identifier hs-var">A.empty</span></span><span>
</span><span id="line-316"></span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#findMatch"><span class="hs-identifier hs-var">findMatch</span></a></span><span> </span><span id="local-6989586621679053778"><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053778"><span class="hs-identifier hs-var">k1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span id="local-6989586621679053777"><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053777"><span class="hs-identifier hs-var">k2</span></a></span></span><span> </span><span class="annot"><span class="annottext">k
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679053776"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679053776"><span class="hs-identifier hs-var">vl</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679053775"><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053775"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679053774"><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053774"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053778"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k -&gt; AddrRange k -&gt; Bool
forall a. Addr a =&gt; AddrRange a -&gt; AddrRange a -&gt; Bool
</span><a href="Data.IP.Op.html#%3E%3A%3E"><span class="hs-operator hs-var">&gt;:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053777"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(AddrRange k, a) -&gt; m (AddrRange k, a)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053777"><span class="hs-identifier hs-var">k2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679053776"><span class="hs-identifier hs-var">vl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m (AddrRange k, a) -&gt; m (AddrRange k, a) -&gt; m (AddrRange k, a)
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">AddrRange k -&gt; IPRTable k a -&gt; m (AddrRange k, a)
forall (m :: * -&gt; *) k a.
(Alternative m, Routable k) =&gt;
AddrRange k -&gt; IPRTable k a -&gt; m (AddrRange k, a)
</span><a href="Data.IP.RouteTable.Internal.html#findMatch"><span class="hs-identifier hs-var">findMatch</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053778"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053775"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">m (AddrRange k, a) -&gt; m (AddrRange k, a) -&gt; m (AddrRange k, a)
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">AddrRange k -&gt; IPRTable k a -&gt; m (AddrRange k, a)
forall (m :: * -&gt; *) k a.
(Alternative m, Routable k) =&gt;
AddrRange k -&gt; IPRTable k a -&gt; m (AddrRange k, a)
</span><a href="Data.IP.RouteTable.Internal.html#findMatch"><span class="hs-identifier hs-var">findMatch</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053778"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053774"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-318"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053777"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k -&gt; AddrRange k -&gt; Bool
forall a. Addr a =&gt; AddrRange a -&gt; AddrRange a -&gt; Bool
</span><a href="Data.IP.Op.html#%3E%3A%3E"><span class="hs-operator hs-var">&gt;:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053778"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AddrRange k -&gt; IPRTable k a -&gt; m (AddrRange k, a)
forall (m :: * -&gt; *) k a.
(Alternative m, Routable k) =&gt;
AddrRange k -&gt; IPRTable k a -&gt; m (AddrRange k, a)
</span><a href="Data.IP.RouteTable.Internal.html#findMatch"><span class="hs-identifier hs-var">findMatch</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053778"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053775"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">m (AddrRange k, a) -&gt; m (AddrRange k, a) -&gt; m (AddrRange k, a)
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">AddrRange k -&gt; IPRTable k a -&gt; m (AddrRange k, a)
forall (m :: * -&gt; *) k a.
(Alternative m, Routable k) =&gt;
AddrRange k -&gt; IPRTable k a -&gt; m (AddrRange k, a)
</span><a href="Data.IP.RouteTable.Internal.html#findMatch"><span class="hs-identifier hs-var">findMatch</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053778"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053774"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-319"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (AddrRange k, a)
forall (f :: * -&gt; *) a. Alternative f =&gt; f a
</span><span class="hs-identifier hs-var">A.empty</span></span><span>
</span><span id="line-320"></span><span>
</span><span id="line-321"></span><span class="hs-comment">----------------------------------------------------------------</span><span>
</span><span id="line-322"></span><span>
</span><span id="line-323"></span><span class="hs-comment">{-|
  The 'fromList' function creates a new IP routing table from
  a list of a pair of 'IPrange' and value.
-}</span><span>
</span><span id="line-327"></span><span id="local-6989586621679053772"><span id="local-6989586621679053773"><span class="annot"><a href="Data.IP.RouteTable.Internal.html#fromList"><span class="hs-identifier hs-type">fromList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#Routable"><span class="hs-identifier hs-type">Routable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053773"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Data.IP.Range.html#AddrRange"><span class="hs-identifier hs-type">AddrRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053773"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679053772"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#IPRTable"><span class="hs-identifier hs-type">IPRTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053773"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053772"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-328"></span><span id="fromList"><span class="annot"><span class="annottext">fromList :: [(AddrRange k, a)] -&gt; IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#fromList"><span class="hs-identifier hs-var hs-var">fromList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(IPRTable k a -&gt; (AddrRange k, a) -&gt; IPRTable k a)
-&gt; IPRTable k a -&gt; [(AddrRange k, a)] -&gt; IPRTable k a
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679053769"><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053769"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679053768"><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053768"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679053767"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679053767"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AddrRange k -&gt; a -&gt; IPRTable k a -&gt; IPRTable k a
forall k a.
Routable k =&gt;
AddrRange k -&gt; a -&gt; IPRTable k a -&gt; IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#insert"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053768"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679053767"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053769"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IPRTable k a
forall k a. Routable k =&gt; IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-329"></span><span>
</span><span id="line-330"></span><span class="hs-comment">{-|
  The 'toList' function creates a list of a pair of 'AddrRange' and
  value from an IP routing table.
-}</span><span>
</span><span id="line-334"></span><span id="local-6989586621679053765"><span id="local-6989586621679053766"><span class="annot"><a href="Data.IP.RouteTable.Internal.html#toList"><span class="hs-identifier hs-type">toList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#Routable"><span class="hs-identifier hs-type">Routable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053766"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#IPRTable"><span class="hs-identifier hs-type">IPRTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053766"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053765"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Data.IP.Range.html#AddrRange"><span class="hs-identifier hs-type">AddrRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053766"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679053765"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-335"></span><span id="toList"><span class="annot"><span class="annottext">toList :: IPRTable k a -&gt; [(AddrRange k, a)]
</span><a href="Data.IP.RouteTable.Internal.html#toList"><span class="hs-identifier hs-var hs-var">toList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(IPRTable k a -&gt; [(AddrRange k, a)] -&gt; [(AddrRange k, a)])
-&gt; [(AddrRange k, a)] -&gt; IPRTable k a -&gt; [(AddrRange k, a)]
forall k a b. (IPRTable k a -&gt; b -&gt; b) -&gt; b -&gt; IPRTable k a -&gt; b
</span><a href="Data.IP.RouteTable.Internal.html#foldt"><span class="hs-identifier hs-var">foldt</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a -&gt; [(AddrRange k, a)] -&gt; [(AddrRange k, a)]
forall k b.
IPRTable k b -&gt; [(AddrRange k, b)] -&gt; [(AddrRange k, b)]
</span><a href="#local-6989586621679053762"><span class="hs-identifier hs-var">toL</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-336"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-337"></span><span>    </span><span id="local-6989586621679053762"><span class="annot"><span class="annottext">toL :: IPRTable k b -&gt; [(AddrRange k, b)] -&gt; [(AddrRange k, b)]
</span><a href="#local-6989586621679053762"><span class="hs-identifier hs-var hs-var">toL</span></a></span></span><span> </span><span class="annot"><span class="annottext">IPRTable k b
</span><a href="Data.IP.RouteTable.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span> </span><span id="local-6989586621679053761"><span class="annot"><span class="annottext">[(AddrRange k, b)]
</span><a href="#local-6989586621679053761"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(AddrRange k, b)]
</span><a href="#local-6989586621679053761"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-338"></span><span>    </span><span class="annot"><a href="#local-6989586621679053762"><span class="hs-identifier hs-var">toL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">k
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe b
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="annot"><span class="annottext">IPRTable k b
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">IPRTable k b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679053760"><span class="annot"><span class="annottext">[(AddrRange k, b)]
</span><a href="#local-6989586621679053760"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(AddrRange k, b)]
</span><a href="#local-6989586621679053760"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-339"></span><span>    </span><span class="annot"><a href="#local-6989586621679053762"><span class="hs-identifier hs-var">toL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span id="local-6989586621679053759"><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053759"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="annot"><span class="annottext">k
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679053758"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679053758"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IPRTable k b
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">IPRTable k b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679053757"><span class="annot"><span class="annottext">[(AddrRange k, b)]
</span><a href="#local-6989586621679053757"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053759"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679053758"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(AddrRange k, b) -&gt; [(AddrRange k, b)] -&gt; [(AddrRange k, b)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(AddrRange k, b)]
</span><a href="#local-6989586621679053757"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-340"></span><span>
</span><span id="line-341"></span><span class="hs-comment">----------------------------------------------------------------</span><span>
</span><span id="line-342"></span><span>
</span><span id="line-343"></span><span id="local-6989586621679054066"><span id="local-6989586621679054067"><span id="local-6989586621679054068"><span class="annot"><a href="Data.IP.RouteTable.Internal.html#foldt"><span class="hs-identifier hs-type">foldt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#IPRTable"><span class="hs-identifier hs-type">IPRTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054068"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054067"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679054066"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679054066"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679054066"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#IPRTable"><span class="hs-identifier hs-type">IPRTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054068"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054067"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679054066"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-344"></span><span id="foldt"><span class="annot"><span class="annottext">foldt :: (IPRTable k a -&gt; b -&gt; b) -&gt; b -&gt; IPRTable k a -&gt; b
</span><a href="Data.IP.RouteTable.Internal.html#foldt"><span class="hs-identifier hs-var hs-var">foldt</span></a></span></span><span> </span><span class="annot"><span class="annottext">IPRTable k a -&gt; b -&gt; b
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679053756"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679053756"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679053756"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-345"></span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#foldt"><span class="hs-identifier hs-var">foldt</span></a></span><span> </span><span id="local-6989586621679053755"><span class="annot"><span class="annottext">IPRTable k a -&gt; b -&gt; b
</span><a href="#local-6989586621679053755"><span class="hs-identifier hs-var">func</span></a></span></span><span> </span><span id="local-6989586621679053754"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679053754"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679053753"><span class="annot"><span class="annottext">rt :: IPRTable k a
</span><a href="#local-6989586621679053753"><span class="hs-identifier hs-var">rt</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">k
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679053752"><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053752"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679053751"><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053751"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(IPRTable k a -&gt; b -&gt; b) -&gt; b -&gt; IPRTable k a -&gt; b
forall k a b. (IPRTable k a -&gt; b -&gt; b) -&gt; b -&gt; IPRTable k a -&gt; b
</span><a href="Data.IP.RouteTable.Internal.html#foldt"><span class="hs-identifier hs-var">foldt</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a -&gt; b -&gt; b
</span><a href="#local-6989586621679053755"><span class="hs-identifier hs-var">func</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(IPRTable k a -&gt; b -&gt; b) -&gt; b -&gt; IPRTable k a -&gt; b
forall k a b. (IPRTable k a -&gt; b -&gt; b) -&gt; b -&gt; IPRTable k a -&gt; b
</span><a href="Data.IP.RouteTable.Internal.html#foldt"><span class="hs-identifier hs-var">foldt</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a -&gt; b -&gt; b
</span><a href="#local-6989586621679053755"><span class="hs-identifier hs-var">func</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IPRTable k a -&gt; b -&gt; b
</span><a href="#local-6989586621679053755"><span class="hs-identifier hs-var">func</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053753"><span class="hs-identifier hs-var">rt</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679053754"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053752"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053751"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-346"></span><span>
</span><span id="line-347"></span><span class="hs-comment">-- | /O(n)/. Fold the keys and values in the IPRTable using the given</span><span>
</span><span id="line-348"></span><span class="hs-comment">--   left-associative binary operator.</span><span>
</span><span id="line-349"></span><span class="hs-comment">--   This function is equivalent to Data.Map.foldlWithKey with necessary to</span><span>
</span><span id="line-350"></span><span class="hs-comment">--   IPRTable changes.</span><span>
</span><span id="line-351"></span><span class="hs-comment">--   Since: 1.7.5</span><span>
</span><span id="line-352"></span><span id="local-6989586621679054132"><span id="local-6989586621679054133"><span id="local-6989586621679054134"><span class="annot"><a href="Data.IP.RouteTable.Internal.html#foldlWithKey"><span class="hs-identifier hs-type">foldlWithKey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679054134"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.IP.Range.html#AddrRange"><span class="hs-identifier hs-type">AddrRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054133"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679054132"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679054134"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679054134"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#IPRTable"><span class="hs-identifier hs-type">IPRTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054133"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054132"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679054134"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-353"></span><span id="foldlWithKey"><span class="annot"><span class="annottext">foldlWithKey :: (b -&gt; AddrRange k -&gt; a -&gt; b) -&gt; b -&gt; IPRTable k a -&gt; b
</span><a href="Data.IP.RouteTable.Internal.html#foldlWithKey"><span class="hs-identifier hs-var hs-var">foldlWithKey</span></a></span></span><span> </span><span id="local-6989586621679053750"><span class="annot"><span class="annottext">b -&gt; AddrRange k -&gt; a -&gt; b
</span><a href="#local-6989586621679053750"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679053749"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679053749"><span class="hs-identifier hs-var">zr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; IPRTable k a -&gt; b
</span><a href="#local-6989586621679053748"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679053749"><span class="hs-identifier hs-var">zr</span></a></span><span>
</span><span id="line-354"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-355"></span><span>    </span><span id="local-6989586621679053748"><span class="annot"><span class="annottext">go :: b -&gt; IPRTable k a -&gt; b
</span><a href="#local-6989586621679053748"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679053747"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679053747"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679053747"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-356"></span><span>    </span><span class="annot"><a href="#local-6989586621679053748"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679053746"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679053746"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">k
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span id="local-6989586621679053745"><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053745"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679053744"><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053744"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; IPRTable k a -&gt; b
</span><a href="#local-6989586621679053748"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; IPRTable k a -&gt; b
</span><a href="#local-6989586621679053748"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679053746"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053745"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053744"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-357"></span><span>    </span><span class="annot"><a href="#local-6989586621679053748"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679053743"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679053743"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span id="local-6989586621679053742"><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053742"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">k
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679053741"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679053741"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679053740"><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053740"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679053739"><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053739"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; IPRTable k a -&gt; b
</span><a href="#local-6989586621679053748"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; AddrRange k -&gt; a -&gt; b
</span><a href="#local-6989586621679053750"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; IPRTable k a -&gt; b
</span><a href="#local-6989586621679053748"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679053743"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053740"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053742"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679053741"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053739"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-358"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#foldlWithKey"><span class="hs-pragma hs-type">foldlWithKey</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span class="hs-comment">-- | /O(n)/. Fold the keys and values in the IPRTable using the given</span><span>
</span><span id="line-361"></span><span class="hs-comment">--   right-associative binary operator.</span><span>
</span><span id="line-362"></span><span class="hs-comment">--   This function is equivalent to Data.Map.foldrWithKey with necessary to</span><span>
</span><span id="line-363"></span><span class="hs-comment">--   IPRTable changes.</span><span>
</span><span id="line-364"></span><span class="hs-comment">--   Since: 1.7.5</span><span>
</span><span id="line-365"></span><span id="local-6989586621679053736"><span id="local-6989586621679053737"><span id="local-6989586621679053738"><span class="annot"><a href="Data.IP.RouteTable.Internal.html#foldrWithKey"><span class="hs-identifier hs-type">foldrWithKey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.IP.Range.html#AddrRange"><span class="hs-identifier hs-type">AddrRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053738"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679053737"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679053736"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679053736"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679053736"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#IPRTable"><span class="hs-identifier hs-type">IPRTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053738"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053737"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679053736"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-366"></span><span id="foldrWithKey"><span class="annot"><span class="annottext">foldrWithKey :: (AddrRange k -&gt; a -&gt; b -&gt; b) -&gt; b -&gt; IPRTable k a -&gt; b
</span><a href="Data.IP.RouteTable.Internal.html#foldrWithKey"><span class="hs-identifier hs-var hs-var">foldrWithKey</span></a></span></span><span> </span><span id="local-6989586621679053734"><span class="annot"><span class="annottext">AddrRange k -&gt; a -&gt; b -&gt; b
</span><a href="#local-6989586621679053734"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679053733"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679053733"><span class="hs-identifier hs-var">zr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; IPRTable k a -&gt; b
</span><a href="#local-6989586621679053732"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679053733"><span class="hs-identifier hs-var">zr</span></a></span><span>
</span><span id="line-367"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-368"></span><span>    </span><span id="local-6989586621679053732"><span class="annot"><span class="annottext">go :: b -&gt; IPRTable k a -&gt; b
</span><a href="#local-6989586621679053732"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679053731"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679053731"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="Data.IP.RouteTable.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679053731"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-369"></span><span>    </span><span class="annot"><a href="#local-6989586621679053732"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679053730"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679053730"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">k
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span id="local-6989586621679053729"><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053729"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679053728"><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053728"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; IPRTable k a -&gt; b
</span><a href="#local-6989586621679053732"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; IPRTable k a -&gt; b
</span><a href="#local-6989586621679053732"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679053730"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053728"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053729"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-370"></span><span>    </span><span class="annot"><a href="#local-6989586621679053732"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679053727"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679053727"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span id="local-6989586621679053726"><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053726"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">k
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679053725"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679053725"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679053724"><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053724"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679053723"><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053723"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; IPRTable k a -&gt; b
</span><a href="#local-6989586621679053732"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrRange k -&gt; a -&gt; b -&gt; b
</span><a href="#local-6989586621679053734"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange k
</span><a href="#local-6989586621679053726"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679053725"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; IPRTable k a -&gt; b
</span><a href="#local-6989586621679053732"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679053727"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053723"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IPRTable k a
</span><a href="#local-6989586621679053724"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-371"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.IP.RouteTable.Internal.html#foldrWithKey"><span class="hs-pragma hs-type">foldrWithKey</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-372"></span></pre></body></html>