<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- Copyright (C) 2013, 2014, 2015, 2016, 2017  Fraser Tweedale</span><span>
</span><span id="line-2"></span><span class="hs-comment">--</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- you may not use this file except in compliance with the License.</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- You may obtain a copy of the License at</span><span>
</span><span id="line-6"></span><span class="hs-comment">--</span><span>
</span><span id="line-7"></span><span class="hs-comment">--      http://www.apache.org/licenses/LICENSE-2.0</span><span>
</span><span id="line-8"></span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Unless required by applicable law or agreed to in writing, software</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- See the License for the specific language governing permissions and</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- limitations under the License.</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-17"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-18"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-19"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell #-}</span><span>
</span><span id="line-20"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-21"></span><span class="hs-pragma">{-# LANGUAGE MonoLocalBinds #-}</span><span>
</span><span id="line-22"></span><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-orphans #-}</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="hs-comment">{-|

JSON Web Token implementation (RFC 7519). A JWT is a JWS
with a payload of /claims/ to be transferred between two
parties.

JWTs use the JWS /compact serialisation/.
See &quot;Crypto.JOSE.Compact&quot; for details.

@
mkClaims :: IO 'ClaimsSet'
mkClaims = do
  t &lt;- 'currentTime'
  pure $ 'emptyClaimsSet'
    &amp; 'claimIss' ?~ &quot;alice&quot;
    &amp; 'claimAud' ?~ 'Audience' [&quot;bob&quot;]
    &amp; 'claimIat' ?~ 'NumericDate' t

doJwtSign :: 'JWK' -&gt; 'ClaimsSet' -&gt; IO (Either 'JWTError' 'SignedJWT')
doJwtSign jwk claims = runExceptT $ do
  alg \&lt;- 'bestJWSAlg' jwk
  'signClaims' jwk ('newJWSHeader' ((), alg)) claims

doJwtVerify :: 'JWK' -&gt; 'SignedJWT' -&gt; IO (Either 'JWTError' 'ClaimsSet')
doJwtVerify jwk jwt = runExceptT $ do
  let config = 'defaultJWTValidationSettings' (== &quot;bob&quot;)
  'verifyClaims' config jwk jwt
@

Some JWT libraries have a function that takes two strings: the
&quot;secret&quot; (a symmetric key) and the raw JWT.  The following function
achieves the same:

@
verify :: L.ByteString -&gt; L.ByteString -&gt; IO (Either 'JWTError' 'ClaimsSet')
verify k s = runExceptT $ do
  let
    k' = 'fromOctets' k      -- turn raw secret into symmetric JWK
    audCheck = const True  -- should be a proper audience check
  s' &lt;- 'decodeCompact' s    -- decode JWT
  'verifyClaims' ('defaultJWTValidationSettings' audCheck) k' s'
@

-}</span><span>
</span><span id="line-68"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Crypto.JWT</span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-special">(</span><span>
</span><span id="line-70"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Creating a JWT</span></span><span>
</span><span id="line-71"></span><span>    </span><span class="annot"><a href="Crypto.JWT.html#signClaims"><span class="hs-identifier">signClaims</span></a></span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#SignedJWT"><span class="hs-identifier">SignedJWT</span></a></span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Validating a JWT and extracting claims</span></span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#defaultJWTValidationSettings"><span class="hs-identifier">defaultJWTValidationSettings</span></a></span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#verifyClaims"><span class="hs-identifier">verifyClaims</span></a></span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#verifyClaimsAt"><span class="hs-identifier">verifyClaimsAt</span></a></span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#HasAllowedSkew"><span class="hs-identifier">HasAllowedSkew</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#HasAudiencePredicate"><span class="hs-identifier">HasAudiencePredicate</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#HasIssuerPredicate"><span class="hs-identifier">HasIssuerPredicate</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#HasCheckIssuedAt"><span class="hs-identifier">HasCheckIssuedAt</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#JWTValidationSettings"><span class="hs-identifier">JWTValidationSettings</span></a></span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#HasJWTValidationSettings"><span class="hs-identifier">HasJWTValidationSettings</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Claims Set</span></span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#ClaimsSet"><span class="hs-identifier">ClaimsSet</span></a></span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#claimAud"><span class="hs-identifier">claimAud</span></a></span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#claimExp"><span class="hs-identifier">claimExp</span></a></span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#claimIat"><span class="hs-identifier">claimIat</span></a></span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#claimIss"><span class="hs-identifier">claimIss</span></a></span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#claimJti"><span class="hs-identifier">claimJti</span></a></span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#claimNbf"><span class="hs-identifier">claimNbf</span></a></span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#claimSub"><span class="hs-identifier">claimSub</span></a></span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#unregisteredClaims"><span class="hs-identifier">unregisteredClaims</span></a></span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#addClaim"><span class="hs-identifier">addClaim</span></a></span><span>
</span><span id="line-96"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#emptyClaimsSet"><span class="hs-identifier">emptyClaimsSet</span></a></span><span>
</span><span id="line-97"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#validateClaimsSet"><span class="hs-identifier">validateClaimsSet</span></a></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span>  </span><span class="annot"><span class="hs-comment">-- * JWT errors</span></span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#JWTError"><span class="hs-identifier">JWTError</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#AsJWTError"><span class="hs-identifier">AsJWTError</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Miscellaneous</span></span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#Audience"><span class="hs-identifier">Audience</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#StringOrURI"><span class="hs-identifier">StringOrURI</span></a></span><span>
</span><span id="line-106"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#stringOrUri"><span class="hs-identifier">stringOrUri</span></a></span><span>
</span><span id="line-107"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#string"><span class="hs-identifier">string</span></a></span><span>
</span><span id="line-108"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#uri"><span class="hs-identifier">uri</span></a></span><span>
</span><span id="line-109"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#NumericDate"><span class="hs-identifier">NumericDate</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Crypto.JOSE.html"><span class="hs-identifier">Crypto.JOSE</span></a></span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span>
</span><span id="line-116"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-117"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Time</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadTime</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#if ! MIN_VERSION_monad_time(0,2,0)
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad.Time.Instances</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">traverse_</span></span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor.Identity</span></span><span>
</span><span id="line-123"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-124"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.String</span></span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-127"></span><span>  </span><span class="annot"><span class="hs-identifier">makeClassy</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">makeClassyPrisms</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">makePrisms</span></span><span class="hs-special">,</span><span>
</span><span id="line-128"></span><span>  </span><span class="annot"><span class="hs-identifier">Lens'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">_Just</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">over</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">preview</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">view</span></span><span class="hs-special">,</span><span>
</span><span id="line-129"></span><span>  </span><span class="annot"><span class="hs-identifier">Prism'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">prism'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Cons</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">iso</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">AsEmpty</span></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Lens.Cons.Extras</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">recons</span></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Error.Lens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">throwing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">throwing_</span></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Except</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadError</span></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Reader</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ReaderT</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ask</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">runReaderT</span></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span>
</span><span id="line-135"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.HashMap.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-136"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-137"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Time</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NominalDiffTime</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">UTCTime</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">addUTCTime</span></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Time.Clock.POSIX</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">posixSecondsToUTCTime</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">utcTimeToPOSIXSeconds</span></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Network.URI</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">parseURI</span></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.JOSE.html"><span class="hs-identifier">Crypto.JOSE</span></a></span><span>
</span><span id="line-142"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.JOSE.Types.html"><span class="hs-identifier">Crypto.JOSE.Types</span></a></span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span class="hs-keyword">data</span><span> </span><span id="JWTError"><span class="annot"><a href="Crypto.JWT.html#JWTError"><span class="hs-identifier hs-var">JWTError</span></a></span></span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="JWSError"><span class="annot"><a href="Crypto.JWT.html#JWSError"><span class="hs-identifier hs-var">JWSError</span></a></span></span><span> </span><span class="annot"><a href="Crypto.JOSE.Error.html#Error"><span class="hs-identifier hs-type">Error</span></a></span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-comment">-- ^ A JOSE error occurred while processing the JWT</span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="JWTClaimsSetDecodeError"><span class="annot"><a href="Crypto.JWT.html#JWTClaimsSetDecodeError"><span class="hs-identifier hs-var">JWTClaimsSetDecodeError</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-149"></span><span>  </span><span class="hs-comment">-- ^ The JWT payload is not a JWT Claims Set</span><span>
</span><span id="line-150"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="JWTExpired"><span class="annot"><a href="Crypto.JWT.html#JWTExpired"><span class="hs-identifier hs-var">JWTExpired</span></a></span></span><span>
</span><span id="line-151"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="JWTNotYetValid"><span class="annot"><a href="Crypto.JWT.html#JWTNotYetValid"><span class="hs-identifier hs-var">JWTNotYetValid</span></a></span></span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="JWTNotInIssuer"><span class="annot"><a href="Crypto.JWT.html#JWTNotInIssuer"><span class="hs-identifier hs-var">JWTNotInIssuer</span></a></span></span><span>
</span><span id="line-153"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="JWTNotInAudience"><span class="annot"><a href="Crypto.JWT.html#JWTNotInAudience"><span class="hs-identifier hs-var">JWTNotInAudience</span></a></span></span><span>
</span><span id="line-154"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="JWTIssuedAtFuture"><span class="annot"><a href="Crypto.JWT.html#JWTIssuedAtFuture"><span class="hs-identifier hs-var">JWTIssuedAtFuture</span></a></span></span><span>
</span><span id="line-155"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679340619"><span id="local-6989586621679340621"><span class="annot"><span class="annottext">JWTError -&gt; JWTError -&gt; Bool
(JWTError -&gt; JWTError -&gt; Bool)
-&gt; (JWTError -&gt; JWTError -&gt; Bool) -&gt; Eq JWTError
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: JWTError -&gt; JWTError -&gt; Bool
$c/= :: JWTError -&gt; JWTError -&gt; Bool
== :: JWTError -&gt; JWTError -&gt; Bool
$c== :: JWTError -&gt; JWTError -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679340612"><span id="local-6989586621679340614"><span id="local-6989586621679340616"><span class="annot"><span class="annottext">Int -&gt; JWTError -&gt; ShowS
[JWTError] -&gt; ShowS
JWTError -&gt; String
(Int -&gt; JWTError -&gt; ShowS)
-&gt; (JWTError -&gt; String) -&gt; ([JWTError] -&gt; ShowS) -&gt; Show JWTError
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [JWTError] -&gt; ShowS
$cshowList :: [JWTError] -&gt; ShowS
show :: JWTError -&gt; String
$cshow :: JWTError -&gt; String
showsPrec :: Int -&gt; JWTError -&gt; ShowS
$cshowsPrec :: Int -&gt; JWTError -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span id="_JWTIssuedAtFuture"><span id="_JWTNotInAudience"><span id="_JWTNotInIssuer"><span id="_JWTNotYetValid"><span id="_JWTExpired"><span id="_JWTClaimsSetDecodeError"><span id="_JWSError"><span id="_JWTError"><span id="local-6989586621679340588"><span id="local-6989586621679340590"><span id="local-6989586621679340592"><span id="local-6989586621679340594"><span id="local-6989586621679340596"><span id="local-6989586621679340598"><span id="local-6989586621679340600"><span id="local-6989586621679340602"><span id="local-6989586621679340604"><span id="local-6989586621679340605"><span id="local-6989586621679340606"><span id="local-6989586621679340607"><span id="local-6989586621679340608"><span id="local-6989586621679340609"><span id="local-6989586621679340610"><span id="AsJWTError"><span id="local-6989586621679341007"><span class="hs-identifier">makeClassyPrisms</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">JWTError</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679340550"><span id="local-6989586621679340552"><span id="local-6989586621679340554"><span id="local-6989586621679340556"><span id="local-6989586621679340558"><span id="local-6989586621679340560"><span id="local-6989586621679340562"><span id="local-6989586621679340564"><span id="local-6989586621679340566"><span id="local-6989586621679340568"><span id="local-6989586621679340570"><span id="local-6989586621679340572"><span id="local-6989586621679340574"><span id="local-6989586621679340576"><span class="annot"><a href="Crypto.JOSE.Error.html#AsError"><span class="hs-identifier hs-type">AsError</span></a></span><span> </span><span class="annot"><a href="Crypto.JWT.html#JWTError"><span class="hs-identifier hs-type">JWTError</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-159"></span><span>  </span><span id="local-6989586621679340548"><span class="annot"><span class="annottext">_Error :: p Error (f Error) -&gt; p JWTError (f JWTError)
</span><a href="Crypto.JOSE.Error.html#_Error"><span class="hs-identifier hs-var hs-var hs-var hs-var">_Error</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p Error (f Error) -&gt; p JWTError (f JWTError)
forall r. AsJWTError r =&gt; Prism' r Error
</span><a href="Crypto.JWT.html#_JWSError"><span class="hs-identifier hs-var">_JWSError</span></a></span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="hs-comment">-- RFC 7519 &#167;2.  Terminology</span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="hs-comment">-- | A JSON string value, with the additional requirement that while</span><span>
</span><span id="line-165"></span><span class="hs-comment">--   arbitrary string values MAY be used, any value containing a @:@</span><span>
</span><span id="line-166"></span><span class="hs-comment">--   character MUST be a URI.</span><span>
</span><span id="line-167"></span><span class="hs-comment">--</span><span>
</span><span id="line-168"></span><span class="hs-comment">-- __Note__: the 'IsString' instance will fail if the string</span><span>
</span><span id="line-169"></span><span class="hs-comment">-- contains a @:@ but does not parse as a 'URI'.  Use 'stringOrUri'</span><span>
</span><span id="line-170"></span><span class="hs-comment">-- directly in this situation.</span><span>
</span><span id="line-171"></span><span class="hs-comment">--</span><span>
</span><span id="line-172"></span><span class="hs-keyword">data</span><span> </span><span id="StringOrURI"><span class="annot"><a href="Crypto.JWT.html#StringOrURI"><span class="hs-identifier hs-var">StringOrURI</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Arbitrary"><span class="annot"><a href="Crypto.JWT.html#Arbitrary"><span class="hs-identifier hs-var">Arbitrary</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="OrURI"><span class="annot"><a href="Crypto.JWT.html#OrURI"><span class="hs-identifier hs-var">OrURI</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">URI</span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679340541"><span id="local-6989586621679340543"><span class="annot"><span class="annottext">StringOrURI -&gt; StringOrURI -&gt; Bool
(StringOrURI -&gt; StringOrURI -&gt; Bool)
-&gt; (StringOrURI -&gt; StringOrURI -&gt; Bool) -&gt; Eq StringOrURI
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: StringOrURI -&gt; StringOrURI -&gt; Bool
$c/= :: StringOrURI -&gt; StringOrURI -&gt; Bool
== :: StringOrURI -&gt; StringOrURI -&gt; Bool
$c== :: StringOrURI -&gt; StringOrURI -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679340535"><span id="local-6989586621679340537"><span id="local-6989586621679340539"><span class="annot"><span class="annottext">Int -&gt; StringOrURI -&gt; ShowS
[StringOrURI] -&gt; ShowS
StringOrURI -&gt; String
(Int -&gt; StringOrURI -&gt; ShowS)
-&gt; (StringOrURI -&gt; String)
-&gt; ([StringOrURI] -&gt; ShowS)
-&gt; Show StringOrURI
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [StringOrURI] -&gt; ShowS
$cshowList :: [StringOrURI] -&gt; ShowS
show :: StringOrURI -&gt; String
$cshow :: StringOrURI -&gt; String
showsPrec :: Int -&gt; StringOrURI -&gt; ShowS
$cshowsPrec :: Int -&gt; StringOrURI -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span class="hs-comment">-- | Non-total.  A string with a @':'@ in it MUST parse as a URI</span><span>
</span><span id="line-175"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Data.String.IsString</span></span><span> </span><span class="annot"><a href="Crypto.JWT.html#StringOrURI"><span class="hs-identifier hs-type">StringOrURI</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-176"></span><span>  </span><span id="local-6989586621679340532"><span class="annot"><span class="annottext">fromString :: String -&gt; StringOrURI
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fromString</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe StringOrURI -&gt; StringOrURI
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe StringOrURI -&gt; StringOrURI)
-&gt; (String -&gt; Maybe StringOrURI) -&gt; String -&gt; StringOrURI
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Getting (First StringOrURI) String StringOrURI
-&gt; String -&gt; Maybe StringOrURI
forall s (m :: * -&gt; *) a.
MonadReader s m =&gt;
Getting (First a) s a -&gt; m (Maybe a)
</span><span class="hs-identifier hs-var">preview</span></span><span> </span><span class="annot"><span class="annottext">Getting (First StringOrURI) String StringOrURI
forall s. (Cons s s Char Char, AsEmpty s) =&gt; Prism' s StringOrURI
</span><a href="Crypto.JWT.html#stringOrUri"><span class="hs-identifier hs-var">stringOrUri</span></a></span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span id="local-6989586621679340927"><span class="annot"><a href="Crypto.JWT.html#stringOrUri"><span class="hs-identifier hs-type">stringOrUri</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Cons</span></span><span> </span><span class="annot"><a href="#local-6989586621679340927"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340927"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AsEmpty</span></span><span> </span><span class="annot"><a href="#local-6989586621679340927"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Prism'</span></span><span> </span><span class="annot"><a href="#local-6989586621679340927"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="Crypto.JWT.html#StringOrURI"><span class="hs-identifier hs-type">StringOrURI</span></a></span></span><span>
</span><span id="line-179"></span><span id="stringOrUri"><span class="annot"><span class="annottext">stringOrUri :: Prism' s StringOrURI
</span><a href="Crypto.JWT.html#stringOrUri"><span class="hs-identifier hs-var hs-var">stringOrUri</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(s -&gt; Text) -&gt; (Text -&gt; s) -&gt; Iso s s Text Text
forall s a b t. (s -&gt; a) -&gt; (b -&gt; t) -&gt; Iso s t a b
</span><span class="hs-identifier hs-var">iso</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting Text s Text -&gt; s -&gt; Text
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting Text s Text
forall s1 a s2.
(Cons s1 s1 a a, Cons s2 s2 a a, AsEmpty s2) =&gt;
Getter s1 s2
</span><span class="hs-identifier hs-var">recons</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting s Text s -&gt; Text -&gt; s
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting s Text s
forall s1 a s2.
(Cons s1 s1 a a, Cons s2 s2 a a, AsEmpty s2) =&gt;
Getter s1 s2
</span><span class="hs-identifier hs-var">recons</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(p Text (f Text) -&gt; p s (f s))
-&gt; (p StringOrURI (f StringOrURI) -&gt; p Text (f Text))
-&gt; p StringOrURI (f StringOrURI)
-&gt; p s (f s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(StringOrURI -&gt; Text)
-&gt; (Text -&gt; Maybe StringOrURI)
-&gt; Prism Text Text StringOrURI StringOrURI
forall b s a. (b -&gt; s) -&gt; (s -&gt; Maybe a) -&gt; Prism s s a b
</span><span class="hs-identifier hs-var">prism'</span></span><span> </span><span class="annot"><span class="annottext">StringOrURI -&gt; Text
</span><a href="#local-6989586621679340529"><span class="hs-identifier hs-var">rev</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe StringOrURI
</span><a href="#local-6989586621679340528"><span class="hs-identifier hs-var">fwd</span></a></span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-181"></span><span>  </span><span id="local-6989586621679340529"><span class="annot"><span class="annottext">rev :: StringOrURI -&gt; Text
</span><a href="#local-6989586621679340529"><span class="hs-identifier hs-var hs-var">rev</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JWT.html#Arbitrary"><span class="hs-identifier hs-type">Arbitrary</span></a></span><span> </span><span id="local-6989586621679340527"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679340527"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679340527"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-182"></span><span>  </span><span class="annot"><a href="#local-6989586621679340529"><span class="hs-identifier hs-var">rev</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JWT.html#OrURI"><span class="hs-identifier hs-type">OrURI</span></a></span><span> </span><span id="local-6989586621679340526"><span class="annot"><span class="annottext">URI
</span><a href="#local-6989586621679340526"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">URI -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">URI
</span><a href="#local-6989586621679340526"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>  </span><span id="local-6989586621679340528"><span class="annot"><span class="annottext">fwd :: Text -&gt; Maybe StringOrURI
</span><a href="#local-6989586621679340528"><span class="hs-identifier hs-var hs-var">fwd</span></a></span></span><span> </span><span id="local-6989586621679340523"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679340523"><span class="hs-identifier hs-var">s</span></a></span></span><span>
</span><span id="line-184"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Text -&gt; Bool
</span><span class="hs-identifier hs-var">T.any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">':'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679340523"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">URI -&gt; StringOrURI
</span><a href="Crypto.JWT.html#OrURI"><span class="hs-identifier hs-var">OrURI</span></a></span><span> </span><span class="annot"><span class="annottext">(URI -&gt; StringOrURI) -&gt; Maybe URI -&gt; Maybe StringOrURI
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe URI
</span><span class="hs-identifier hs-var">parseURI</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679340523"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StringOrURI -&gt; Maybe StringOrURI
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; StringOrURI
</span><a href="Crypto.JWT.html#Arbitrary"><span class="hs-identifier hs-var">Arbitrary</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679340523"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="annot"><a href="Crypto.JWT.html#string"><span class="hs-identifier hs-type">string</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Prism'</span></span><span> </span><span class="annot"><a href="Crypto.JWT.html#StringOrURI"><span class="hs-identifier hs-type">StringOrURI</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-188"></span><span id="string"><span class="annot"><span class="annottext">string :: p Text (f Text) -&gt; p StringOrURI (f StringOrURI)
</span><a href="Crypto.JWT.html#string"><span class="hs-identifier hs-var hs-var">string</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; StringOrURI)
-&gt; (StringOrURI -&gt; Maybe Text)
-&gt; Prism StringOrURI StringOrURI Text Text
forall b s a. (b -&gt; s) -&gt; (s -&gt; Maybe a) -&gt; Prism s s a b
</span><span class="hs-identifier hs-var">prism'</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; StringOrURI
</span><a href="Crypto.JWT.html#Arbitrary"><span class="hs-identifier hs-var">Arbitrary</span></a></span><span> </span><span class="annot"><span class="annottext">StringOrURI -&gt; Maybe Text
</span><a href="#local-6989586621679340519"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-189"></span><span>  </span><span id="local-6989586621679340519"><span class="annot"><span class="annottext">f :: StringOrURI -&gt; Maybe Text
</span><a href="#local-6989586621679340519"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JWT.html#Arbitrary"><span class="hs-identifier hs-type">Arbitrary</span></a></span><span> </span><span id="local-6989586621679340518"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679340518"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe Text
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679340518"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-190"></span><span>  </span><span class="annot"><a href="#local-6989586621679340519"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">StringOrURI
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="annot"><a href="Crypto.JWT.html#uri"><span class="hs-identifier hs-type">uri</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Prism'</span></span><span> </span><span class="annot"><a href="Crypto.JWT.html#StringOrURI"><span class="hs-identifier hs-type">StringOrURI</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">URI</span></span><span>
</span><span id="line-193"></span><span id="uri"><span class="annot"><span class="annottext">uri :: p URI (f URI) -&gt; p StringOrURI (f StringOrURI)
</span><a href="Crypto.JWT.html#uri"><span class="hs-identifier hs-var hs-var">uri</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(URI -&gt; StringOrURI)
-&gt; (StringOrURI -&gt; Maybe URI)
-&gt; Prism StringOrURI StringOrURI URI URI
forall b s a. (b -&gt; s) -&gt; (s -&gt; Maybe a) -&gt; Prism s s a b
</span><span class="hs-identifier hs-var">prism'</span></span><span> </span><span class="annot"><span class="annottext">URI -&gt; StringOrURI
</span><a href="Crypto.JWT.html#OrURI"><span class="hs-identifier hs-var">OrURI</span></a></span><span> </span><span class="annot"><span class="annottext">StringOrURI -&gt; Maybe URI
</span><a href="#local-6989586621679340517"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-194"></span><span>  </span><span id="local-6989586621679340517"><span class="annot"><span class="annottext">f :: StringOrURI -&gt; Maybe URI
</span><a href="#local-6989586621679340517"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JWT.html#OrURI"><span class="hs-identifier hs-type">OrURI</span></a></span><span> </span><span id="local-6989586621679340516"><span class="annot"><span class="annottext">URI
</span><a href="#local-6989586621679340516"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">URI -&gt; Maybe URI
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">URI
</span><a href="#local-6989586621679340516"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-195"></span><span>  </span><span class="annot"><a href="#local-6989586621679340517"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">StringOrURI
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe URI
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679340513"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Crypto.JWT.html#StringOrURI"><span class="hs-identifier hs-type">StringOrURI</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-198"></span><span>  </span><span id="local-6989586621679340511"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser StringOrURI
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Text -&gt; Parser StringOrURI) -&gt; Value -&gt; Parser StringOrURI
forall a. String -&gt; (Text -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">withText</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;StringOrURI&quot;</span></span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser StringOrURI
-&gt; (StringOrURI -&gt; Parser StringOrURI)
-&gt; Maybe StringOrURI
-&gt; Parser StringOrURI
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Parser StringOrURI
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;failed to parse StringOrURI&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StringOrURI -&gt; Parser StringOrURI
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Maybe StringOrURI -&gt; Parser StringOrURI)
-&gt; (Text -&gt; Maybe StringOrURI) -&gt; Text -&gt; Parser StringOrURI
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Getting (First StringOrURI) Text StringOrURI
-&gt; Text -&gt; Maybe StringOrURI
forall s (m :: * -&gt; *) a.
MonadReader s m =&gt;
Getting (First a) s a -&gt; m (Maybe a)
</span><span class="hs-identifier hs-var">preview</span></span><span> </span><span class="annot"><span class="annottext">Getting (First StringOrURI) Text StringOrURI
forall s. (Cons s s Char Char, AsEmpty s) =&gt; Prism' s StringOrURI
</span><a href="Crypto.JWT.html#stringOrUri"><span class="hs-identifier hs-var">stringOrUri</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679340501"><span id="local-6989586621679340503"><span id="local-6989586621679340505"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Crypto.JWT.html#StringOrURI"><span class="hs-identifier hs-type">StringOrURI</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-202"></span><span>  </span><span id="local-6989586621679340499"><span class="annot"><span class="annottext">toJSON :: StringOrURI -&gt; Value
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JWT.html#Arbitrary"><span class="hs-identifier hs-type">Arbitrary</span></a></span><span> </span><span id="local-6989586621679340497"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679340497"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679340497"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-203"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JWT.html#OrURI"><span class="hs-identifier hs-type">OrURI</span></a></span><span> </span><span id="local-6989586621679340496"><span class="annot"><span class="annottext">URI
</span><a href="#local-6989586621679340496"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Value) -&gt; String -&gt; Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">URI -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">URI
</span><a href="#local-6989586621679340496"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="hs-comment">-- | A JSON numeric value representing the number of seconds from</span><span>
</span><span id="line-207"></span><span class="hs-comment">--   1970-01-01T0:0:0Z UTC until the specified UTC date\/time.</span><span>
</span><span id="line-208"></span><span class="hs-comment">--</span><span>
</span><span id="line-209"></span><span class="hs-keyword">newtype</span><span> </span><span id="NumericDate"><span class="annot"><a href="Crypto.JWT.html#NumericDate"><span class="hs-identifier hs-var">NumericDate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="NumericDate"><span class="annot"><a href="Crypto.JWT.html#NumericDate"><span class="hs-identifier hs-var">NumericDate</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTCTime</span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679340491"><span id="local-6989586621679340493"><span class="annot"><span class="annottext">NumericDate -&gt; NumericDate -&gt; Bool
(NumericDate -&gt; NumericDate -&gt; Bool)
-&gt; (NumericDate -&gt; NumericDate -&gt; Bool) -&gt; Eq NumericDate
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: NumericDate -&gt; NumericDate -&gt; Bool
$c/= :: NumericDate -&gt; NumericDate -&gt; Bool
== :: NumericDate -&gt; NumericDate -&gt; Bool
$c== :: NumericDate -&gt; NumericDate -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679340476"><span id="local-6989586621679340478"><span id="local-6989586621679340480"><span id="local-6989586621679340482"><span id="local-6989586621679340484"><span id="local-6989586621679340486"><span id="local-6989586621679340488"><span class="annot"><span class="annottext">Eq NumericDate
Eq NumericDate
-&gt; (NumericDate -&gt; NumericDate -&gt; Ordering)
-&gt; (NumericDate -&gt; NumericDate -&gt; Bool)
-&gt; (NumericDate -&gt; NumericDate -&gt; Bool)
-&gt; (NumericDate -&gt; NumericDate -&gt; Bool)
-&gt; (NumericDate -&gt; NumericDate -&gt; Bool)
-&gt; (NumericDate -&gt; NumericDate -&gt; NumericDate)
-&gt; (NumericDate -&gt; NumericDate -&gt; NumericDate)
-&gt; Ord NumericDate
NumericDate -&gt; NumericDate -&gt; Bool
NumericDate -&gt; NumericDate -&gt; Ordering
NumericDate -&gt; NumericDate -&gt; NumericDate
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: NumericDate -&gt; NumericDate -&gt; NumericDate
$cmin :: NumericDate -&gt; NumericDate -&gt; NumericDate
max :: NumericDate -&gt; NumericDate -&gt; NumericDate
$cmax :: NumericDate -&gt; NumericDate -&gt; NumericDate
&gt;= :: NumericDate -&gt; NumericDate -&gt; Bool
$c&gt;= :: NumericDate -&gt; NumericDate -&gt; Bool
&gt; :: NumericDate -&gt; NumericDate -&gt; Bool
$c&gt; :: NumericDate -&gt; NumericDate -&gt; Bool
&lt;= :: NumericDate -&gt; NumericDate -&gt; Bool
$c&lt;= :: NumericDate -&gt; NumericDate -&gt; Bool
&lt; :: NumericDate -&gt; NumericDate -&gt; Bool
$c&lt; :: NumericDate -&gt; NumericDate -&gt; Bool
compare :: NumericDate -&gt; NumericDate -&gt; Ordering
$ccompare :: NumericDate -&gt; NumericDate -&gt; Ordering
$cp1Ord :: Eq NumericDate
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679340469"><span id="local-6989586621679340471"><span id="local-6989586621679340473"><span class="annot"><span class="annottext">Int -&gt; NumericDate -&gt; ShowS
[NumericDate] -&gt; ShowS
NumericDate -&gt; String
(Int -&gt; NumericDate -&gt; ShowS)
-&gt; (NumericDate -&gt; String)
-&gt; ([NumericDate] -&gt; ShowS)
-&gt; Show NumericDate
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [NumericDate] -&gt; ShowS
$cshowList :: [NumericDate] -&gt; ShowS
show :: NumericDate -&gt; String
$cshow :: NumericDate -&gt; String
showsPrec :: Int -&gt; NumericDate -&gt; ShowS
$cshowsPrec :: Int -&gt; NumericDate -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span id="_NumericDate"><span class="hs-identifier">makePrisms</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">NumericDate</span></span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679340465"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Crypto.JWT.html#NumericDate"><span class="hs-identifier hs-type">NumericDate</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-213"></span><span>  </span><span id="local-6989586621679340464"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser NumericDate
</span><a href="#local-6989586621679340464"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Scientific -&gt; Parser NumericDate)
-&gt; Value
-&gt; Parser NumericDate
forall a. String -&gt; (Scientific -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">withScientific</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;NumericDate&quot;</span></span><span> </span><span class="annot"><span class="annottext">((Scientific -&gt; Parser NumericDate) -&gt; Value -&gt; Parser NumericDate)
-&gt; (Scientific -&gt; Parser NumericDate)
-&gt; Value
-&gt; Parser NumericDate
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-214"></span><span>    </span><span class="annot"><span class="annottext">NumericDate -&gt; Parser NumericDate
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(NumericDate -&gt; Parser NumericDate)
-&gt; (Scientific -&gt; NumericDate) -&gt; Scientific -&gt; Parser NumericDate
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; NumericDate
</span><a href="Crypto.JWT.html#NumericDate"><span class="hs-identifier hs-var">NumericDate</span></a></span><span> </span><span class="annot"><span class="annottext">(UTCTime -&gt; NumericDate)
-&gt; (Scientific -&gt; UTCTime) -&gt; Scientific -&gt; NumericDate
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">POSIXTime -&gt; UTCTime
</span><span class="hs-identifier hs-var">posixSecondsToUTCTime</span></span><span> </span><span class="annot"><span class="annottext">(POSIXTime -&gt; UTCTime)
-&gt; (Scientific -&gt; POSIXTime) -&gt; Scientific -&gt; UTCTime
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; POSIXTime
forall a. Fractional a =&gt; Rational -&gt; a
</span><span class="hs-identifier hs-var">fromRational</span></span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; POSIXTime)
-&gt; (Scientific -&gt; Rational) -&gt; Scientific -&gt; POSIXTime
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Scientific -&gt; Rational
forall a. Real a =&gt; a -&gt; Rational
</span><span class="hs-identifier hs-var">toRational</span></span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679340456"><span id="local-6989586621679340458"><span id="local-6989586621679340460"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Crypto.JWT.html#NumericDate"><span class="hs-identifier hs-type">NumericDate</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-217"></span><span>  </span><span id="local-6989586621679340455"><span class="annot"><span class="annottext">toJSON :: NumericDate -&gt; Value
</span><a href="#local-6989586621679340455"><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JWT.html#NumericDate"><span class="hs-identifier hs-type">NumericDate</span></a></span><span> </span><span id="local-6989586621679340454"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679340454"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scientific -&gt; Value
</span><span class="hs-identifier hs-var">Number</span></span><span> </span><span class="annot"><span class="annottext">(Scientific -&gt; Value) -&gt; Scientific -&gt; Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Scientific
forall a. Fractional a =&gt; Rational -&gt; a
</span><span class="hs-identifier hs-var">fromRational</span></span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; Scientific) -&gt; Rational -&gt; Scientific
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">POSIXTime -&gt; Rational
forall a. Real a =&gt; a -&gt; Rational
</span><span class="hs-identifier hs-var">toRational</span></span><span> </span><span class="annot"><span class="annottext">(POSIXTime -&gt; Rational) -&gt; POSIXTime -&gt; Rational
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; POSIXTime
</span><span class="hs-identifier hs-var">utcTimeToPOSIXSeconds</span></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679340454"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span class="hs-comment">-- | Audience data.  In the general case, the /aud/ value is an</span><span>
</span><span id="line-222"></span><span class="hs-comment">-- array of case-sensitive strings, each containing a 'StringOrURI'</span><span>
</span><span id="line-223"></span><span class="hs-comment">-- value.  In the special case when the JWT has one audience, the</span><span>
</span><span id="line-224"></span><span class="hs-comment">-- /aud/ value MAY be a single case-sensitive string containing a</span><span>
</span><span id="line-225"></span><span class="hs-comment">-- 'StringOrURI' value.</span><span>
</span><span id="line-226"></span><span class="hs-comment">--</span><span>
</span><span id="line-227"></span><span class="hs-comment">-- The 'ToJSON' instance formats an 'Audience' with one value as a</span><span>
</span><span id="line-228"></span><span class="hs-comment">-- string (some non-compliant implementations require this.)</span><span>
</span><span id="line-229"></span><span class="hs-comment">--</span><span>
</span><span id="line-230"></span><span class="hs-keyword">newtype</span><span> </span><span id="Audience"><span class="annot"><a href="Crypto.JWT.html#Audience"><span class="hs-identifier hs-var">Audience</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Audience"><span class="annot"><a href="Crypto.JWT.html#Audience"><span class="hs-identifier hs-var">Audience</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Crypto.JWT.html#StringOrURI"><span class="hs-identifier hs-type">StringOrURI</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679340448"><span id="local-6989586621679340450"><span class="annot"><span class="annottext">Audience -&gt; Audience -&gt; Bool
(Audience -&gt; Audience -&gt; Bool)
-&gt; (Audience -&gt; Audience -&gt; Bool) -&gt; Eq Audience
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Audience -&gt; Audience -&gt; Bool
$c/= :: Audience -&gt; Audience -&gt; Bool
== :: Audience -&gt; Audience -&gt; Bool
$c== :: Audience -&gt; Audience -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679340442"><span id="local-6989586621679340444"><span id="local-6989586621679340446"><span class="annot"><span class="annottext">Int -&gt; Audience -&gt; ShowS
[Audience] -&gt; ShowS
Audience -&gt; String
(Int -&gt; Audience -&gt; ShowS)
-&gt; (Audience -&gt; String) -&gt; ([Audience] -&gt; ShowS) -&gt; Show Audience
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Audience] -&gt; ShowS
$cshowList :: [Audience] -&gt; ShowS
show :: Audience -&gt; String
$cshow :: Audience -&gt; String
showsPrec :: Int -&gt; Audience -&gt; ShowS
$cshowsPrec :: Int -&gt; Audience -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span id="_Audience"><span class="hs-identifier">makePrisms</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Audience</span></span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679340438"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Crypto.JWT.html#Audience"><span class="hs-identifier hs-type">Audience</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-234"></span><span>  </span><span id="local-6989586621679340437"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser Audience
</span><a href="#local-6989586621679340437"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span id="local-6989586621679340436"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679340436"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[StringOrURI] -&gt; Audience
</span><a href="Crypto.JWT.html#Audience"><span class="hs-identifier hs-var">Audience</span></a></span><span> </span><span class="annot"><span class="annottext">([StringOrURI] -&gt; Audience)
-&gt; Parser [StringOrURI] -&gt; Parser Audience
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Parser [StringOrURI]
forall a. FromJSON a =&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">parseJSON</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679340436"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Parser [StringOrURI]
-&gt; Parser [StringOrURI] -&gt; Parser [StringOrURI]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">(StringOrURI -&gt; [StringOrURI])
-&gt; Parser StringOrURI -&gt; Parser [StringOrURI]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StringOrURI -&gt; [StringOrURI] -&gt; [StringOrURI]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Parser StringOrURI
forall a. FromJSON a =&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">parseJSON</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679340436"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679340428"><span id="local-6989586621679340430"><span id="local-6989586621679340432"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Crypto.JWT.html#Audience"><span class="hs-identifier hs-type">Audience</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-237"></span><span>  </span><span id="local-6989586621679340427"><span class="annot"><span class="annottext">toJSON :: Audience -&gt; Value
</span><a href="#local-6989586621679340427"><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JWT.html#Audience"><span class="hs-identifier hs-type">Audience</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679340426"><span class="annot"><span class="annottext">StringOrURI
</span><a href="#local-6989586621679340426"><span class="hs-identifier hs-var">aud</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StringOrURI -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="annot"><span class="annottext">StringOrURI
</span><a href="#local-6989586621679340426"><span class="hs-identifier hs-var">aud</span></a></span><span>
</span><span id="line-238"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JWT.html#Audience"><span class="hs-identifier hs-type">Audience</span></a></span><span> </span><span id="local-6989586621679340425"><span class="annot"><span class="annottext">[StringOrURI]
</span><a href="#local-6989586621679340425"><span class="hs-identifier hs-var">auds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[StringOrURI] -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="annot"><span class="annottext">[StringOrURI]
</span><a href="#local-6989586621679340425"><span class="hs-identifier hs-var">auds</span></a></span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span class="hs-comment">-- | The JWT Claims Set represents a JSON object whose members are</span><span>
</span><span id="line-242"></span><span class="hs-comment">-- the registered claims defined by RFC 7519.  Unrecognised</span><span>
</span><span id="line-243"></span><span class="hs-comment">-- claims are gathered into the 'unregisteredClaims' map.</span><span>
</span><span id="line-244"></span><span class="hs-comment">--</span><span>
</span><span id="line-245"></span><span class="hs-keyword">data</span><span> </span><span id="ClaimsSet"><span class="annot"><a href="Crypto.JWT.html#ClaimsSet"><span class="hs-identifier hs-var">ClaimsSet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ClaimsSet"><span class="annot"><a href="Crypto.JWT.html#ClaimsSet"><span class="hs-identifier hs-var">ClaimsSet</span></a></span></span><span>
</span><span id="line-246"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="_claimIss"><span class="annot"><span class="annottext">ClaimsSet -&gt; Maybe StringOrURI
</span><a href="Crypto.JWT.html#_claimIss"><span class="hs-identifier hs-var hs-var">_claimIss</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Crypto.JWT.html#StringOrURI"><span class="hs-identifier hs-type">StringOrURI</span></a></span><span>
</span><span id="line-247"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_claimSub"><span class="annot"><span class="annottext">ClaimsSet -&gt; Maybe StringOrURI
</span><a href="Crypto.JWT.html#_claimSub"><span class="hs-identifier hs-var hs-var">_claimSub</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Crypto.JWT.html#StringOrURI"><span class="hs-identifier hs-type">StringOrURI</span></a></span><span>
</span><span id="line-248"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_claimAud"><span class="annot"><span class="annottext">ClaimsSet -&gt; Maybe Audience
</span><a href="Crypto.JWT.html#_claimAud"><span class="hs-identifier hs-var hs-var">_claimAud</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Crypto.JWT.html#Audience"><span class="hs-identifier hs-type">Audience</span></a></span><span>
</span><span id="line-249"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_claimExp"><span class="annot"><span class="annottext">ClaimsSet -&gt; Maybe NumericDate
</span><a href="Crypto.JWT.html#_claimExp"><span class="hs-identifier hs-var hs-var">_claimExp</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Crypto.JWT.html#NumericDate"><span class="hs-identifier hs-type">NumericDate</span></a></span><span>
</span><span id="line-250"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_claimNbf"><span class="annot"><span class="annottext">ClaimsSet -&gt; Maybe NumericDate
</span><a href="Crypto.JWT.html#_claimNbf"><span class="hs-identifier hs-var hs-var">_claimNbf</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Crypto.JWT.html#NumericDate"><span class="hs-identifier hs-type">NumericDate</span></a></span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_claimIat"><span class="annot"><span class="annottext">ClaimsSet -&gt; Maybe NumericDate
</span><a href="Crypto.JWT.html#_claimIat"><span class="hs-identifier hs-var hs-var">_claimIat</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Crypto.JWT.html#NumericDate"><span class="hs-identifier hs-type">NumericDate</span></a></span><span>
</span><span id="line-252"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_claimJti"><span class="annot"><span class="annottext">ClaimsSet -&gt; Maybe Text
</span><a href="Crypto.JWT.html#_claimJti"><span class="hs-identifier hs-var hs-var">_claimJti</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-253"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_unregisteredClaims"><span class="annot"><span class="annottext">ClaimsSet -&gt; HashMap Text Value
</span><a href="Crypto.JWT.html#_unregisteredClaims"><span class="hs-identifier hs-var hs-var">_unregisteredClaims</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.HashMap</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span>
</span><span id="line-254"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-255"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679340412"><span id="local-6989586621679340414"><span class="annot"><span class="annottext">ClaimsSet -&gt; ClaimsSet -&gt; Bool
(ClaimsSet -&gt; ClaimsSet -&gt; Bool)
-&gt; (ClaimsSet -&gt; ClaimsSet -&gt; Bool) -&gt; Eq ClaimsSet
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ClaimsSet -&gt; ClaimsSet -&gt; Bool
$c/= :: ClaimsSet -&gt; ClaimsSet -&gt; Bool
== :: ClaimsSet -&gt; ClaimsSet -&gt; Bool
$c== :: ClaimsSet -&gt; ClaimsSet -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679340406"><span id="local-6989586621679340408"><span id="local-6989586621679340410"><span class="annot"><span class="annottext">Int -&gt; ClaimsSet -&gt; ShowS
[ClaimsSet] -&gt; ShowS
ClaimsSet -&gt; String
(Int -&gt; ClaimsSet -&gt; ShowS)
-&gt; (ClaimsSet -&gt; String)
-&gt; ([ClaimsSet] -&gt; ShowS)
-&gt; Show ClaimsSet
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ClaimsSet] -&gt; ShowS
$cshowList :: [ClaimsSet] -&gt; ShowS
show :: ClaimsSet -&gt; String
$cshow :: ClaimsSet -&gt; String
showsPrec :: Int -&gt; ClaimsSet -&gt; ShowS
$cshowsPrec :: Int -&gt; ClaimsSet -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span class="hs-comment">-- | The issuer claim identifies the principal that issued the</span><span>
</span><span id="line-258"></span><span class="hs-comment">-- JWT.  The processing of this claim is generally application</span><span>
</span><span id="line-259"></span><span class="hs-comment">-- specific.</span><span>
</span><span id="line-260"></span><span class="annot"><a href="Crypto.JWT.html#claimIss"><span class="hs-identifier hs-type">claimIss</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="annot"><a href="Crypto.JWT.html#ClaimsSet"><span class="hs-identifier hs-type">ClaimsSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Crypto.JWT.html#StringOrURI"><span class="hs-identifier hs-type">StringOrURI</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span id="claimIss"><span class="annot"><span class="annottext">claimIss :: (Maybe StringOrURI -&gt; f (Maybe StringOrURI))
-&gt; ClaimsSet -&gt; f ClaimsSet
</span><a href="Crypto.JWT.html#claimIss"><span class="hs-identifier hs-var hs-var">claimIss</span></a></span></span><span> </span><span id="local-6989586621679340405"><span class="annot"><span class="annottext">Maybe StringOrURI -&gt; f (Maybe StringOrURI)
</span><a href="#local-6989586621679340405"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679340404"><span class="annot"><span class="annottext">h :: ClaimsSet
</span><a href="#local-6989586621679340404"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Crypto.JWT.html#ClaimsSet"><span class="hs-identifier hs-type">ClaimsSet</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_claimIss :: ClaimsSet -&gt; Maybe StringOrURI
</span><a href="Crypto.JWT.html#_claimIss"><span class="hs-identifier hs-var">_claimIss</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679340403"><span class="annot"><span class="annottext">Maybe StringOrURI
</span><a href="#local-6989586621679340403"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-262"></span><span>  </span><span class="annot"><span class="annottext">(Maybe StringOrURI -&gt; ClaimsSet)
-&gt; f (Maybe StringOrURI) -&gt; f ClaimsSet
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679340402"><span class="annot"><span class="annottext">Maybe StringOrURI
</span><a href="#local-6989586621679340402"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ClaimsSet
</span><a href="#local-6989586621679340404"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_claimIss :: Maybe StringOrURI
</span><a href="Crypto.JWT.html#_claimIss"><span class="hs-identifier hs-var">_claimIss</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe StringOrURI
</span><a href="#local-6989586621679340402"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe StringOrURI -&gt; f (Maybe StringOrURI)
</span><a href="#local-6989586621679340405"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe StringOrURI
</span><a href="#local-6989586621679340403"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span class="hs-comment">-- | The subject claim identifies the principal that is the</span><span>
</span><span id="line-265"></span><span class="hs-comment">-- subject of the JWT.  The Claims in a JWT are normally</span><span>
</span><span id="line-266"></span><span class="hs-comment">-- statements about the subject.  The subject value MAY be scoped</span><span>
</span><span id="line-267"></span><span class="hs-comment">-- to be locally unique in the context of the issuer or MAY be</span><span>
</span><span id="line-268"></span><span class="hs-comment">-- globally unique.  The processing of this claim is generally</span><span>
</span><span id="line-269"></span><span class="hs-comment">-- application specific.</span><span>
</span><span id="line-270"></span><span class="annot"><a href="Crypto.JWT.html#claimSub"><span class="hs-identifier hs-type">claimSub</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="annot"><a href="Crypto.JWT.html#ClaimsSet"><span class="hs-identifier hs-type">ClaimsSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Crypto.JWT.html#StringOrURI"><span class="hs-identifier hs-type">StringOrURI</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span id="claimSub"><span class="annot"><span class="annottext">claimSub :: (Maybe StringOrURI -&gt; f (Maybe StringOrURI))
-&gt; ClaimsSet -&gt; f ClaimsSet
</span><a href="Crypto.JWT.html#claimSub"><span class="hs-identifier hs-var hs-var">claimSub</span></a></span></span><span> </span><span id="local-6989586621679340401"><span class="annot"><span class="annottext">Maybe StringOrURI -&gt; f (Maybe StringOrURI)
</span><a href="#local-6989586621679340401"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679340400"><span class="annot"><span class="annottext">h :: ClaimsSet
</span><a href="#local-6989586621679340400"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Crypto.JWT.html#ClaimsSet"><span class="hs-identifier hs-type">ClaimsSet</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_claimSub :: ClaimsSet -&gt; Maybe StringOrURI
</span><a href="Crypto.JWT.html#_claimSub"><span class="hs-identifier hs-var">_claimSub</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679340399"><span class="annot"><span class="annottext">Maybe StringOrURI
</span><a href="#local-6989586621679340399"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-272"></span><span>  </span><span class="annot"><span class="annottext">(Maybe StringOrURI -&gt; ClaimsSet)
-&gt; f (Maybe StringOrURI) -&gt; f ClaimsSet
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679340398"><span class="annot"><span class="annottext">Maybe StringOrURI
</span><a href="#local-6989586621679340398"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ClaimsSet
</span><a href="#local-6989586621679340400"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_claimSub :: Maybe StringOrURI
</span><a href="Crypto.JWT.html#_claimSub"><span class="hs-identifier hs-var">_claimSub</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe StringOrURI
</span><a href="#local-6989586621679340398"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe StringOrURI -&gt; f (Maybe StringOrURI)
</span><a href="#local-6989586621679340401"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe StringOrURI
</span><a href="#local-6989586621679340399"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span>
</span><span id="line-274"></span><span class="hs-comment">-- | The audience claim identifies the recipients that the JWT is</span><span>
</span><span id="line-275"></span><span class="hs-comment">-- intended for.  Each principal intended to process the JWT MUST</span><span>
</span><span id="line-276"></span><span class="hs-comment">-- identify itself with a value in the audience claim.  If the</span><span>
</span><span id="line-277"></span><span class="hs-comment">-- principal processing the claim does not identify itself with a</span><span>
</span><span id="line-278"></span><span class="hs-comment">-- value in the /aud/ claim when this claim is present, then the</span><span>
</span><span id="line-279"></span><span class="hs-comment">-- JWT MUST be rejected.</span><span>
</span><span id="line-280"></span><span class="annot"><a href="Crypto.JWT.html#claimAud"><span class="hs-identifier hs-type">claimAud</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="annot"><a href="Crypto.JWT.html#ClaimsSet"><span class="hs-identifier hs-type">ClaimsSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Crypto.JWT.html#Audience"><span class="hs-identifier hs-type">Audience</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-281"></span><span id="claimAud"><span class="annot"><span class="annottext">claimAud :: (Maybe Audience -&gt; f (Maybe Audience)) -&gt; ClaimsSet -&gt; f ClaimsSet
</span><a href="Crypto.JWT.html#claimAud"><span class="hs-identifier hs-var hs-var">claimAud</span></a></span></span><span> </span><span id="local-6989586621679340397"><span class="annot"><span class="annottext">Maybe Audience -&gt; f (Maybe Audience)
</span><a href="#local-6989586621679340397"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679340396"><span class="annot"><span class="annottext">h :: ClaimsSet
</span><a href="#local-6989586621679340396"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Crypto.JWT.html#ClaimsSet"><span class="hs-identifier hs-type">ClaimsSet</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_claimAud :: ClaimsSet -&gt; Maybe Audience
</span><a href="Crypto.JWT.html#_claimAud"><span class="hs-identifier hs-var">_claimAud</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679340395"><span class="annot"><span class="annottext">Maybe Audience
</span><a href="#local-6989586621679340395"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-282"></span><span>  </span><span class="annot"><span class="annottext">(Maybe Audience -&gt; ClaimsSet) -&gt; f (Maybe Audience) -&gt; f ClaimsSet
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679340394"><span class="annot"><span class="annottext">Maybe Audience
</span><a href="#local-6989586621679340394"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ClaimsSet
</span><a href="#local-6989586621679340396"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_claimAud :: Maybe Audience
</span><a href="Crypto.JWT.html#_claimAud"><span class="hs-identifier hs-var">_claimAud</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Audience
</span><a href="#local-6989586621679340394"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Audience -&gt; f (Maybe Audience)
</span><a href="#local-6989586621679340397"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Audience
</span><a href="#local-6989586621679340395"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span class="hs-comment">-- | The expiration time claim identifies the expiration time on</span><span>
</span><span id="line-285"></span><span class="hs-comment">-- or after which the JWT MUST NOT be accepted for processing.</span><span>
</span><span id="line-286"></span><span class="hs-comment">-- The processing of /exp/ claim requires that the current</span><span>
</span><span id="line-287"></span><span class="hs-comment">-- date\/time MUST be before expiration date\/time listed in the</span><span>
</span><span id="line-288"></span><span class="hs-comment">-- /exp/ claim.  Implementers MAY provide for some small leeway,</span><span>
</span><span id="line-289"></span><span class="hs-comment">-- usually no more than a few minutes, to account for clock skew.</span><span>
</span><span id="line-290"></span><span class="annot"><a href="Crypto.JWT.html#claimExp"><span class="hs-identifier hs-type">claimExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="annot"><a href="Crypto.JWT.html#ClaimsSet"><span class="hs-identifier hs-type">ClaimsSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Crypto.JWT.html#NumericDate"><span class="hs-identifier hs-type">NumericDate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-291"></span><span id="claimExp"><span class="annot"><span class="annottext">claimExp :: (Maybe NumericDate -&gt; f (Maybe NumericDate))
-&gt; ClaimsSet -&gt; f ClaimsSet
</span><a href="Crypto.JWT.html#claimExp"><span class="hs-identifier hs-var hs-var">claimExp</span></a></span></span><span> </span><span id="local-6989586621679340393"><span class="annot"><span class="annottext">Maybe NumericDate -&gt; f (Maybe NumericDate)
</span><a href="#local-6989586621679340393"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679340392"><span class="annot"><span class="annottext">h :: ClaimsSet
</span><a href="#local-6989586621679340392"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Crypto.JWT.html#ClaimsSet"><span class="hs-identifier hs-type">ClaimsSet</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_claimExp :: ClaimsSet -&gt; Maybe NumericDate
</span><a href="Crypto.JWT.html#_claimExp"><span class="hs-identifier hs-var">_claimExp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679340391"><span class="annot"><span class="annottext">Maybe NumericDate
</span><a href="#local-6989586621679340391"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-292"></span><span>  </span><span class="annot"><span class="annottext">(Maybe NumericDate -&gt; ClaimsSet)
-&gt; f (Maybe NumericDate) -&gt; f ClaimsSet
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679340390"><span class="annot"><span class="annottext">Maybe NumericDate
</span><a href="#local-6989586621679340390"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ClaimsSet
</span><a href="#local-6989586621679340392"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_claimExp :: Maybe NumericDate
</span><a href="Crypto.JWT.html#_claimExp"><span class="hs-identifier hs-var">_claimExp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe NumericDate
</span><a href="#local-6989586621679340390"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe NumericDate -&gt; f (Maybe NumericDate)
</span><a href="#local-6989586621679340393"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe NumericDate
</span><a href="#local-6989586621679340391"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span class="hs-comment">-- | The not before claim identifies the time before which the JWT</span><span>
</span><span id="line-295"></span><span class="hs-comment">-- MUST NOT be accepted for processing.  The processing of the</span><span>
</span><span id="line-296"></span><span class="hs-comment">-- /nbf/ claim requires that the current date\/time MUST be after</span><span>
</span><span id="line-297"></span><span class="hs-comment">-- or equal to the not-before date\/time listed in the /nbf/</span><span>
</span><span id="line-298"></span><span class="hs-comment">-- claim.  Implementers MAY provide for some small leeway, usually</span><span>
</span><span id="line-299"></span><span class="hs-comment">-- no more than a few minutes, to account for clock skew.</span><span>
</span><span id="line-300"></span><span class="annot"><a href="Crypto.JWT.html#claimNbf"><span class="hs-identifier hs-type">claimNbf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="annot"><a href="Crypto.JWT.html#ClaimsSet"><span class="hs-identifier hs-type">ClaimsSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Crypto.JWT.html#NumericDate"><span class="hs-identifier hs-type">NumericDate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span id="claimNbf"><span class="annot"><span class="annottext">claimNbf :: (Maybe NumericDate -&gt; f (Maybe NumericDate))
-&gt; ClaimsSet -&gt; f ClaimsSet
</span><a href="Crypto.JWT.html#claimNbf"><span class="hs-identifier hs-var hs-var">claimNbf</span></a></span></span><span> </span><span id="local-6989586621679340389"><span class="annot"><span class="annottext">Maybe NumericDate -&gt; f (Maybe NumericDate)
</span><a href="#local-6989586621679340389"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679340388"><span class="annot"><span class="annottext">h :: ClaimsSet
</span><a href="#local-6989586621679340388"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Crypto.JWT.html#ClaimsSet"><span class="hs-identifier hs-type">ClaimsSet</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_claimNbf :: ClaimsSet -&gt; Maybe NumericDate
</span><a href="Crypto.JWT.html#_claimNbf"><span class="hs-identifier hs-var">_claimNbf</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679340387"><span class="annot"><span class="annottext">Maybe NumericDate
</span><a href="#local-6989586621679340387"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-302"></span><span>  </span><span class="annot"><span class="annottext">(Maybe NumericDate -&gt; ClaimsSet)
-&gt; f (Maybe NumericDate) -&gt; f ClaimsSet
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679340386"><span class="annot"><span class="annottext">Maybe NumericDate
</span><a href="#local-6989586621679340386"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ClaimsSet
</span><a href="#local-6989586621679340388"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_claimNbf :: Maybe NumericDate
</span><a href="Crypto.JWT.html#_claimNbf"><span class="hs-identifier hs-var">_claimNbf</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe NumericDate
</span><a href="#local-6989586621679340386"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe NumericDate -&gt; f (Maybe NumericDate)
</span><a href="#local-6989586621679340389"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe NumericDate
</span><a href="#local-6989586621679340387"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-303"></span><span>
</span><span id="line-304"></span><span class="hs-comment">-- | The issued at claim identifies the time at which the JWT was</span><span>
</span><span id="line-305"></span><span class="hs-comment">-- issued.  This claim can be used to determine the age of the</span><span>
</span><span id="line-306"></span><span class="hs-comment">-- JWT.</span><span>
</span><span id="line-307"></span><span class="annot"><a href="Crypto.JWT.html#claimIat"><span class="hs-identifier hs-type">claimIat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="annot"><a href="Crypto.JWT.html#ClaimsSet"><span class="hs-identifier hs-type">ClaimsSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Crypto.JWT.html#NumericDate"><span class="hs-identifier hs-type">NumericDate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span id="claimIat"><span class="annot"><span class="annottext">claimIat :: (Maybe NumericDate -&gt; f (Maybe NumericDate))
-&gt; ClaimsSet -&gt; f ClaimsSet
</span><a href="Crypto.JWT.html#claimIat"><span class="hs-identifier hs-var hs-var">claimIat</span></a></span></span><span> </span><span id="local-6989586621679340385"><span class="annot"><span class="annottext">Maybe NumericDate -&gt; f (Maybe NumericDate)
</span><a href="#local-6989586621679340385"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679340384"><span class="annot"><span class="annottext">h :: ClaimsSet
</span><a href="#local-6989586621679340384"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Crypto.JWT.html#ClaimsSet"><span class="hs-identifier hs-type">ClaimsSet</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_claimIat :: ClaimsSet -&gt; Maybe NumericDate
</span><a href="Crypto.JWT.html#_claimIat"><span class="hs-identifier hs-var">_claimIat</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679340383"><span class="annot"><span class="annottext">Maybe NumericDate
</span><a href="#local-6989586621679340383"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-309"></span><span>  </span><span class="annot"><span class="annottext">(Maybe NumericDate -&gt; ClaimsSet)
-&gt; f (Maybe NumericDate) -&gt; f ClaimsSet
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679340382"><span class="annot"><span class="annottext">Maybe NumericDate
</span><a href="#local-6989586621679340382"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ClaimsSet
</span><a href="#local-6989586621679340384"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_claimIat :: Maybe NumericDate
</span><a href="Crypto.JWT.html#_claimIat"><span class="hs-identifier hs-var">_claimIat</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe NumericDate
</span><a href="#local-6989586621679340382"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe NumericDate -&gt; f (Maybe NumericDate)
</span><a href="#local-6989586621679340385"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe NumericDate
</span><a href="#local-6989586621679340383"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>
</span><span id="line-311"></span><span class="hs-comment">-- | The JWT ID claim provides a unique identifier for the JWT.</span><span>
</span><span id="line-312"></span><span class="hs-comment">-- The identifier value MUST be assigned in a manner that ensures</span><span>
</span><span id="line-313"></span><span class="hs-comment">-- that there is a negligible probability that the same value will</span><span>
</span><span id="line-314"></span><span class="hs-comment">-- be accidentally assigned to a different data object.  The /jti/</span><span>
</span><span id="line-315"></span><span class="hs-comment">-- claim can be used to prevent the JWT from being replayed.  The</span><span>
</span><span id="line-316"></span><span class="hs-comment">-- /jti/ value is a case-sensitive string.</span><span>
</span><span id="line-317"></span><span class="annot"><a href="Crypto.JWT.html#claimJti"><span class="hs-identifier hs-type">claimJti</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="annot"><a href="Crypto.JWT.html#ClaimsSet"><span class="hs-identifier hs-type">ClaimsSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-318"></span><span id="claimJti"><span class="annot"><span class="annottext">claimJti :: (Maybe Text -&gt; f (Maybe Text)) -&gt; ClaimsSet -&gt; f ClaimsSet
</span><a href="Crypto.JWT.html#claimJti"><span class="hs-identifier hs-var hs-var">claimJti</span></a></span></span><span> </span><span id="local-6989586621679340381"><span class="annot"><span class="annottext">Maybe Text -&gt; f (Maybe Text)
</span><a href="#local-6989586621679340381"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679340380"><span class="annot"><span class="annottext">h :: ClaimsSet
</span><a href="#local-6989586621679340380"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Crypto.JWT.html#ClaimsSet"><span class="hs-identifier hs-type">ClaimsSet</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_claimJti :: ClaimsSet -&gt; Maybe Text
</span><a href="Crypto.JWT.html#_claimJti"><span class="hs-identifier hs-var">_claimJti</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679340379"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679340379"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-319"></span><span>  </span><span class="annot"><span class="annottext">(Maybe Text -&gt; ClaimsSet) -&gt; f (Maybe Text) -&gt; f ClaimsSet
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679340378"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679340378"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ClaimsSet
</span><a href="#local-6989586621679340380"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_claimJti :: Maybe Text
</span><a href="Crypto.JWT.html#_claimJti"><span class="hs-identifier hs-var">_claimJti</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679340378"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Text -&gt; f (Maybe Text)
</span><a href="#local-6989586621679340381"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679340379"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span>
</span><span id="line-321"></span><span class="hs-comment">-- | Claim Names can be defined at will by those using JWTs.</span><span>
</span><span id="line-322"></span><span class="annot"><a href="Crypto.JWT.html#unregisteredClaims"><span class="hs-identifier hs-type">unregisteredClaims</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="annot"><a href="Crypto.JWT.html#ClaimsSet"><span class="hs-identifier hs-type">ClaimsSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M.HashMap</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span class="hs-special">)</span><span>
</span><span id="line-323"></span><span id="unregisteredClaims"><span class="annot"><span class="annottext">unregisteredClaims :: (HashMap Text Value -&gt; f (HashMap Text Value))
-&gt; ClaimsSet -&gt; f ClaimsSet
</span><a href="Crypto.JWT.html#unregisteredClaims"><span class="hs-identifier hs-var hs-var">unregisteredClaims</span></a></span></span><span> </span><span id="local-6989586621679340377"><span class="annot"><span class="annottext">HashMap Text Value -&gt; f (HashMap Text Value)
</span><a href="#local-6989586621679340377"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679340376"><span class="annot"><span class="annottext">h :: ClaimsSet
</span><a href="#local-6989586621679340376"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Crypto.JWT.html#ClaimsSet"><span class="hs-identifier hs-type">ClaimsSet</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_unregisteredClaims :: ClaimsSet -&gt; HashMap Text Value
</span><a href="Crypto.JWT.html#_unregisteredClaims"><span class="hs-identifier hs-var">_unregisteredClaims</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679340375"><span class="annot"><span class="annottext">HashMap Text Value
</span><a href="#local-6989586621679340375"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-324"></span><span>  </span><span class="annot"><span class="annottext">(HashMap Text Value -&gt; ClaimsSet)
-&gt; f (HashMap Text Value) -&gt; f ClaimsSet
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679340374"><span class="annot"><span class="annottext">HashMap Text Value
</span><a href="#local-6989586621679340374"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ClaimsSet
</span><a href="#local-6989586621679340376"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_unregisteredClaims :: HashMap Text Value
</span><a href="Crypto.JWT.html#_unregisteredClaims"><span class="hs-identifier hs-var">_unregisteredClaims</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HashMap Text Value
</span><a href="#local-6989586621679340374"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashMap Text Value -&gt; f (HashMap Text Value)
</span><a href="#local-6989586621679340377"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap Text Value
</span><a href="#local-6989586621679340375"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-325"></span><span>
</span><span id="line-326"></span><span>
</span><span id="line-327"></span><span class="hs-comment">-- | Return an empty claims set.</span><span>
</span><span id="line-328"></span><span class="hs-comment">--</span><span>
</span><span id="line-329"></span><span class="annot"><a href="Crypto.JWT.html#emptyClaimsSet"><span class="hs-identifier hs-type">emptyClaimsSet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.JWT.html#ClaimsSet"><span class="hs-identifier hs-type">ClaimsSet</span></a></span><span>
</span><span id="line-330"></span><span id="emptyClaimsSet"><span class="annot"><span class="annottext">emptyClaimsSet :: ClaimsSet
</span><a href="Crypto.JWT.html#emptyClaimsSet"><span class="hs-identifier hs-var hs-var">emptyClaimsSet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe StringOrURI
-&gt; Maybe StringOrURI
-&gt; Maybe Audience
-&gt; Maybe NumericDate
-&gt; Maybe NumericDate
-&gt; Maybe NumericDate
-&gt; Maybe Text
-&gt; HashMap Text Value
-&gt; ClaimsSet
</span><a href="Crypto.JWT.html#ClaimsSet"><span class="hs-identifier hs-var">ClaimsSet</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe StringOrURI
forall a. Maybe a
</span><a href="#local-6989586621679340373"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe StringOrURI
forall a. Maybe a
</span><a href="#local-6989586621679340373"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Audience
forall a. Maybe a
</span><a href="#local-6989586621679340373"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe NumericDate
forall a. Maybe a
</span><a href="#local-6989586621679340373"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe NumericDate
forall a. Maybe a
</span><a href="#local-6989586621679340373"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe NumericDate
forall a. Maybe a
</span><a href="#local-6989586621679340373"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><a href="#local-6989586621679340373"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap Text Value
forall k v. HashMap k v
</span><span class="hs-identifier hs-var">M.empty</span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679340373"><span class="annot"><span class="annottext">n :: Maybe a
</span><a href="#local-6989586621679340373"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-331"></span><span>
</span><span id="line-332"></span><span class="annot"><a href="Crypto.JWT.html#addClaim"><span class="hs-identifier hs-type">addClaim</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.JWT.html#ClaimsSet"><span class="hs-identifier hs-type">ClaimsSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.JWT.html#ClaimsSet"><span class="hs-identifier hs-type">ClaimsSet</span></a></span><span>
</span><span id="line-333"></span><span id="addClaim"><span class="annot"><span class="annottext">addClaim :: Text -&gt; Value -&gt; ClaimsSet -&gt; ClaimsSet
</span><a href="Crypto.JWT.html#addClaim"><span class="hs-identifier hs-var hs-var">addClaim</span></a></span></span><span> </span><span id="local-6989586621679340371"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679340371"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679340370"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679340370"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASetter
  ClaimsSet ClaimsSet (HashMap Text Value) (HashMap Text Value)
-&gt; (HashMap Text Value -&gt; HashMap Text Value)
-&gt; ClaimsSet
-&gt; ClaimsSet
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-identifier hs-var">over</span></span><span> </span><span class="annot"><span class="annottext">ASetter
  ClaimsSet ClaimsSet (HashMap Text Value) (HashMap Text Value)
Lens' ClaimsSet (HashMap Text Value)
</span><a href="Crypto.JWT.html#unregisteredClaims"><span class="hs-identifier hs-var">unregisteredClaims</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Value -&gt; HashMap Text Value -&gt; HashMap Text Value
forall k v.
(Eq k, Hashable k) =&gt;
k -&gt; v -&gt; HashMap k v -&gt; HashMap k v
</span><span class="hs-identifier hs-var">M.insert</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679340371"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679340370"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-334"></span><span>
</span><span id="line-335"></span><span class="annot"><a href="Crypto.JWT.html#filterUnregistered"><span class="hs-identifier hs-type">filterUnregistered</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.HashMap</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.HashMap</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span>
</span><span id="line-336"></span><span id="filterUnregistered"><span class="annot"><span class="annottext">filterUnregistered :: HashMap Text Value -&gt; HashMap Text Value
</span><a href="Crypto.JWT.html#filterUnregistered"><span class="hs-identifier hs-var hs-var">filterUnregistered</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Value -&gt; Bool) -&gt; HashMap Text Value -&gt; HashMap Text Value
forall k v. (k -&gt; v -&gt; Bool) -&gt; HashMap k v -&gt; HashMap k v
</span><span class="hs-identifier hs-var">M.filterWithKey</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679340366"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679340366"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="annot"><span class="annottext">Value
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679340366"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Text] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`notElem`</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679340364"><span class="hs-identifier hs-var">registered</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-337"></span><span>  </span><span id="local-6989586621679340364"><span class="annot"><span class="annottext">registered :: [Text]
</span><a href="#local-6989586621679340364"><span class="hs-identifier hs-var hs-var">registered</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;iss&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;sub&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;aud&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;exp&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;nbf&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;iat&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;jti&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-338"></span><span>
</span><span id="line-339"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679340361"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Crypto.JWT.html#ClaimsSet"><span class="hs-identifier hs-type">ClaimsSet</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-340"></span><span>  </span><span id="local-6989586621679340360"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser ClaimsSet
</span><a href="#local-6989586621679340360"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (HashMap Text Value -&gt; Parser ClaimsSet)
-&gt; Value
-&gt; Parser ClaimsSet
forall a.
String -&gt; (HashMap Text Value -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">withObject</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;JWT Claims Set&quot;</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679340358"><span class="annot"><span class="annottext">HashMap Text Value
</span><a href="#local-6989586621679340358"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe StringOrURI
-&gt; Maybe StringOrURI
-&gt; Maybe Audience
-&gt; Maybe NumericDate
-&gt; Maybe NumericDate
-&gt; Maybe NumericDate
-&gt; Maybe Text
-&gt; HashMap Text Value
-&gt; ClaimsSet
</span><a href="Crypto.JWT.html#ClaimsSet"><span class="hs-identifier hs-var">ClaimsSet</span></a></span><span>
</span><span id="line-341"></span><span>    </span><span class="annot"><span class="annottext">(Maybe StringOrURI
 -&gt; Maybe StringOrURI
 -&gt; Maybe Audience
 -&gt; Maybe NumericDate
 -&gt; Maybe NumericDate
 -&gt; Maybe NumericDate
 -&gt; Maybe Text
 -&gt; HashMap Text Value
 -&gt; ClaimsSet)
-&gt; Parser (Maybe StringOrURI)
-&gt; Parser
     (Maybe StringOrURI
      -&gt; Maybe Audience
      -&gt; Maybe NumericDate
      -&gt; Maybe NumericDate
      -&gt; Maybe NumericDate
      -&gt; Maybe Text
      -&gt; HashMap Text Value
      -&gt; ClaimsSet)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">HashMap Text Value
</span><a href="#local-6989586621679340358"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap Text Value -&gt; Text -&gt; Parser (Maybe StringOrURI)
forall a.
FromJSON a =&gt;
HashMap Text Value -&gt; Text -&gt; Parser (Maybe a)
</span><span class="hs-operator hs-var">.:?</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;iss&quot;</span></span><span>
</span><span id="line-342"></span><span>    </span><span class="annot"><span class="annottext">Parser
  (Maybe StringOrURI
   -&gt; Maybe Audience
   -&gt; Maybe NumericDate
   -&gt; Maybe NumericDate
   -&gt; Maybe NumericDate
   -&gt; Maybe Text
   -&gt; HashMap Text Value
   -&gt; ClaimsSet)
-&gt; Parser (Maybe StringOrURI)
-&gt; Parser
     (Maybe Audience
      -&gt; Maybe NumericDate
      -&gt; Maybe NumericDate
      -&gt; Maybe NumericDate
      -&gt; Maybe Text
      -&gt; HashMap Text Value
      -&gt; ClaimsSet)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">HashMap Text Value
</span><a href="#local-6989586621679340358"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap Text Value -&gt; Text -&gt; Parser (Maybe StringOrURI)
forall a.
FromJSON a =&gt;
HashMap Text Value -&gt; Text -&gt; Parser (Maybe a)
</span><span class="hs-operator hs-var">.:?</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;sub&quot;</span></span><span>
</span><span id="line-343"></span><span>    </span><span class="annot"><span class="annottext">Parser
  (Maybe Audience
   -&gt; Maybe NumericDate
   -&gt; Maybe NumericDate
   -&gt; Maybe NumericDate
   -&gt; Maybe Text
   -&gt; HashMap Text Value
   -&gt; ClaimsSet)
-&gt; Parser (Maybe Audience)
-&gt; Parser
     (Maybe NumericDate
      -&gt; Maybe NumericDate
      -&gt; Maybe NumericDate
      -&gt; Maybe Text
      -&gt; HashMap Text Value
      -&gt; ClaimsSet)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">HashMap Text Value
</span><a href="#local-6989586621679340358"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap Text Value -&gt; Text -&gt; Parser (Maybe Audience)
forall a.
FromJSON a =&gt;
HashMap Text Value -&gt; Text -&gt; Parser (Maybe a)
</span><span class="hs-operator hs-var">.:?</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;aud&quot;</span></span><span>
</span><span id="line-344"></span><span>    </span><span class="annot"><span class="annottext">Parser
  (Maybe NumericDate
   -&gt; Maybe NumericDate
   -&gt; Maybe NumericDate
   -&gt; Maybe Text
   -&gt; HashMap Text Value
   -&gt; ClaimsSet)
-&gt; Parser (Maybe NumericDate)
-&gt; Parser
     (Maybe NumericDate
      -&gt; Maybe NumericDate
      -&gt; Maybe Text
      -&gt; HashMap Text Value
      -&gt; ClaimsSet)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">HashMap Text Value
</span><a href="#local-6989586621679340358"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap Text Value -&gt; Text -&gt; Parser (Maybe NumericDate)
forall a.
FromJSON a =&gt;
HashMap Text Value -&gt; Text -&gt; Parser (Maybe a)
</span><span class="hs-operator hs-var">.:?</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;exp&quot;</span></span><span>
</span><span id="line-345"></span><span>    </span><span class="annot"><span class="annottext">Parser
  (Maybe NumericDate
   -&gt; Maybe NumericDate
   -&gt; Maybe Text
   -&gt; HashMap Text Value
   -&gt; ClaimsSet)
-&gt; Parser (Maybe NumericDate)
-&gt; Parser
     (Maybe NumericDate
      -&gt; Maybe Text -&gt; HashMap Text Value -&gt; ClaimsSet)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">HashMap Text Value
</span><a href="#local-6989586621679340358"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap Text Value -&gt; Text -&gt; Parser (Maybe NumericDate)
forall a.
FromJSON a =&gt;
HashMap Text Value -&gt; Text -&gt; Parser (Maybe a)
</span><span class="hs-operator hs-var">.:?</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;nbf&quot;</span></span><span>
</span><span id="line-346"></span><span>    </span><span class="annot"><span class="annottext">Parser
  (Maybe NumericDate
   -&gt; Maybe Text -&gt; HashMap Text Value -&gt; ClaimsSet)
-&gt; Parser (Maybe NumericDate)
-&gt; Parser (Maybe Text -&gt; HashMap Text Value -&gt; ClaimsSet)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">HashMap Text Value
</span><a href="#local-6989586621679340358"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap Text Value -&gt; Text -&gt; Parser (Maybe NumericDate)
forall a.
FromJSON a =&gt;
HashMap Text Value -&gt; Text -&gt; Parser (Maybe a)
</span><span class="hs-operator hs-var">.:?</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;iat&quot;</span></span><span>
</span><span id="line-347"></span><span>    </span><span class="annot"><span class="annottext">Parser (Maybe Text -&gt; HashMap Text Value -&gt; ClaimsSet)
-&gt; Parser (Maybe Text) -&gt; Parser (HashMap Text Value -&gt; ClaimsSet)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">HashMap Text Value
</span><a href="#local-6989586621679340358"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap Text Value -&gt; Text -&gt; Parser (Maybe Text)
forall a.
FromJSON a =&gt;
HashMap Text Value -&gt; Text -&gt; Parser (Maybe a)
</span><span class="hs-operator hs-var">.:?</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;jti&quot;</span></span><span>
</span><span id="line-348"></span><span>    </span><span class="annot"><span class="annottext">Parser (HashMap Text Value -&gt; ClaimsSet)
-&gt; Parser (HashMap Text Value) -&gt; Parser ClaimsSet
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">HashMap Text Value -&gt; Parser (HashMap Text Value)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashMap Text Value -&gt; HashMap Text Value
</span><a href="Crypto.JWT.html#filterUnregistered"><span class="hs-identifier hs-var">filterUnregistered</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap Text Value
</span><a href="#local-6989586621679340358"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-349"></span><span>
</span><span id="line-350"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679340350"><span id="local-6989586621679340352"><span id="local-6989586621679340354"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Crypto.JWT.html#ClaimsSet"><span class="hs-identifier hs-type">ClaimsSet</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-351"></span><span>  </span><span id="local-6989586621679340349"><span class="annot"><span class="annottext">toJSON :: ClaimsSet -&gt; Value
</span><a href="#local-6989586621679340349"><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JWT.html#ClaimsSet"><span class="hs-identifier hs-type">ClaimsSet</span></a></span><span> </span><span id="local-6989586621679340348"><span class="annot"><span class="annottext">Maybe StringOrURI
</span><a href="#local-6989586621679340348"><span class="hs-identifier hs-var">iss</span></a></span></span><span> </span><span id="local-6989586621679340347"><span class="annot"><span class="annottext">Maybe StringOrURI
</span><a href="#local-6989586621679340347"><span class="hs-identifier hs-var">sub</span></a></span></span><span> </span><span id="local-6989586621679340346"><span class="annot"><span class="annottext">Maybe Audience
</span><a href="#local-6989586621679340346"><span class="hs-identifier hs-var">aud</span></a></span></span><span> </span><span id="local-6989586621679340345"><span class="annot"><span class="annottext">Maybe NumericDate
</span><a href="#local-6989586621679340345"><span class="hs-identifier hs-var">exp'</span></a></span></span><span> </span><span id="local-6989586621679340344"><span class="annot"><span class="annottext">Maybe NumericDate
</span><a href="#local-6989586621679340344"><span class="hs-identifier hs-var">nbf</span></a></span></span><span> </span><span id="local-6989586621679340343"><span class="annot"><span class="annottext">Maybe NumericDate
</span><a href="#local-6989586621679340343"><span class="hs-identifier hs-var">iat</span></a></span></span><span> </span><span id="local-6989586621679340342"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679340342"><span class="hs-identifier hs-var">jti</span></a></span></span><span> </span><span id="local-6989586621679340341"><span class="annot"><span class="annottext">HashMap Text Value
</span><a href="#local-6989586621679340341"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><span class="hs-identifier hs-var">object</span></span><span> </span><span class="annot"><span class="annottext">([Pair] -&gt; Value) -&gt; [Pair] -&gt; Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Maybe Pair] -&gt; [Pair]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-352"></span><span>    </span><span class="annot"><span class="annottext">(StringOrURI -&gt; Pair) -&gt; Maybe StringOrURI -&gt; Maybe Pair
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;iss&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; StringOrURI -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Text -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe StringOrURI
</span><a href="#local-6989586621679340348"><span class="hs-identifier hs-var">iss</span></a></span><span>
</span><span id="line-353"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(StringOrURI -&gt; Pair) -&gt; Maybe StringOrURI -&gt; Maybe Pair
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;sub&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; StringOrURI -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Text -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe StringOrURI
</span><a href="#local-6989586621679340347"><span class="hs-identifier hs-var">sub</span></a></span><span>
</span><span id="line-354"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Audience -&gt; Pair) -&gt; Maybe Audience -&gt; Maybe Pair
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;aud&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Audience -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Text -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Audience
</span><a href="#local-6989586621679340346"><span class="hs-identifier hs-var">aud</span></a></span><span>
</span><span id="line-355"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(NumericDate -&gt; Pair) -&gt; Maybe NumericDate -&gt; Maybe Pair
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;exp&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; NumericDate -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Text -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe NumericDate
</span><a href="#local-6989586621679340345"><span class="hs-identifier hs-var">exp'</span></a></span><span>
</span><span id="line-356"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(NumericDate -&gt; Pair) -&gt; Maybe NumericDate -&gt; Maybe Pair
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;nbf&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; NumericDate -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Text -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe NumericDate
</span><a href="#local-6989586621679340344"><span class="hs-identifier hs-var">nbf</span></a></span><span>
</span><span id="line-357"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(NumericDate -&gt; Pair) -&gt; Maybe NumericDate -&gt; Maybe Pair
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;iat&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; NumericDate -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Text -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe NumericDate
</span><a href="#local-6989586621679340343"><span class="hs-identifier hs-var">iat</span></a></span><span>
</span><span id="line-358"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Pair) -&gt; Maybe Text -&gt; Maybe Pair
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;jti&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Text -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679340342"><span class="hs-identifier hs-var">jti</span></a></span><span>
</span><span id="line-359"></span><span>    </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Pair] -&gt; [Pair] -&gt; [Pair]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">HashMap Text Value -&gt; [Pair]
forall k v. HashMap k v -&gt; [(k, v)]
</span><span class="hs-identifier hs-var">M.toList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashMap Text Value -&gt; HashMap Text Value
</span><a href="Crypto.JWT.html#filterUnregistered"><span class="hs-identifier hs-var">filterUnregistered</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap Text Value
</span><a href="#local-6989586621679340341"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-360"></span><span>
</span><span id="line-361"></span><span>
</span><span id="line-362"></span><span class="hs-keyword">data</span><span> </span><span id="JWTValidationSettings"><span class="annot"><a href="Crypto.JWT.html#JWTValidationSettings"><span class="hs-identifier hs-var">JWTValidationSettings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="JWTValidationSettings"><span class="annot"><a href="Crypto.JWT.html#JWTValidationSettings"><span class="hs-identifier hs-var">JWTValidationSettings</span></a></span></span><span>
</span><span id="line-363"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="_jwtValidationSettingsValidationSettings"><span class="annot"><span class="annottext">JWTValidationSettings -&gt; ValidationSettings
</span><a href="Crypto.JWT.html#_jwtValidationSettingsValidationSettings"><span class="hs-identifier hs-var hs-var">_jwtValidationSettingsValidationSettings</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#ValidationSettings"><span class="hs-identifier hs-type">ValidationSettings</span></a></span><span>
</span><span id="line-364"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_jwtValidationSettingsAllowedSkew"><span class="annot"><span class="annottext">JWTValidationSettings -&gt; POSIXTime
</span><a href="Crypto.JWT.html#_jwtValidationSettingsAllowedSkew"><span class="hs-identifier hs-var hs-var">_jwtValidationSettingsAllowedSkew</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NominalDiffTime</span></span><span>
</span><span id="line-365"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_jwtValidationSettingsCheckIssuedAt"><span class="annot"><span class="annottext">JWTValidationSettings -&gt; Bool
</span><a href="Crypto.JWT.html#_jwtValidationSettingsCheckIssuedAt"><span class="hs-identifier hs-var hs-var">_jwtValidationSettingsCheckIssuedAt</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-366"></span><span>  </span><span class="hs-comment">-- ^ The allowed skew is interpreted in absolute terms;</span><span>
</span><span id="line-367"></span><span>  </span><span class="hs-comment">--   a nonzero value always expands the validity period.</span><span>
</span><span id="line-368"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_jwtValidationSettingsAudiencePredicate"><span class="annot"><span class="annottext">JWTValidationSettings -&gt; StringOrURI -&gt; Bool
</span><a href="Crypto.JWT.html#_jwtValidationSettingsAudiencePredicate"><span class="hs-identifier hs-var hs-var">_jwtValidationSettingsAudiencePredicate</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.JWT.html#StringOrURI"><span class="hs-identifier hs-type">StringOrURI</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-369"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_jwtValidationSettingsIssuerPredicate"><span class="annot"><span class="annottext">JWTValidationSettings -&gt; StringOrURI -&gt; Bool
</span><a href="Crypto.JWT.html#_jwtValidationSettingsIssuerPredicate"><span class="hs-identifier hs-var hs-var">_jwtValidationSettingsIssuerPredicate</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.JWT.html#StringOrURI"><span class="hs-identifier hs-type">StringOrURI</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-370"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-371"></span><span id="jwtValidationSettingsValidationSettings"><span id="jwtValidationSettingsIssuerPredicate"><span id="jwtValidationSettingsCheckIssuedAt"><span id="jwtValidationSettingsAudiencePredicate"><span id="jwtValidationSettingsAllowedSkew"><span id="jWTValidationSettings"><span id="local-6989586621679340314"><span id="local-6989586621679340316"><span id="local-6989586621679340318"><span id="local-6989586621679340320"><span id="local-6989586621679340322"><span id="local-6989586621679340324"><span id="local-6989586621679340326"><span id="local-6989586621679340327"><span id="local-6989586621679340328"><span id="local-6989586621679340329"><span id="local-6989586621679340330"><span id="HasJWTValidationSettings"><span id="local-6989586621679340819"><span class="hs-identifier">makeClassy</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">JWTValidationSettings</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-372"></span><span>
</span><span id="line-373"></span><span id="local-6989586621679340306"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679340301"><span id="local-6989586621679340303"><span class="annot"><a href="Crypto.JWT.html#HasJWTValidationSettings"><span class="hs-identifier hs-type">HasJWTValidationSettings</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340306"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#HasValidationSettings"><span class="hs-identifier hs-type">HasValidationSettings</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340306"><span class="hs-identifier hs-type">a</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-374"></span><span>  </span><span id="local-6989586621679340299"><span class="annot"><span class="annottext">validationSettings :: (ValidationSettings -&gt; f ValidationSettings) -&gt; a -&gt; f a
</span><a href="Crypto.JOSE.JWS.html#validationSettings"><span class="hs-identifier hs-var hs-var hs-var hs-var">validationSettings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ValidationSettings -&gt; f ValidationSettings) -&gt; a -&gt; f a
forall a. HasJWTValidationSettings a =&gt; Lens' a ValidationSettings
</span><a href="Crypto.JWT.html#jwtValidationSettingsValidationSettings"><span class="hs-identifier hs-var">jwtValidationSettingsValidationSettings</span></a></span></span><span>
</span><span id="line-375"></span><span>
</span><span id="line-376"></span><span class="hs-comment">-- | Maximum allowed skew when validating the /nbf/, /exp/ and /iat/ claims.</span><span>
</span><span id="line-377"></span><span class="hs-keyword">class</span><span> </span><span id="HasAllowedSkew"><span class="annot"><a href="Crypto.JWT.html#HasAllowedSkew"><span class="hs-identifier hs-var">HasAllowedSkew</span></a></span></span><span> </span><span id="local-6989586621679340796"><span class="annot"><a href="#local-6989586621679340796"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-378"></span><span>  </span><span id="allowedSkew"><span class="annot"><a href="Crypto.JWT.html#allowedSkew"><span class="hs-identifier hs-type">allowedSkew</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="annot"><a href="#local-6989586621679340796"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">NominalDiffTime</span></span><span>
</span><span id="line-379"></span><span>
</span><span id="line-380"></span><span class="hs-comment">-- | Predicate for checking values in the /aud/ claim.</span><span>
</span><span id="line-381"></span><span class="hs-keyword">class</span><span> </span><span id="HasAudiencePredicate"><span class="annot"><a href="Crypto.JWT.html#HasAudiencePredicate"><span class="hs-identifier hs-var">HasAudiencePredicate</span></a></span></span><span> </span><span id="local-6989586621679340792"><span class="annot"><a href="#local-6989586621679340792"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-382"></span><span>  </span><span id="audiencePredicate"><span class="annot"><a href="Crypto.JWT.html#audiencePredicate"><span class="hs-identifier hs-type">audiencePredicate</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="annot"><a href="#local-6989586621679340792"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JWT.html#StringOrURI"><span class="hs-identifier hs-type">StringOrURI</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-383"></span><span>
</span><span id="line-384"></span><span class="hs-comment">-- | Predicate for checking the /iss/ claim.</span><span>
</span><span id="line-385"></span><span class="hs-keyword">class</span><span> </span><span id="HasIssuerPredicate"><span class="annot"><a href="Crypto.JWT.html#HasIssuerPredicate"><span class="hs-identifier hs-var">HasIssuerPredicate</span></a></span></span><span> </span><span id="local-6989586621679340788"><span class="annot"><a href="#local-6989586621679340788"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-386"></span><span>  </span><span id="issuerPredicate"><span class="annot"><a href="Crypto.JWT.html#issuerPredicate"><span class="hs-identifier hs-type">issuerPredicate</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="annot"><a href="#local-6989586621679340788"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JWT.html#StringOrURI"><span class="hs-identifier hs-type">StringOrURI</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-387"></span><span>
</span><span id="line-388"></span><span class="hs-comment">-- | Whether to check that the /iat/ claim is not in the future.</span><span>
</span><span id="line-389"></span><span class="hs-keyword">class</span><span> </span><span id="HasCheckIssuedAt"><span class="annot"><a href="Crypto.JWT.html#HasCheckIssuedAt"><span class="hs-identifier hs-var">HasCheckIssuedAt</span></a></span></span><span> </span><span id="local-6989586621679340784"><span class="annot"><a href="#local-6989586621679340784"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-390"></span><span>  </span><span id="checkIssuedAt"><span class="annot"><a href="Crypto.JWT.html#checkIssuedAt"><span class="hs-identifier hs-type">checkIssuedAt</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="annot"><a href="#local-6989586621679340784"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-391"></span><span>
</span><span id="line-392"></span><span id="local-6989586621679340293"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Crypto.JWT.html#HasJWTValidationSettings"><span class="hs-identifier hs-type">HasJWTValidationSettings</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340293"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.JWT.html#HasAllowedSkew"><span class="hs-identifier hs-type">HasAllowedSkew</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340293"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-393"></span><span>  </span><span id="local-6989586621679340290"><span class="annot"><span class="annottext">allowedSkew :: (POSIXTime -&gt; f POSIXTime) -&gt; a -&gt; f a
</span><a href="#local-6989586621679340290"><span class="hs-identifier hs-var hs-var hs-var hs-var">allowedSkew</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(POSIXTime -&gt; f POSIXTime) -&gt; a -&gt; f a
forall a. HasJWTValidationSettings a =&gt; Lens' a POSIXTime
</span><a href="Crypto.JWT.html#jwtValidationSettingsAllowedSkew"><span class="hs-identifier hs-var">jwtValidationSettingsAllowedSkew</span></a></span></span><span>
</span><span id="line-394"></span><span id="local-6989586621679340289"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Crypto.JWT.html#HasJWTValidationSettings"><span class="hs-identifier hs-type">HasJWTValidationSettings</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340289"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.JWT.html#HasAudiencePredicate"><span class="hs-identifier hs-type">HasAudiencePredicate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340289"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-395"></span><span>  </span><span id="local-6989586621679340286"><span class="annot"><span class="annottext">audiencePredicate :: ((StringOrURI -&gt; Bool) -&gt; f (StringOrURI -&gt; Bool)) -&gt; a -&gt; f a
</span><a href="#local-6989586621679340286"><span class="hs-identifier hs-var hs-var hs-var hs-var">audiencePredicate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((StringOrURI -&gt; Bool) -&gt; f (StringOrURI -&gt; Bool)) -&gt; a -&gt; f a
forall a.
HasJWTValidationSettings a =&gt;
Lens' a (StringOrURI -&gt; Bool)
</span><a href="Crypto.JWT.html#jwtValidationSettingsAudiencePredicate"><span class="hs-identifier hs-var">jwtValidationSettingsAudiencePredicate</span></a></span></span><span>
</span><span id="line-396"></span><span id="local-6989586621679340285"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Crypto.JWT.html#HasJWTValidationSettings"><span class="hs-identifier hs-type">HasJWTValidationSettings</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340285"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.JWT.html#HasIssuerPredicate"><span class="hs-identifier hs-type">HasIssuerPredicate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340285"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-397"></span><span>  </span><span id="local-6989586621679340282"><span class="annot"><span class="annottext">issuerPredicate :: ((StringOrURI -&gt; Bool) -&gt; f (StringOrURI -&gt; Bool)) -&gt; a -&gt; f a
</span><a href="#local-6989586621679340282"><span class="hs-identifier hs-var hs-var hs-var hs-var">issuerPredicate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((StringOrURI -&gt; Bool) -&gt; f (StringOrURI -&gt; Bool)) -&gt; a -&gt; f a
forall a.
HasJWTValidationSettings a =&gt;
Lens' a (StringOrURI -&gt; Bool)
</span><a href="Crypto.JWT.html#jwtValidationSettingsIssuerPredicate"><span class="hs-identifier hs-var">jwtValidationSettingsIssuerPredicate</span></a></span></span><span>
</span><span id="line-398"></span><span id="local-6989586621679340281"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Crypto.JWT.html#HasJWTValidationSettings"><span class="hs-identifier hs-type">HasJWTValidationSettings</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340281"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.JWT.html#HasCheckIssuedAt"><span class="hs-identifier hs-type">HasCheckIssuedAt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340281"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-399"></span><span>  </span><span id="local-6989586621679340278"><span class="annot"><span class="annottext">checkIssuedAt :: (Bool -&gt; f Bool) -&gt; a -&gt; f a
</span><a href="#local-6989586621679340278"><span class="hs-identifier hs-var hs-var hs-var hs-var">checkIssuedAt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; f Bool) -&gt; a -&gt; f a
forall a. HasJWTValidationSettings a =&gt; Lens' a Bool
</span><a href="Crypto.JWT.html#jwtValidationSettingsCheckIssuedAt"><span class="hs-identifier hs-var">jwtValidationSettingsCheckIssuedAt</span></a></span></span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span><span class="hs-comment">-- | Acquire the default validation settings.</span><span>
</span><span id="line-402"></span><span class="hs-comment">--</span><span>
</span><span id="line-403"></span><span class="hs-comment">-- &lt;https://tools.ietf.org/html/rfc7519#section-4.1.3 RFC 7519 &#167;4.1.3.&gt;</span><span>
</span><span id="line-404"></span><span class="hs-comment">-- states that applications MUST identify itself with a value in the</span><span>
</span><span id="line-405"></span><span class="hs-comment">-- audience claim, therefore a predicate must be supplied.</span><span>
</span><span id="line-406"></span><span class="hs-comment">--</span><span>
</span><span id="line-407"></span><span class="hs-comment">-- The other defaults are:</span><span>
</span><span id="line-408"></span><span class="hs-comment">--</span><span>
</span><span id="line-409"></span><span class="hs-comment">-- - 'defaultValidationSettings' for JWS verification</span><span>
</span><span id="line-410"></span><span class="hs-comment">-- - Zero clock skew tolerance when validating /nbf/, /exp/ and /iat/ claims</span><span>
</span><span id="line-411"></span><span class="hs-comment">-- - /iat/ claim is checked</span><span>
</span><span id="line-412"></span><span class="hs-comment">-- - /issuer/ claim is not checked</span><span>
</span><span id="line-413"></span><span class="hs-comment">--</span><span>
</span><span id="line-414"></span><span class="annot"><a href="Crypto.JWT.html#defaultJWTValidationSettings"><span class="hs-identifier hs-type">defaultJWTValidationSettings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JWT.html#StringOrURI"><span class="hs-identifier hs-type">StringOrURI</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.JWT.html#JWTValidationSettings"><span class="hs-identifier hs-type">JWTValidationSettings</span></a></span><span>
</span><span id="line-415"></span><span id="defaultJWTValidationSettings"><span class="annot"><span class="annottext">defaultJWTValidationSettings :: (StringOrURI -&gt; Bool) -&gt; JWTValidationSettings
</span><a href="Crypto.JWT.html#defaultJWTValidationSettings"><span class="hs-identifier hs-var hs-var">defaultJWTValidationSettings</span></a></span></span><span> </span><span id="local-6989586621679340277"><span class="annot"><span class="annottext">StringOrURI -&gt; Bool
</span><a href="#local-6989586621679340277"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ValidationSettings
-&gt; POSIXTime
-&gt; Bool
-&gt; (StringOrURI -&gt; Bool)
-&gt; (StringOrURI -&gt; Bool)
-&gt; JWTValidationSettings
</span><a href="Crypto.JWT.html#JWTValidationSettings"><span class="hs-identifier hs-var">JWTValidationSettings</span></a></span><span>
</span><span id="line-416"></span><span>  </span><span class="annot"><span class="annottext">ValidationSettings
</span><a href="Crypto.JOSE.JWS.html#defaultValidationSettings"><span class="hs-identifier hs-var">defaultValidationSettings</span></a></span><span>
</span><span id="line-417"></span><span>  </span><span class="annot"><span class="annottext">POSIXTime
</span><span class="hs-number">0</span></span><span>
</span><span id="line-418"></span><span>  </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-419"></span><span>  </span><span class="annot"><span class="annottext">StringOrURI -&gt; Bool
</span><a href="#local-6989586621679340277"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-420"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; StringOrURI -&gt; Bool
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-421"></span><span>
</span><span id="line-422"></span><span class="hs-comment">-- | Validate the claims made by a ClaimsSet.</span><span>
</span><span id="line-423"></span><span class="hs-comment">--</span><span>
</span><span id="line-424"></span><span class="hs-comment">-- These checks are performed by 'verifyClaims', which also</span><span>
</span><span id="line-425"></span><span class="hs-comment">-- validates any signatures, so you shouldn't need to use this</span><span>
</span><span id="line-426"></span><span class="hs-comment">-- function directly.</span><span>
</span><span id="line-427"></span><span class="hs-comment">--</span><span>
</span><span id="line-428"></span><span id="local-6989586621679340700"><span id="local-6989586621679340701"><span id="local-6989586621679340702"><span class="annot"><a href="Crypto.JWT.html#validateClaimsSet"><span class="hs-identifier hs-type">validateClaimsSet</span></a></span><span>
</span><span id="line-429"></span><span>  </span><span class="hs-glyph">::</span><span>
</span><span id="line-430"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadTime</span></span><span> </span><span class="annot"><a href="#local-6989586621679340702"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#HasAllowedSkew"><span class="hs-identifier hs-type">HasAllowedSkew</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340701"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#HasAudiencePredicate"><span class="hs-identifier hs-type">HasAudiencePredicate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340701"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-431"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#HasIssuerPredicate"><span class="hs-identifier hs-type">HasIssuerPredicate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340701"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-432"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#HasCheckIssuedAt"><span class="hs-identifier hs-type">HasCheckIssuedAt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340701"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-433"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#AsJWTError"><span class="hs-identifier hs-type">AsJWTError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340700"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="#local-6989586621679340700"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340702"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-434"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-435"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679340701"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-436"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.JWT.html#ClaimsSet"><span class="hs-identifier hs-type">ClaimsSet</span></a></span><span>
</span><span id="line-437"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679340702"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Crypto.JWT.html#ClaimsSet"><span class="hs-identifier hs-type">ClaimsSet</span></a></span></span></span></span><span>
</span><span id="line-438"></span><span id="validateClaimsSet"><span class="annot"><span class="annottext">validateClaimsSet :: a -&gt; ClaimsSet -&gt; m ClaimsSet
</span><a href="Crypto.JWT.html#validateClaimsSet"><span class="hs-identifier hs-var hs-var">validateClaimsSet</span></a></span></span><span> </span><span id="local-6989586621679340274"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679340274"><span class="hs-identifier hs-var">conf</span></a></span></span><span> </span><span id="local-6989586621679340273"><span class="annot"><span class="annottext">ClaimsSet
</span><a href="#local-6989586621679340273"><span class="hs-identifier hs-var">claims</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-439"></span><span>  </span><span class="annot"><span class="annottext">((a -&gt; ClaimsSet -&gt; m ()) -&gt; m ())
-&gt; [a -&gt; ClaimsSet -&gt; m ()] -&gt; m ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f ()
</span><span class="hs-identifier hs-var">traverse_</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ClaimsSet -&gt; m ()) -&gt; ClaimsSet -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ClaimsSet
</span><a href="#local-6989586621679340273"><span class="hs-identifier hs-var">claims</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ClaimsSet -&gt; m ()) -&gt; m ())
-&gt; ((a -&gt; ClaimsSet -&gt; m ()) -&gt; ClaimsSet -&gt; m ())
-&gt; (a -&gt; ClaimsSet -&gt; m ())
-&gt; m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; ClaimsSet -&gt; m ()) -&gt; a -&gt; ClaimsSet -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679340274"><span class="hs-identifier hs-var">conf</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-440"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">a -&gt; ClaimsSet -&gt; m ()
forall (m :: * -&gt; *) a e.
(MonadTime m, HasAllowedSkew a, AsJWTError e, MonadError e m) =&gt;
a -&gt; ClaimsSet -&gt; m ()
</span><a href="Crypto.JWT.html#validateExpClaim"><span class="hs-identifier hs-var">validateExpClaim</span></a></span><span>
</span><span id="line-441"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; ClaimsSet -&gt; m ()
forall (m :: * -&gt; *) a e.
(MonadTime m, HasCheckIssuedAt a, HasAllowedSkew a, AsJWTError e,
 MonadError e m) =&gt;
a -&gt; ClaimsSet -&gt; m ()
</span><a href="Crypto.JWT.html#validateIatClaim"><span class="hs-identifier hs-var">validateIatClaim</span></a></span><span>
</span><span id="line-442"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; ClaimsSet -&gt; m ()
forall (m :: * -&gt; *) a e.
(MonadTime m, HasAllowedSkew a, AsJWTError e, MonadError e m) =&gt;
a -&gt; ClaimsSet -&gt; m ()
</span><a href="Crypto.JWT.html#validateNbfClaim"><span class="hs-identifier hs-var">validateNbfClaim</span></a></span><span>
</span><span id="line-443"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; ClaimsSet -&gt; m ()
forall s e (m :: * -&gt; *).
(HasIssuerPredicate s, AsJWTError e, MonadError e m) =&gt;
s -&gt; ClaimsSet -&gt; m ()
</span><a href="Crypto.JWT.html#validateIssClaim"><span class="hs-identifier hs-var">validateIssClaim</span></a></span><span>
</span><span id="line-444"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; ClaimsSet -&gt; m ()
forall s e (m :: * -&gt; *).
(HasAudiencePredicate s, AsJWTError e, MonadError e m) =&gt;
s -&gt; ClaimsSet -&gt; m ()
</span><a href="Crypto.JWT.html#validateAudClaim"><span class="hs-identifier hs-var">validateAudClaim</span></a></span><span>
</span><span id="line-445"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-446"></span><span>  </span><span class="annot"><span class="annottext">m () -&gt; m ClaimsSet -&gt; m ClaimsSet
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ClaimsSet -&gt; m ClaimsSet
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">ClaimsSet
</span><a href="#local-6989586621679340273"><span class="hs-identifier hs-var">claims</span></a></span><span>
</span><span id="line-447"></span><span>
</span><span id="line-448"></span><span id="local-6989586621679340771"><span id="local-6989586621679340772"><span id="local-6989586621679340774"><span class="annot"><a href="Crypto.JWT.html#validateExpClaim"><span class="hs-identifier hs-type">validateExpClaim</span></a></span><span>
</span><span id="line-449"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadTime</span></span><span> </span><span class="annot"><a href="#local-6989586621679340774"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#HasAllowedSkew"><span class="hs-identifier hs-type">HasAllowedSkew</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340772"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#AsJWTError"><span class="hs-identifier hs-type">AsJWTError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340771"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="#local-6989586621679340771"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340774"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-450"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679340772"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-451"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.JWT.html#ClaimsSet"><span class="hs-identifier hs-type">ClaimsSet</span></a></span><span>
</span><span id="line-452"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679340774"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-453"></span><span id="validateExpClaim"><span class="annot"><span class="annottext">validateExpClaim :: a -&gt; ClaimsSet -&gt; m ()
</span><a href="Crypto.JWT.html#validateExpClaim"><span class="hs-identifier hs-var hs-var">validateExpClaim</span></a></span></span><span> </span><span id="local-6989586621679340267"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679340267"><span class="hs-identifier hs-var">conf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-454"></span><span>  </span><span class="annot"><span class="annottext">(NumericDate -&gt; m ()) -&gt; Maybe NumericDate -&gt; m ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f ()
</span><span class="hs-identifier hs-var">traverse_</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679340266"><span class="annot"><span class="annottext">NumericDate
</span><a href="#local-6989586621679340266"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-455"></span><span>    </span><span id="local-6989586621679340265"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679340265"><span class="hs-identifier hs-var">now</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m UTCTime
forall (m :: * -&gt; *). MonadTime m =&gt; m UTCTime
</span><span class="hs-identifier hs-var">currentTime</span></span><span>
</span><span id="line-456"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; m () -&gt; m ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679340265"><span class="hs-identifier hs-var">now</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; UTCTime -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">POSIXTime -&gt; UTCTime -&gt; UTCTime
</span><span class="hs-identifier hs-var">addUTCTime</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">POSIXTime -&gt; POSIXTime
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting POSIXTime a POSIXTime -&gt; a -&gt; POSIXTime
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting POSIXTime a POSIXTime
forall s. HasAllowedSkew s =&gt; Lens' s POSIXTime
</span><a href="Crypto.JWT.html#allowedSkew"><span class="hs-identifier hs-var">allowedSkew</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679340267"><span class="hs-identifier hs-var">conf</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting UTCTime NumericDate UTCTime -&gt; NumericDate -&gt; UTCTime
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting UTCTime NumericDate UTCTime
Iso' NumericDate UTCTime
</span><a href="Crypto.JWT.html#_NumericDate"><span class="hs-identifier hs-var">_NumericDate</span></a></span><span> </span><span class="annot"><span class="annottext">NumericDate
</span><a href="#local-6989586621679340266"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m () -&gt; m ()) -&gt; m () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-457"></span><span>      </span><span class="annot"><span class="annottext">AReview e () -&gt; m ()
forall e (m :: * -&gt; *) x. MonadError e m =&gt; AReview e () -&gt; m x
</span><span class="hs-identifier hs-var">throwing_</span></span><span> </span><span class="annot"><span class="annottext">AReview e ()
forall r. AsJWTError r =&gt; Prism' r ()
</span><a href="Crypto.JWT.html#_JWTExpired"><span class="hs-identifier hs-var">_JWTExpired</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-458"></span><span>  </span><span class="annot"><span class="annottext">(Maybe NumericDate -&gt; m ())
-&gt; (ClaimsSet -&gt; Maybe NumericDate) -&gt; ClaimsSet -&gt; m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Getting (First NumericDate) ClaimsSet NumericDate
-&gt; ClaimsSet -&gt; Maybe NumericDate
forall s (m :: * -&gt; *) a.
MonadReader s m =&gt;
Getting (First a) s a -&gt; m (Maybe a)
</span><span class="hs-identifier hs-var">preview</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Maybe NumericDate
 -&gt; Const (First NumericDate) (Maybe NumericDate))
-&gt; ClaimsSet -&gt; Const (First NumericDate) ClaimsSet
Lens' ClaimsSet (Maybe NumericDate)
</span><a href="Crypto.JWT.html#claimExp"><span class="hs-identifier hs-var">claimExp</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe NumericDate
  -&gt; Const (First NumericDate) (Maybe NumericDate))
 -&gt; ClaimsSet -&gt; Const (First NumericDate) ClaimsSet)
-&gt; ((NumericDate -&gt; Const (First NumericDate) NumericDate)
    -&gt; Maybe NumericDate
    -&gt; Const (First NumericDate) (Maybe NumericDate))
-&gt; Getting (First NumericDate) ClaimsSet NumericDate
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(NumericDate -&gt; Const (First NumericDate) NumericDate)
-&gt; Maybe NumericDate
-&gt; Const (First NumericDate) (Maybe NumericDate)
forall a b. Prism (Maybe a) (Maybe b) a b
</span><span class="hs-identifier hs-var">_Just</span></span><span class="hs-special">)</span><span>
</span><span id="line-459"></span><span>
</span><span id="line-460"></span><span id="local-6989586621679340767"><span id="local-6989586621679340768"><span id="local-6989586621679340769"><span class="annot"><a href="Crypto.JWT.html#validateIatClaim"><span class="hs-identifier hs-type">validateIatClaim</span></a></span><span>
</span><span id="line-461"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadTime</span></span><span> </span><span class="annot"><a href="#local-6989586621679340769"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#HasCheckIssuedAt"><span class="hs-identifier hs-type">HasCheckIssuedAt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340768"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#HasAllowedSkew"><span class="hs-identifier hs-type">HasAllowedSkew</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340768"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#AsJWTError"><span class="hs-identifier hs-type">AsJWTError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340767"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="#local-6989586621679340767"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340769"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-462"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679340768"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-463"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.JWT.html#ClaimsSet"><span class="hs-identifier hs-type">ClaimsSet</span></a></span><span>
</span><span id="line-464"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679340769"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-465"></span><span id="validateIatClaim"><span class="annot"><span class="annottext">validateIatClaim :: a -&gt; ClaimsSet -&gt; m ()
</span><a href="Crypto.JWT.html#validateIatClaim"><span class="hs-identifier hs-var hs-var">validateIatClaim</span></a></span></span><span> </span><span id="local-6989586621679340260"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679340260"><span class="hs-identifier hs-var">conf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-466"></span><span>  </span><span class="annot"><span class="annottext">(NumericDate -&gt; m ()) -&gt; Maybe NumericDate -&gt; m ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f ()
</span><span class="hs-identifier hs-var">traverse_</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679340259"><span class="annot"><span class="annottext">NumericDate
</span><a href="#local-6989586621679340259"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-467"></span><span>    </span><span id="local-6989586621679340258"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679340258"><span class="hs-identifier hs-var">now</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m UTCTime
forall (m :: * -&gt; *). MonadTime m =&gt; m UTCTime
</span><span class="hs-identifier hs-var">currentTime</span></span><span>
</span><span id="line-468"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; m () -&gt; m ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting Bool a Bool -&gt; a -&gt; Bool
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting Bool a Bool
forall s. HasCheckIssuedAt s =&gt; Lens' s Bool
</span><a href="Crypto.JWT.html#checkIssuedAt"><span class="hs-identifier hs-var">checkIssuedAt</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679340260"><span class="hs-identifier hs-var">conf</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m () -&gt; m ()) -&gt; m () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-469"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; m () -&gt; m ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting UTCTime NumericDate UTCTime -&gt; NumericDate -&gt; UTCTime
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting UTCTime NumericDate UTCTime
Iso' NumericDate UTCTime
</span><a href="Crypto.JWT.html#_NumericDate"><span class="hs-identifier hs-var">_NumericDate</span></a></span><span> </span><span class="annot"><span class="annottext">NumericDate
</span><a href="#local-6989586621679340259"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; UTCTime -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">POSIXTime -&gt; UTCTime -&gt; UTCTime
</span><span class="hs-identifier hs-var">addUTCTime</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">POSIXTime -&gt; POSIXTime
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting POSIXTime a POSIXTime -&gt; a -&gt; POSIXTime
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting POSIXTime a POSIXTime
forall s. HasAllowedSkew s =&gt; Lens' s POSIXTime
</span><a href="Crypto.JWT.html#allowedSkew"><span class="hs-identifier hs-var">allowedSkew</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679340260"><span class="hs-identifier hs-var">conf</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679340258"><span class="hs-identifier hs-var">now</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m () -&gt; m ()) -&gt; m () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-470"></span><span>        </span><span class="annot"><span class="annottext">AReview e () -&gt; m ()
forall e (m :: * -&gt; *) x. MonadError e m =&gt; AReview e () -&gt; m x
</span><span class="hs-identifier hs-var">throwing_</span></span><span> </span><span class="annot"><span class="annottext">AReview e ()
forall r. AsJWTError r =&gt; Prism' r ()
</span><a href="Crypto.JWT.html#_JWTIssuedAtFuture"><span class="hs-identifier hs-var">_JWTIssuedAtFuture</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-471"></span><span>    </span><span class="annot"><span class="annottext">(Maybe NumericDate -&gt; m ())
-&gt; (ClaimsSet -&gt; Maybe NumericDate) -&gt; ClaimsSet -&gt; m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Getting (First NumericDate) ClaimsSet NumericDate
-&gt; ClaimsSet -&gt; Maybe NumericDate
forall s (m :: * -&gt; *) a.
MonadReader s m =&gt;
Getting (First a) s a -&gt; m (Maybe a)
</span><span class="hs-identifier hs-var">preview</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Maybe NumericDate
 -&gt; Const (First NumericDate) (Maybe NumericDate))
-&gt; ClaimsSet -&gt; Const (First NumericDate) ClaimsSet
Lens' ClaimsSet (Maybe NumericDate)
</span><a href="Crypto.JWT.html#claimIat"><span class="hs-identifier hs-var">claimIat</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe NumericDate
  -&gt; Const (First NumericDate) (Maybe NumericDate))
 -&gt; ClaimsSet -&gt; Const (First NumericDate) ClaimsSet)
-&gt; ((NumericDate -&gt; Const (First NumericDate) NumericDate)
    -&gt; Maybe NumericDate
    -&gt; Const (First NumericDate) (Maybe NumericDate))
-&gt; Getting (First NumericDate) ClaimsSet NumericDate
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(NumericDate -&gt; Const (First NumericDate) NumericDate)
-&gt; Maybe NumericDate
-&gt; Const (First NumericDate) (Maybe NumericDate)
forall a b. Prism (Maybe a) (Maybe b) a b
</span><span class="hs-identifier hs-var">_Just</span></span><span class="hs-special">)</span><span>
</span><span id="line-472"></span><span>
</span><span id="line-473"></span><span id="local-6989586621679340253"><span id="local-6989586621679340254"><span id="local-6989586621679340255"><span class="annot"><a href="Crypto.JWT.html#validateNbfClaim"><span class="hs-identifier hs-type">validateNbfClaim</span></a></span><span>
</span><span id="line-474"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadTime</span></span><span> </span><span class="annot"><a href="#local-6989586621679340255"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#HasAllowedSkew"><span class="hs-identifier hs-type">HasAllowedSkew</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340254"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#AsJWTError"><span class="hs-identifier hs-type">AsJWTError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340253"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="#local-6989586621679340253"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340255"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-475"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679340254"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-476"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.JWT.html#ClaimsSet"><span class="hs-identifier hs-type">ClaimsSet</span></a></span><span>
</span><span id="line-477"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679340255"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-478"></span><span id="validateNbfClaim"><span class="annot"><span class="annottext">validateNbfClaim :: a -&gt; ClaimsSet -&gt; m ()
</span><a href="Crypto.JWT.html#validateNbfClaim"><span class="hs-identifier hs-var hs-var">validateNbfClaim</span></a></span></span><span> </span><span id="local-6989586621679340252"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679340252"><span class="hs-identifier hs-var">conf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-479"></span><span>  </span><span class="annot"><span class="annottext">(NumericDate -&gt; m ()) -&gt; Maybe NumericDate -&gt; m ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f ()
</span><span class="hs-identifier hs-var">traverse_</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679340251"><span class="annot"><span class="annottext">NumericDate
</span><a href="#local-6989586621679340251"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-480"></span><span>    </span><span id="local-6989586621679340250"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679340250"><span class="hs-identifier hs-var">now</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m UTCTime
forall (m :: * -&gt; *). MonadTime m =&gt; m UTCTime
</span><span class="hs-identifier hs-var">currentTime</span></span><span>
</span><span id="line-481"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; m () -&gt; m ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679340250"><span class="hs-identifier hs-var">now</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; UTCTime -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">POSIXTime -&gt; UTCTime -&gt; UTCTime
</span><span class="hs-identifier hs-var">addUTCTime</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">POSIXTime -&gt; POSIXTime
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">POSIXTime -&gt; POSIXTime
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting POSIXTime a POSIXTime -&gt; a -&gt; POSIXTime
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting POSIXTime a POSIXTime
forall s. HasAllowedSkew s =&gt; Lens' s POSIXTime
</span><a href="Crypto.JWT.html#allowedSkew"><span class="hs-identifier hs-var">allowedSkew</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679340252"><span class="hs-identifier hs-var">conf</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting UTCTime NumericDate UTCTime -&gt; NumericDate -&gt; UTCTime
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting UTCTime NumericDate UTCTime
Iso' NumericDate UTCTime
</span><a href="Crypto.JWT.html#_NumericDate"><span class="hs-identifier hs-var">_NumericDate</span></a></span><span> </span><span class="annot"><span class="annottext">NumericDate
</span><a href="#local-6989586621679340251"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m () -&gt; m ()) -&gt; m () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-482"></span><span>      </span><span class="annot"><span class="annottext">AReview e () -&gt; m ()
forall e (m :: * -&gt; *) x. MonadError e m =&gt; AReview e () -&gt; m x
</span><span class="hs-identifier hs-var">throwing_</span></span><span> </span><span class="annot"><span class="annottext">AReview e ()
forall r. AsJWTError r =&gt; Prism' r ()
</span><a href="Crypto.JWT.html#_JWTNotYetValid"><span class="hs-identifier hs-var">_JWTNotYetValid</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-483"></span><span>  </span><span class="annot"><span class="annottext">(Maybe NumericDate -&gt; m ())
-&gt; (ClaimsSet -&gt; Maybe NumericDate) -&gt; ClaimsSet -&gt; m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Getting (First NumericDate) ClaimsSet NumericDate
-&gt; ClaimsSet -&gt; Maybe NumericDate
forall s (m :: * -&gt; *) a.
MonadReader s m =&gt;
Getting (First a) s a -&gt; m (Maybe a)
</span><span class="hs-identifier hs-var">preview</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Maybe NumericDate
 -&gt; Const (First NumericDate) (Maybe NumericDate))
-&gt; ClaimsSet -&gt; Const (First NumericDate) ClaimsSet
Lens' ClaimsSet (Maybe NumericDate)
</span><a href="Crypto.JWT.html#claimNbf"><span class="hs-identifier hs-var">claimNbf</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe NumericDate
  -&gt; Const (First NumericDate) (Maybe NumericDate))
 -&gt; ClaimsSet -&gt; Const (First NumericDate) ClaimsSet)
-&gt; ((NumericDate -&gt; Const (First NumericDate) NumericDate)
    -&gt; Maybe NumericDate
    -&gt; Const (First NumericDate) (Maybe NumericDate))
-&gt; Getting (First NumericDate) ClaimsSet NumericDate
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(NumericDate -&gt; Const (First NumericDate) NumericDate)
-&gt; Maybe NumericDate
-&gt; Const (First NumericDate) (Maybe NumericDate)
forall a b. Prism (Maybe a) (Maybe b) a b
</span><span class="hs-identifier hs-var">_Just</span></span><span class="hs-special">)</span><span>
</span><span id="line-484"></span><span>
</span><span id="line-485"></span><span id="local-6989586621679340761"><span id="local-6989586621679340762"><span id="local-6989586621679340763"><span class="annot"><a href="Crypto.JWT.html#validateAudClaim"><span class="hs-identifier hs-type">validateAudClaim</span></a></span><span>
</span><span id="line-486"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JWT.html#HasAudiencePredicate"><span class="hs-identifier hs-type">HasAudiencePredicate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340763"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#AsJWTError"><span class="hs-identifier hs-type">AsJWTError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340762"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="#local-6989586621679340762"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340761"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-487"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679340763"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-488"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.JWT.html#ClaimsSet"><span class="hs-identifier hs-type">ClaimsSet</span></a></span><span>
</span><span id="line-489"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679340761"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-490"></span><span id="validateAudClaim"><span class="annot"><span class="annottext">validateAudClaim :: s -&gt; ClaimsSet -&gt; m ()
</span><a href="Crypto.JWT.html#validateAudClaim"><span class="hs-identifier hs-var hs-var">validateAudClaim</span></a></span></span><span> </span><span id="local-6989586621679340249"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679340249"><span class="hs-identifier hs-var">conf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-491"></span><span>  </span><span class="annot"><span class="annottext">([StringOrURI] -&gt; m ()) -&gt; Maybe [StringOrURI] -&gt; m ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f ()
</span><span class="hs-identifier hs-var">traverse_</span></span><span>
</span><span id="line-492"></span><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679340248"><span class="annot"><span class="annottext">[StringOrURI]
</span><a href="#local-6989586621679340248"><span class="hs-identifier hs-var">auds</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m () -&gt; m ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">or</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting (StringOrURI -&gt; Bool) s (StringOrURI -&gt; Bool)
-&gt; s -&gt; StringOrURI -&gt; Bool
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting (StringOrURI -&gt; Bool) s (StringOrURI -&gt; Bool)
forall s. HasAudiencePredicate s =&gt; Lens' s (StringOrURI -&gt; Bool)
</span><a href="Crypto.JWT.html#audiencePredicate"><span class="hs-identifier hs-var">audiencePredicate</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679340249"><span class="hs-identifier hs-var">conf</span></a></span><span> </span><span class="annot"><span class="annottext">(StringOrURI -&gt; Bool) -&gt; [StringOrURI] -&gt; [Bool]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[StringOrURI]
</span><a href="#local-6989586621679340248"><span class="hs-identifier hs-var">auds</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m () -&gt; m ()) -&gt; m () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-493"></span><span>        </span><span class="annot"><span class="annottext">AReview e () -&gt; m ()
forall e (m :: * -&gt; *) x. MonadError e m =&gt; AReview e () -&gt; m x
</span><span class="hs-identifier hs-var">throwing_</span></span><span> </span><span class="annot"><span class="annottext">AReview e ()
forall r. AsJWTError r =&gt; Prism' r ()
</span><a href="Crypto.JWT.html#_JWTNotInAudience"><span class="hs-identifier hs-var">_JWTNotInAudience</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-494"></span><span>  </span><span class="annot"><span class="annottext">(Maybe [StringOrURI] -&gt; m ())
-&gt; (ClaimsSet -&gt; Maybe [StringOrURI]) -&gt; ClaimsSet -&gt; m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Getting (First [StringOrURI]) ClaimsSet [StringOrURI]
-&gt; ClaimsSet -&gt; Maybe [StringOrURI]
forall s (m :: * -&gt; *) a.
MonadReader s m =&gt;
Getting (First a) s a -&gt; m (Maybe a)
</span><span class="hs-identifier hs-var">preview</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Maybe Audience -&gt; Const (First [StringOrURI]) (Maybe Audience))
-&gt; ClaimsSet -&gt; Const (First [StringOrURI]) ClaimsSet
Lens' ClaimsSet (Maybe Audience)
</span><a href="Crypto.JWT.html#claimAud"><span class="hs-identifier hs-var">claimAud</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe Audience -&gt; Const (First [StringOrURI]) (Maybe Audience))
 -&gt; ClaimsSet -&gt; Const (First [StringOrURI]) ClaimsSet)
-&gt; (([StringOrURI] -&gt; Const (First [StringOrURI]) [StringOrURI])
    -&gt; Maybe Audience -&gt; Const (First [StringOrURI]) (Maybe Audience))
-&gt; Getting (First [StringOrURI]) ClaimsSet [StringOrURI]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Audience -&gt; Const (First [StringOrURI]) Audience)
-&gt; Maybe Audience -&gt; Const (First [StringOrURI]) (Maybe Audience)
forall a b. Prism (Maybe a) (Maybe b) a b
</span><span class="hs-identifier hs-var">_Just</span></span><span> </span><span class="annot"><span class="annottext">((Audience -&gt; Const (First [StringOrURI]) Audience)
 -&gt; Maybe Audience -&gt; Const (First [StringOrURI]) (Maybe Audience))
-&gt; (([StringOrURI] -&gt; Const (First [StringOrURI]) [StringOrURI])
    -&gt; Audience -&gt; Const (First [StringOrURI]) Audience)
-&gt; ([StringOrURI] -&gt; Const (First [StringOrURI]) [StringOrURI])
-&gt; Maybe Audience
-&gt; Const (First [StringOrURI]) (Maybe Audience)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">([StringOrURI] -&gt; Const (First [StringOrURI]) [StringOrURI])
-&gt; Audience -&gt; Const (First [StringOrURI]) Audience
Iso' Audience [StringOrURI]
</span><a href="Crypto.JWT.html#_Audience"><span class="hs-identifier hs-var">_Audience</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-495"></span><span>
</span><span id="line-496"></span><span id="local-6989586621679340764"><span id="local-6989586621679340765"><span id="local-6989586621679340766"><span class="annot"><a href="Crypto.JWT.html#validateIssClaim"><span class="hs-identifier hs-type">validateIssClaim</span></a></span><span>
</span><span id="line-497"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JWT.html#HasIssuerPredicate"><span class="hs-identifier hs-type">HasIssuerPredicate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340766"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#AsJWTError"><span class="hs-identifier hs-type">AsJWTError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340765"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="#local-6989586621679340765"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340764"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-498"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679340766"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-499"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.JWT.html#ClaimsSet"><span class="hs-identifier hs-type">ClaimsSet</span></a></span><span>
</span><span id="line-500"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679340764"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-501"></span><span id="validateIssClaim"><span class="annot"><span class="annottext">validateIssClaim :: s -&gt; ClaimsSet -&gt; m ()
</span><a href="Crypto.JWT.html#validateIssClaim"><span class="hs-identifier hs-var hs-var">validateIssClaim</span></a></span></span><span> </span><span id="local-6989586621679340246"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679340246"><span class="hs-identifier hs-var">conf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-502"></span><span>  </span><span class="annot"><span class="annottext">(StringOrURI -&gt; m ()) -&gt; Maybe StringOrURI -&gt; m ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f ()
</span><span class="hs-identifier hs-var">traverse_</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679340245"><span class="annot"><span class="annottext">StringOrURI
</span><a href="#local-6989586621679340245"><span class="hs-identifier hs-var">iss</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-503"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; m () -&gt; m ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting (StringOrURI -&gt; Bool) s (StringOrURI -&gt; Bool)
-&gt; s -&gt; StringOrURI -&gt; Bool
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting (StringOrURI -&gt; Bool) s (StringOrURI -&gt; Bool)
forall s. HasIssuerPredicate s =&gt; Lens' s (StringOrURI -&gt; Bool)
</span><a href="Crypto.JWT.html#issuerPredicate"><span class="hs-identifier hs-var">issuerPredicate</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679340246"><span class="hs-identifier hs-var">conf</span></a></span><span> </span><span class="annot"><span class="annottext">StringOrURI
</span><a href="#local-6989586621679340245"><span class="hs-identifier hs-var">iss</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AReview e () -&gt; m ()
forall e (m :: * -&gt; *) x. MonadError e m =&gt; AReview e () -&gt; m x
</span><span class="hs-identifier hs-var">throwing_</span></span><span> </span><span class="annot"><span class="annottext">AReview e ()
forall r. AsJWTError r =&gt; Prism' r ()
</span><a href="Crypto.JWT.html#_JWTNotInIssuer"><span class="hs-identifier hs-var">_JWTNotInIssuer</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-504"></span><span>  </span><span class="annot"><span class="annottext">(Maybe StringOrURI -&gt; m ())
-&gt; (ClaimsSet -&gt; Maybe StringOrURI) -&gt; ClaimsSet -&gt; m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Getting (First StringOrURI) ClaimsSet StringOrURI
-&gt; ClaimsSet -&gt; Maybe StringOrURI
forall s (m :: * -&gt; *) a.
MonadReader s m =&gt;
Getting (First a) s a -&gt; m (Maybe a)
</span><span class="hs-identifier hs-var">preview</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Maybe StringOrURI
 -&gt; Const (First StringOrURI) (Maybe StringOrURI))
-&gt; ClaimsSet -&gt; Const (First StringOrURI) ClaimsSet
Lens' ClaimsSet (Maybe StringOrURI)
</span><a href="Crypto.JWT.html#claimIss"><span class="hs-identifier hs-var">claimIss</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe StringOrURI
  -&gt; Const (First StringOrURI) (Maybe StringOrURI))
 -&gt; ClaimsSet -&gt; Const (First StringOrURI) ClaimsSet)
-&gt; ((StringOrURI -&gt; Const (First StringOrURI) StringOrURI)
    -&gt; Maybe StringOrURI
    -&gt; Const (First StringOrURI) (Maybe StringOrURI))
-&gt; Getting (First StringOrURI) ClaimsSet StringOrURI
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(StringOrURI -&gt; Const (First StringOrURI) StringOrURI)
-&gt; Maybe StringOrURI
-&gt; Const (First StringOrURI) (Maybe StringOrURI)
forall a b. Prism (Maybe a) (Maybe b) a b
</span><span class="hs-identifier hs-var">_Just</span></span><span class="hs-special">)</span><span>
</span><span id="line-505"></span><span>
</span><span id="line-506"></span><span class="hs-comment">-- | A digitally signed or MACed JWT</span><span>
</span><span id="line-507"></span><span class="hs-comment">--</span><span>
</span><span id="line-508"></span><span class="hs-keyword">type</span><span> </span><span id="SignedJWT"><span class="annot"><a href="Crypto.JWT.html#SignedJWT"><span class="hs-identifier hs-var">SignedJWT</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#CompactJWS"><span class="hs-identifier hs-type">CompactJWS</span></a></span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#JWSHeader"><span class="hs-identifier hs-type">JWSHeader</span></a></span><span>
</span><span id="line-509"></span><span>
</span><span id="line-510"></span><span>
</span><span id="line-511"></span><span class="hs-keyword">newtype</span><span> </span><span id="WrappedUTCTime"><span class="annot"><a href="Crypto.JWT.html#WrappedUTCTime"><span class="hs-identifier hs-var">WrappedUTCTime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="WrappedUTCTime"><span class="annot"><a href="Crypto.JWT.html#WrappedUTCTime"><span class="hs-identifier hs-var">WrappedUTCTime</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="getUTCTime"><span class="annot"><span class="annottext">WrappedUTCTime -&gt; UTCTime
</span><a href="Crypto.JWT.html#getUTCTime"><span class="hs-identifier hs-var hs-var">getUTCTime</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTCTime</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-512"></span><span>
</span><span id="line-513"></span><span id="local-6989586621679340241"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679340241"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadTime</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="Crypto.JWT.html#WrappedUTCTime"><span class="hs-identifier hs-type">WrappedUTCTime</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340241"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-514"></span><span>  </span><span id="local-6989586621679340237"><span class="annot"><span class="annottext">currentTime :: ReaderT WrappedUTCTime m UTCTime
</span><a href="#local-6989586621679340237"><span class="hs-identifier hs-var hs-var hs-var hs-var">currentTime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WrappedUTCTime -&gt; UTCTime
</span><a href="Crypto.JWT.html#getUTCTime"><span class="hs-identifier hs-var hs-var">getUTCTime</span></a></span><span> </span><span class="annot"><span class="annottext">(WrappedUTCTime -&gt; UTCTime)
-&gt; ReaderT WrappedUTCTime m WrappedUTCTime
-&gt; ReaderT WrappedUTCTime m UTCTime
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReaderT WrappedUTCTime m WrappedUTCTime
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span></span><span>
</span><span id="line-515"></span><span>
</span><span id="line-516"></span><span>
</span><span id="line-517"></span><span class="hs-comment">-- | Cryptographically verify a JWS JWT, then validate the</span><span>
</span><span id="line-518"></span><span class="hs-comment">-- Claims Set, returning it if valid.</span><span>
</span><span id="line-519"></span><span class="hs-comment">--</span><span>
</span><span id="line-520"></span><span class="hs-comment">-- This is the only way to get at the claims of a JWS JWT,</span><span>
</span><span id="line-521"></span><span class="hs-comment">-- enforcing that the claims are cryptographically and</span><span>
</span><span id="line-522"></span><span class="hs-comment">-- semantically valid before the application can use them.</span><span>
</span><span id="line-523"></span><span class="hs-comment">--</span><span>
</span><span id="line-524"></span><span class="hs-comment">-- See also 'verifyClaimsAt' which allows you to explicitly specify</span><span>
</span><span id="line-525"></span><span class="hs-comment">-- the time.</span><span>
</span><span id="line-526"></span><span class="hs-comment">--</span><span>
</span><span id="line-527"></span><span id="local-6989586621679340680"><span id="local-6989586621679340682"><span id="local-6989586621679340683"><span id="local-6989586621679340684"><span class="annot"><a href="Crypto.JWT.html#verifyClaims"><span class="hs-identifier hs-type">verifyClaims</span></a></span><span>
</span><span id="line-528"></span><span>  </span><span class="hs-glyph">::</span><span>
</span><span id="line-529"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadTime</span></span><span> </span><span class="annot"><a href="#local-6989586621679340684"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#HasAllowedSkew"><span class="hs-identifier hs-type">HasAllowedSkew</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340683"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#HasAudiencePredicate"><span class="hs-identifier hs-type">HasAudiencePredicate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340683"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-530"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#HasIssuerPredicate"><span class="hs-identifier hs-type">HasIssuerPredicate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340683"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-531"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#HasCheckIssuedAt"><span class="hs-identifier hs-type">HasCheckIssuedAt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340683"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-532"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#HasValidationSettings"><span class="hs-identifier hs-type">HasValidationSettings</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340683"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-533"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.Error.html#AsError"><span class="hs-identifier hs-type">AsError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340682"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#AsJWTError"><span class="hs-identifier hs-type">AsJWTError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340682"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="#local-6989586621679340682"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340684"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-534"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWK.Store.html#VerificationKeyStore"><span class="hs-identifier hs-type">VerificationKeyStore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340684"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#JWSHeader"><span class="hs-identifier hs-type">JWSHeader</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Crypto.JWT.html#ClaimsSet"><span class="hs-identifier hs-type">ClaimsSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340680"><span class="hs-identifier hs-type">k</span></a></span><span>
</span><span id="line-535"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-536"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679340683"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-537"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679340680"><span class="hs-identifier hs-type">k</span></a></span><span>
</span><span id="line-538"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.JWT.html#SignedJWT"><span class="hs-identifier hs-type">SignedJWT</span></a></span><span>
</span><span id="line-539"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679340684"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Crypto.JWT.html#ClaimsSet"><span class="hs-identifier hs-type">ClaimsSet</span></a></span></span></span></span></span><span>
</span><span id="line-540"></span><span id="verifyClaims"><span class="annot"><span class="annottext">verifyClaims :: a -&gt; k -&gt; SignedJWT -&gt; m ClaimsSet
</span><a href="Crypto.JWT.html#verifyClaims"><span class="hs-identifier hs-var hs-var">verifyClaims</span></a></span></span><span> </span><span id="local-6989586621679340236"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679340236"><span class="hs-identifier hs-var">conf</span></a></span></span><span> </span><span id="local-6989586621679340235"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679340235"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679340234"><span class="annot"><span class="annottext">SignedJWT
</span><a href="#local-6989586621679340234"><span class="hs-identifier hs-var">jws</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-541"></span><span>  </span><span class="hs-comment">-- It is important, for security reasons, that the signature get</span><span>
</span><span id="line-542"></span><span>  </span><span class="hs-comment">-- verified before the claims.</span><span>
</span><span id="line-543"></span><span>  </span><span class="annot"><span class="annottext">(ByteString -&gt; m ClaimsSet) -&gt; a -&gt; k -&gt; SignedJWT -&gt; m ClaimsSet
forall a e (m :: * -&gt; *) (h :: * -&gt; *) p payload k s (t :: * -&gt; *).
(HasAlgorithms a, HasValidationPolicy a, AsError e, MonadError e m,
 HasJWSHeader h, HasParams h,
 VerificationKeyStore m (h p) payload k, Cons s s Word8 Word8,
 AsEmpty s, Foldable t, ProtectionIndicator p) =&gt;
(s -&gt; m payload) -&gt; a -&gt; k -&gt; JWS t p h -&gt; m payload
</span><a href="Crypto.JOSE.JWS.html#verifyJWSWithPayload"><span class="hs-identifier hs-var">verifyJWSWithPayload</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; m ClaimsSet
</span><a href="#local-6989586621679340232"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679340236"><span class="hs-identifier hs-var">conf</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679340235"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">SignedJWT
</span><a href="#local-6989586621679340234"><span class="hs-identifier hs-var">jws</span></a></span><span> </span><span class="annot"><span class="annottext">m ClaimsSet -&gt; (ClaimsSet -&gt; m ClaimsSet) -&gt; m ClaimsSet
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; ClaimsSet -&gt; m ClaimsSet
forall (m :: * -&gt; *) a e.
(MonadTime m, HasAllowedSkew a, HasAudiencePredicate a,
 HasIssuerPredicate a, HasCheckIssuedAt a, AsJWTError e,
 MonadError e m) =&gt;
a -&gt; ClaimsSet -&gt; m ClaimsSet
</span><a href="Crypto.JWT.html#validateClaimsSet"><span class="hs-identifier hs-var">validateClaimsSet</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679340236"><span class="hs-identifier hs-var">conf</span></a></span><span>
</span><span id="line-544"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-545"></span><span>    </span><span id="local-6989586621679340232"><span class="annot"><span class="annottext">f :: ByteString -&gt; m ClaimsSet
</span><a href="#local-6989586621679340232"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; m ClaimsSet)
-&gt; (ClaimsSet -&gt; m ClaimsSet)
-&gt; Either String ClaimsSet
-&gt; m ClaimsSet
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AReview e String -&gt; String -&gt; m ClaimsSet
forall e (m :: * -&gt; *) t x.
MonadError e m =&gt;
AReview e t -&gt; t -&gt; m x
</span><span class="hs-identifier hs-var">throwing</span></span><span> </span><span class="annot"><span class="annottext">AReview e String
forall r. AsJWTError r =&gt; Prism' r String
</span><a href="Crypto.JWT.html#_JWTClaimsSetDecodeError"><span class="hs-identifier hs-var">_JWTClaimsSetDecodeError</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ClaimsSet -&gt; m ClaimsSet
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either String ClaimsSet -&gt; m ClaimsSet)
-&gt; (ByteString -&gt; Either String ClaimsSet)
-&gt; ByteString
-&gt; m ClaimsSet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Either String ClaimsSet
forall a. FromJSON a =&gt; ByteString -&gt; Either String a
</span><span class="hs-identifier hs-var">eitherDecode</span></span><span>
</span><span id="line-546"></span><span>
</span><span id="line-547"></span><span>
</span><span id="line-548"></span><span class="hs-comment">-- | Cryptographically verify a JWS JWT, then validate the</span><span>
</span><span id="line-549"></span><span class="hs-comment">-- Claims Set, returning it if valid.</span><span>
</span><span id="line-550"></span><span class="hs-comment">--</span><span>
</span><span id="line-551"></span><span class="hs-comment">-- This is the same as 'verifyClaims' except that the time is</span><span>
</span><span id="line-552"></span><span class="hs-comment">-- explicitly provided.  If you process many requests per second</span><span>
</span><span id="line-553"></span><span class="hs-comment">-- this will allow you to avoid unnecessary repeat system calls.</span><span>
</span><span id="line-554"></span><span class="hs-comment">--</span><span>
</span><span id="line-555"></span><span id="local-6989586621679340226"><span id="local-6989586621679340227"><span id="local-6989586621679340228"><span id="local-6989586621679340229"><span class="annot"><a href="Crypto.JWT.html#verifyClaimsAt"><span class="hs-identifier hs-type">verifyClaimsAt</span></a></span><span>
</span><span id="line-556"></span><span>  </span><span class="hs-glyph">::</span><span>
</span><span id="line-557"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Crypto.JWT.html#HasAllowedSkew"><span class="hs-identifier hs-type">HasAllowedSkew</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340229"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#HasAudiencePredicate"><span class="hs-identifier hs-type">HasAudiencePredicate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340229"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-558"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#HasIssuerPredicate"><span class="hs-identifier hs-type">HasIssuerPredicate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340229"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-559"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#HasCheckIssuedAt"><span class="hs-identifier hs-type">HasCheckIssuedAt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340229"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-560"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#HasValidationSettings"><span class="hs-identifier hs-type">HasValidationSettings</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340229"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-561"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.Error.html#AsError"><span class="hs-identifier hs-type">AsError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340228"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JWT.html#AsJWTError"><span class="hs-identifier hs-type">AsJWTError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340228"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="#local-6989586621679340228"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340227"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-562"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWK.Store.html#VerificationKeyStore"><span class="hs-identifier hs-type">VerificationKeyStore</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="Crypto.JWT.html#WrappedUTCTime"><span class="hs-identifier hs-type">WrappedUTCTime</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340227"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#JWSHeader"><span class="hs-identifier hs-type">JWSHeader</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Crypto.JWT.html#ClaimsSet"><span class="hs-identifier hs-type">ClaimsSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340226"><span class="hs-identifier hs-type">k</span></a></span><span>
</span><span id="line-563"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-564"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679340229"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-565"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679340226"><span class="hs-identifier hs-type">k</span></a></span><span>
</span><span id="line-566"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTCTime</span></span><span>
</span><span id="line-567"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.JWT.html#SignedJWT"><span class="hs-identifier hs-type">SignedJWT</span></a></span><span>
</span><span id="line-568"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679340227"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Crypto.JWT.html#ClaimsSet"><span class="hs-identifier hs-type">ClaimsSet</span></a></span></span></span></span></span><span>
</span><span id="line-569"></span><span id="verifyClaimsAt"><span class="annot"><span class="annottext">verifyClaimsAt :: a -&gt; k -&gt; UTCTime -&gt; SignedJWT -&gt; m ClaimsSet
</span><a href="Crypto.JWT.html#verifyClaimsAt"><span class="hs-identifier hs-var hs-var">verifyClaimsAt</span></a></span></span><span> </span><span id="local-6989586621679340225"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679340225"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679340224"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679340224"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679340223"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679340223"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679340222"><span class="annot"><span class="annottext">SignedJWT
</span><a href="#local-6989586621679340222"><span class="hs-identifier hs-var">jwt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT WrappedUTCTime m ClaimsSet -&gt; WrappedUTCTime -&gt; m ClaimsSet
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><span class="hs-identifier hs-var hs-var">runReaderT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; k -&gt; SignedJWT -&gt; ReaderT WrappedUTCTime m ClaimsSet
forall (m :: * -&gt; *) a e k.
(MonadTime m, HasAllowedSkew a, HasAudiencePredicate a,
 HasIssuerPredicate a, HasCheckIssuedAt a, HasValidationSettings a,
 AsError e, AsJWTError e, MonadError e m,
 VerificationKeyStore m (JWSHeader ()) ClaimsSet k) =&gt;
a -&gt; k -&gt; SignedJWT -&gt; m ClaimsSet
</span><a href="Crypto.JWT.html#verifyClaims"><span class="hs-identifier hs-var">verifyClaims</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679340225"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679340224"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">SignedJWT
</span><a href="#local-6989586621679340222"><span class="hs-identifier hs-var">jwt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UTCTime -&gt; WrappedUTCTime
</span><a href="Crypto.JWT.html#WrappedUTCTime"><span class="hs-identifier hs-var">WrappedUTCTime</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679340223"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-570"></span><span>
</span><span id="line-571"></span><span class="hs-comment">-- | Create a JWS JWT</span><span>
</span><span id="line-572"></span><span class="hs-comment">--</span><span>
</span><span id="line-573"></span><span id="local-6989586621679340220"><span id="local-6989586621679340221"><span class="annot"><a href="Crypto.JWT.html#signClaims"><span class="hs-identifier hs-type">signClaims</span></a></span><span>
</span><span id="line-574"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadRandom</span></span><span> </span><span class="annot"><a href="#local-6989586621679340221"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="#local-6989586621679340220"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340221"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.Error.html#AsError"><span class="hs-identifier hs-type">AsError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679340220"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-575"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWK.html#JWK"><span class="hs-identifier hs-type">JWK</span></a></span><span>
</span><span id="line-576"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#JWSHeader"><span class="hs-identifier hs-type">JWSHeader</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-577"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.JWT.html#ClaimsSet"><span class="hs-identifier hs-type">ClaimsSet</span></a></span><span>
</span><span id="line-578"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679340221"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Crypto.JWT.html#SignedJWT"><span class="hs-identifier hs-type">SignedJWT</span></a></span></span></span><span>
</span><span id="line-579"></span><span id="signClaims"><span class="annot"><span class="annottext">signClaims :: JWK -&gt; JWSHeader () -&gt; ClaimsSet -&gt; m SignedJWT
</span><a href="Crypto.JWT.html#signClaims"><span class="hs-identifier hs-var hs-var">signClaims</span></a></span></span><span> </span><span id="local-6989586621679340219"><span class="annot"><span class="annottext">JWK
</span><a href="#local-6989586621679340219"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679340218"><span class="annot"><span class="annottext">JWSHeader ()
</span><a href="#local-6989586621679340218"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679340217"><span class="annot"><span class="annottext">ClaimsSet
</span><a href="#local-6989586621679340217"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Identity (JWSHeader (), JWK) -&gt; m SignedJWT
forall s (a :: * -&gt; *) (m :: * -&gt; *) e (t :: * -&gt; *) p.
(Cons s s Word8 Word8, HasJWSHeader a, HasParams a, MonadRandom m,
 AsError e, MonadError e m, Traversable t, ProtectionIndicator p) =&gt;
s -&gt; t (a p, JWK) -&gt; m (JWS t p a)
</span><a href="Crypto.JOSE.JWS.html#signJWS"><span class="hs-identifier hs-var">signJWS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ClaimsSet -&gt; ByteString
forall a. ToJSON a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">encode</span></span><span> </span><span class="annot"><span class="annottext">ClaimsSet
</span><a href="#local-6989586621679340217"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(JWSHeader (), JWK) -&gt; Identity (JWSHeader (), JWK)
forall a. a -&gt; Identity a
</span><span class="hs-identifier hs-var">Identity</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">JWSHeader ()
</span><a href="#local-6989586621679340218"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">JWK
</span><a href="#local-6989586621679340219"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-580"></span></pre></body></html>