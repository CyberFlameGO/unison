<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE ConstraintKinds #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE TypeInType #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# OPTIONS_HADDOCK not-home #-}</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-comment">-- | Core optic types and subtyping machinery.</span><span>
</span><span id="line-10"></span><span class="hs-comment">--</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- This module contains the core 'Optic' types, and the underlying</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- machinery that we need in order to implement the subtyping between</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- various different flavours of optics.</span><span>
</span><span id="line-14"></span><span class="hs-comment">--</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- The composition operator for optics is also defined here.</span><span>
</span><span id="line-16"></span><span class="hs-comment">--</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- This module is intended for internal use only, and may change without</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- warning in subsequent releases.</span><span>
</span><span id="line-19"></span><span class="hs-comment">--</span><span>
</span><span id="line-20"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Optics.Internal.Optic</span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#Optic"><span class="hs-identifier">Optic</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#Optic%27"><span class="hs-identifier">Optic'</span></a></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#Optic_"><span class="hs-identifier">Optic_</span></a></span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#Optic__"><span class="hs-identifier">Optic__</span></a></span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#getOptic"><span class="hs-identifier">getOptic</span></a></span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#castOptic"><span class="hs-identifier">castOptic</span></a></span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#%25"><span class="hs-operator">(%)</span></a></span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#%25%25"><span class="hs-operator">(%%)</span></a></span><span>
</span><span id="line-29"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#%25%26"><span class="hs-operator">(%&amp;)</span></a></span><span>
</span><span id="line-30"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Labels</span></span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#LabelOptic"><span class="hs-identifier">LabelOptic</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#LabelOptic%27"><span class="hs-identifier">LabelOptic'</span></a></span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#GeneralLabelOptic"><span class="hs-identifier">GeneralLabelOptic</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Re-exports</span></span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.Subtyping.html"><span class="hs-identifier">Optics.Internal.Optic.Subtyping</span></a></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.Types.html"><span class="hs-identifier">Optics.Internal.Optic.Types</span></a></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.TypeLevel.html"><span class="hs-identifier">Optics.Internal.Optic.TypeLevel</span></a></span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Function</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&amp;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Proxy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Proxy</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Type.Equality</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Rep</span></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.OverloadedLabels</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.TypeLits</span></span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Profunctor.Indexed</span></span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.Subtyping.html"><span class="hs-identifier">Optics.Internal.Optic.Subtyping</span></a></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.TypeLevel.html"><span class="hs-identifier">Optics.Internal.Optic.TypeLevel</span></a></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.Types.html"><span class="hs-identifier">Optics.Internal.Optic.Types</span></a></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-comment">-- to make %% simpler</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unsafe.Coerce</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">unsafeCoerce</span></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-comment">-- | Wrapper newtype for the whole family of optics.</span><span>
</span><span id="line-58"></span><span class="hs-comment">--</span><span>
</span><span id="line-59"></span><span class="hs-comment">-- The first parameter @k@ identifies the particular optic kind (e.g. 'A_Lens'</span><span>
</span><span id="line-60"></span><span class="hs-comment">-- or 'A_Traversal').</span><span>
</span><span id="line-61"></span><span class="hs-comment">--</span><span>
</span><span id="line-62"></span><span class="hs-comment">-- The parameter @is@ is a list of types available as indices.  This will</span><span>
</span><span id="line-63"></span><span class="hs-comment">-- typically be 'NoIx' for unindexed optics, or 'WithIx' for optics with a</span><span>
</span><span id="line-64"></span><span class="hs-comment">-- single index. See the &quot;Indexed optics&quot; section of the overview documentation</span><span>
</span><span id="line-65"></span><span class="hs-comment">-- in the @Optics@ module of the main @optics@ package for more details.</span><span>
</span><span id="line-66"></span><span class="hs-comment">--</span><span>
</span><span id="line-67"></span><span class="hs-comment">-- The parameters @s@ and @t@ represent the &quot;big&quot; structure,</span><span>
</span><span id="line-68"></span><span class="hs-comment">-- whereas @a@ and @b@ represent the &quot;small&quot; structure.</span><span>
</span><span id="line-69"></span><span class="hs-comment">--</span><span>
</span><span id="line-70"></span><span class="hs-keyword">newtype</span><span> </span><span id="Optic"><span class="annot"><a href="Optics.Internal.Optic.html#Optic"><span class="hs-identifier hs-var">Optic</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679102084"><span class="annot"><a href="#local-6989586621679102084"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.Types.html#OpticKind"><span class="hs-identifier hs-type">OpticKind</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679102083"><span class="annot"><a href="#local-6989586621679102083"><span class="hs-identifier hs-type">is</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.TypeLevel.html#IxList"><span class="hs-identifier hs-type">IxList</span></a></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679102082"><span class="annot"><a href="#local-6989586621679102082"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679102081"><span class="annot"><a href="#local-6989586621679102081"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621679102080"><span class="annot"><a href="#local-6989586621679102080"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679102079"><span class="annot"><a href="#local-6989586621679102079"><span class="hs-identifier hs-type">b</span></a></span></span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Optic"><span class="annot"><a href="Optics.Internal.Optic.html#Optic"><span class="hs-identifier hs-var">Optic</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679102096"><span class="annot"><a href="#local-6989586621679102096"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span id="local-6989586621679102094"><span class="annot"><a href="#local-6989586621679102094"><span class="hs-identifier hs-type">i</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Profunctor</span></span><span> </span><span class="annot"><a href="#local-6989586621679102096"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#Optic_"><span class="hs-identifier hs-type">Optic_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102084"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102096"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102094"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Optics.Internal.Optic.TypeLevel.html#Curry"><span class="hs-identifier hs-type">Curry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102083"><span class="hs-identifier hs-type">is</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102094"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102082"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102081"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102080"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102079"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="hs-comment">-- | Strip the newtype wrapper off.</span><span>
</span><span id="line-74"></span><span id="local-6989586621679101920"><span id="local-6989586621679101921"><span id="local-6989586621679101922"><span id="local-6989586621679101923"><span id="local-6989586621679101924"><span id="local-6989586621679101925"><span id="local-6989586621679101926"><span id="local-6989586621679101927"><span class="annot"><a href="Optics.Internal.Optic.html#getOptic"><span class="hs-identifier hs-type">getOptic</span></a></span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Profunctor</span></span><span> </span><span class="annot"><a href="#local-6989586621679101927"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#Optic"><span class="hs-identifier hs-type">Optic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101926"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101925"><span class="hs-identifier hs-type">is</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101924"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101923"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101922"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101921"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#Optic_"><span class="hs-identifier hs-type">Optic_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101926"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101927"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101920"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Optics.Internal.Optic.TypeLevel.html#Curry"><span class="hs-identifier hs-type">Curry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101925"><span class="hs-identifier hs-type">is</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101920"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679101924"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101923"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101922"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101921"><span class="hs-identifier hs-type">b</span></a></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-78"></span><span class="hs-comment">-- Note: This is not part of the definition of 'Optic' because it needs to be</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- marked INLINE for GHC to optimize away profunctor classes when profiling.</span><span>
</span><span id="line-80"></span><span class="hs-comment">-- See https://github.com/well-typed/optics/issues/324 for more details.</span><span>
</span><span id="line-81"></span><span id="getOptic"><span class="annot"><span class="annottext">getOptic :: Optic k is s t a b -&gt; Optic_ k p i (Curry is i) s t a b
</span><a href="Optics.Internal.Optic.html#getOptic"><span class="hs-identifier hs-var hs-var">getOptic</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Optics.Internal.Optic.html#Optic"><span class="hs-identifier hs-type">Optic</span></a></span><span> </span><span id="local-6989586621679101919"><span class="annot"><span class="annottext">forall (p :: * -&gt; * -&gt; * -&gt; *) i.
Profunctor p =&gt;
Optic_ k p i (Curry is i) s t a b
</span><a href="#local-6989586621679101919"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Optic__ p i (Curry is i) s t a b
forall (p :: * -&gt; * -&gt; * -&gt; *) i.
Profunctor p =&gt;
Optic_ k p i (Curry is i) s t a b
</span><a href="#local-6989586621679101919"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-82"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#getOptic"><span class="hs-pragma hs-type">getOptic</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-comment">-- | Common special case of 'Optic' where source and target types are equal.</span><span>
</span><span id="line-85"></span><span class="hs-comment">--</span><span>
</span><span id="line-86"></span><span class="hs-comment">-- Here, we need only one &quot;big&quot; and one &quot;small&quot; type. For lenses, this</span><span>
</span><span id="line-87"></span><span class="hs-comment">-- means that in the restricted form we cannot do type-changing updates.</span><span>
</span><span id="line-88"></span><span class="hs-comment">--</span><span>
</span><span id="line-89"></span><span class="hs-keyword">type</span><span> </span><span id="Optic%27"><span class="annot"><a href="Optics.Internal.Optic.html#Optic%27"><span class="hs-identifier hs-var">Optic'</span></a></span></span><span> </span><span id="local-6989586621679101918"><span class="annot"><a href="#local-6989586621679101918"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679101917"><span class="annot"><a href="#local-6989586621679101917"><span class="hs-identifier hs-type">is</span></a></span></span><span> </span><span id="local-6989586621679101916"><span class="annot"><a href="#local-6989586621679101916"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679101915"><span class="annot"><a href="#local-6989586621679101915"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#Optic"><span class="hs-identifier hs-type">Optic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101918"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101917"><span class="hs-identifier hs-type">is</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101916"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101916"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101915"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101915"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-comment">-- | Type representing the various kinds of optics.</span><span>
</span><span id="line-92"></span><span class="hs-comment">--</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- The tag parameter @k@ is translated into constraints on @p@</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- via the type family 'Constraints'.</span><span>
</span><span id="line-95"></span><span class="hs-comment">--</span><span>
</span><span id="line-96"></span><span class="hs-keyword">type</span><span> </span><span id="Optic_"><span class="annot"><a href="Optics.Internal.Optic.html#Optic_"><span class="hs-identifier hs-var">Optic_</span></a></span></span><span> </span><span id="local-6989586621679101914"><span class="annot"><a href="#local-6989586621679101914"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679101913"><span class="annot"><a href="#local-6989586621679101913"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span id="local-6989586621679101912"><span class="annot"><a href="#local-6989586621679101912"><span class="hs-identifier hs-type">i</span></a></span></span><span> </span><span id="local-6989586621679101911"><span class="annot"><a href="#local-6989586621679101911"><span class="hs-identifier hs-type">j</span></a></span></span><span> </span><span id="local-6989586621679101910"><span class="annot"><a href="#local-6989586621679101910"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679101909"><span class="annot"><a href="#local-6989586621679101909"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621679101908"><span class="annot"><a href="#local-6989586621679101908"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679101907"><span class="annot"><a href="#local-6989586621679101907"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.Types.html#Constraints"><span class="hs-identifier hs-type">Constraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101914"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101913"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#Optic__"><span class="hs-identifier hs-type">Optic__</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101913"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101912"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101911"><span class="hs-identifier hs-type">j</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101910"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101909"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101908"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101907"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="hs-comment">-- | Optic internally as a profunctor transformation.</span><span>
</span><span id="line-99"></span><span class="hs-keyword">type</span><span> </span><span id="Optic__"><span class="annot"><a href="Optics.Internal.Optic.html#Optic__"><span class="hs-identifier hs-var">Optic__</span></a></span></span><span> </span><span id="local-6989586621679101906"><span class="annot"><a href="#local-6989586621679101906"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span id="local-6989586621679101905"><span class="annot"><a href="#local-6989586621679101905"><span class="hs-identifier hs-type">i</span></a></span></span><span> </span><span id="local-6989586621679101904"><span class="annot"><a href="#local-6989586621679101904"><span class="hs-identifier hs-type">j</span></a></span></span><span> </span><span id="local-6989586621679101903"><span class="annot"><a href="#local-6989586621679101903"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679101902"><span class="annot"><a href="#local-6989586621679101902"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621679101901"><span class="annot"><a href="#local-6989586621679101901"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679101900"><span class="annot"><a href="#local-6989586621679101900"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679101906"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101905"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101901"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101900"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679101906"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101904"><span class="hs-identifier hs-type">j</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101903"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101902"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="hs-comment">-- | Explicit cast from one optic flavour to another.</span><span>
</span><span id="line-102"></span><span class="hs-comment">--</span><span>
</span><span id="line-103"></span><span class="hs-comment">-- The resulting optic kind is given in the first type argument, so you can use</span><span>
</span><span id="line-104"></span><span class="hs-comment">-- TypeApplications to set it. For example</span><span>
</span><span id="line-105"></span><span class="hs-comment">--</span><span>
</span><span id="line-106"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-107"></span><span class="hs-comment">--  'castOptic' @'A_Lens' o</span><span>
</span><span id="line-108"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-109"></span><span class="hs-comment">--</span><span>
</span><span id="line-110"></span><span class="hs-comment">-- turns @o@ into a 'Optics.Lens.Lens'.</span><span>
</span><span id="line-111"></span><span class="hs-comment">--</span><span>
</span><span id="line-112"></span><span class="hs-comment">-- This is the identity function, modulo some constraint jiggery-pokery.</span><span>
</span><span id="line-113"></span><span class="hs-comment">--</span><span>
</span><span id="line-114"></span><span class="annot"><a href="Optics.Internal.Optic.html#castOptic"><span class="hs-identifier hs-type">castOptic</span></a></span><span>
</span><span id="line-115"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679102053"><span class="annot"><a href="#local-6989586621679102053"><span class="hs-identifier hs-type">destKind</span></a></span></span><span> </span><span id="local-6989586621679102054"><span class="annot"><a href="#local-6989586621679102054"><span class="hs-identifier hs-type">srcKind</span></a></span></span><span> </span><span id="local-6989586621679102052"><span class="annot"><a href="#local-6989586621679102052"><span class="hs-identifier hs-type">is</span></a></span></span><span> </span><span id="local-6989586621679102051"><span class="annot"><a href="#local-6989586621679102051"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679102050"><span class="annot"><a href="#local-6989586621679102050"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621679102049"><span class="annot"><a href="#local-6989586621679102049"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679102048"><span class="annot"><a href="#local-6989586621679102048"><span class="hs-identifier hs-type">b</span></a></span></span><span>
</span><span id="line-116"></span><span>  </span><span class="hs-operator">.</span><span>  </span><span class="annot"><a href="Optics.Internal.Optic.Subtyping.html#Is"><span class="hs-identifier hs-type">Is</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102054"><span class="hs-identifier hs-type">srcKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102053"><span class="hs-identifier hs-type">destKind</span></a></span><span>
</span><span id="line-117"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#Optic"><span class="hs-identifier hs-type">Optic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102054"><span class="hs-identifier hs-type">srcKind</span></a></span><span>  </span><span class="annot"><a href="#local-6989586621679102052"><span class="hs-identifier hs-type">is</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102051"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102050"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102049"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102048"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#Optic"><span class="hs-identifier hs-type">Optic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102053"><span class="hs-identifier hs-type">destKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102052"><span class="hs-identifier hs-type">is</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102051"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102050"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102049"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102048"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-119"></span><span id="castOptic"><span class="annot"><span class="annottext">castOptic :: Optic srcKind is s t a b -&gt; Optic destKind is s t a b
</span><a href="Optics.Internal.Optic.html#castOptic"><span class="hs-identifier hs-var hs-var">castOptic</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Optics.Internal.Optic.html#Optic"><span class="hs-identifier hs-type">Optic</span></a></span><span> </span><span id="local-6989586621679101899"><span class="annot"><span class="annottext">forall (p :: * -&gt; * -&gt; * -&gt; *) i.
Profunctor p =&gt;
Optic_ srcKind p i (Curry is i) s t a b
</span><a href="#local-6989586621679101899"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall (p :: * -&gt; * -&gt; * -&gt; *) i.
 Profunctor p =&gt;
 Optic_ destKind p i (Curry is i) s t a b)
-&gt; Optic destKind is s t a b
forall k (is :: IxList) s t a b.
(forall (p :: * -&gt; * -&gt; * -&gt; *) i.
 Profunctor p =&gt;
 Optic_ k p i (Curry is i) s t a b)
-&gt; Optic k is s t a b
</span><a href="Optics.Internal.Optic.html#Optic"><span class="hs-identifier hs-var">Optic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Optic_ srcKind p i (Curry is i) s t a b
-&gt; Optic_ destKind p i (Curry is i) s t a b
forall (p :: * -&gt; * -&gt; * -&gt; *) i.
Optic_ srcKind p i (Curry is i) s t a b
-&gt; Optic_ destKind p i (Curry is i) s t a b
</span><a href="#local-6989586621679101898"><span class="hs-identifier hs-var">cast</span></a></span><span> </span><span class="annot"><span class="annottext">Optic_ srcKind p i (Curry is i) s t a b
forall (p :: * -&gt; * -&gt; * -&gt; *) i.
Profunctor p =&gt;
Optic_ srcKind p i (Curry is i) s t a b
</span><a href="#local-6989586621679101899"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-121"></span><span>    </span><span class="annot"><a href="#local-6989586621679101898"><span class="hs-identifier hs-type">cast</span></a></span><span>
</span><span id="line-122"></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679102076"><span class="annot"><a href="#local-6989586621679102076"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span id="local-6989586621679102075"><span class="annot"><a href="#local-6989586621679102075"><span class="hs-identifier hs-type">i</span></a></span></span><span>
</span><span id="line-123"></span><span>      </span><span class="hs-operator">.</span><span>  </span><span class="annot"><a href="Optics.Internal.Optic.html#Optic_"><span class="hs-identifier hs-type">Optic_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102054"><span class="hs-identifier hs-type">srcKind</span></a></span><span>  </span><span class="annot"><a href="#local-6989586621679102076"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102075"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Optics.Internal.Optic.TypeLevel.html#Curry"><span class="hs-identifier hs-type">Curry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102052"><span class="hs-identifier hs-type">is</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102075"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102051"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102050"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102049"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102048"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-124"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#Optic_"><span class="hs-identifier hs-type">Optic_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102053"><span class="hs-identifier hs-type">destKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102076"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102075"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Optics.Internal.Optic.TypeLevel.html#Curry"><span class="hs-identifier hs-type">Curry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102052"><span class="hs-identifier hs-type">is</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102075"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102051"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102050"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102049"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102048"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-125"></span><span>    </span><span id="local-6989586621679101898"><span class="annot"><span class="annottext">cast :: Optic_ srcKind p i (Curry is i) s t a b
-&gt; Optic_ destKind p i (Curry is i) s t a b
</span><a href="#local-6989586621679101898"><span class="hs-identifier hs-var hs-var">cast</span></a></span></span><span> </span><span id="local-6989586621679101897"><span class="annot"><span class="annottext">Optic_ srcKind p i (Curry is i) s t a b
</span><a href="#local-6989586621679101897"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Optic_ srcKind p i (Curry is i) s t a b
-&gt; Optic_ destKind p i (Curry is i) s t a b
forall k l (p :: * -&gt; * -&gt; * -&gt; *) r.
Is k l =&gt;
(Constraints k p =&gt; r) -&gt; Constraints l p =&gt; r
</span><a href="Optics.Internal.Optic.Subtyping.html#implies"><span class="hs-identifier hs-var">implies</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679102054"><span class="hs-identifier hs-type">srcKind</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679102053"><span class="hs-identifier hs-type">destKind</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679102076"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="annottext">Optic_ srcKind p i (Curry is i) s t a b
</span><a href="#local-6989586621679101897"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-126"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#castOptic"><span class="hs-pragma hs-type">castOptic</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span class="hs-comment">-- | Compose two optics of compatible flavours.</span><span>
</span><span id="line-129"></span><span class="hs-comment">--</span><span>
</span><span id="line-130"></span><span class="hs-comment">-- Returns an optic of the appropriate supertype.  If either or both optics are</span><span>
</span><span id="line-131"></span><span class="hs-comment">-- indexed, the composition preserves all the indices.</span><span>
</span><span id="line-132"></span><span class="hs-comment">--</span><span>
</span><span id="line-133"></span><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">9</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#%25"><span class="hs-operator hs-type">%</span></a></span><span>
</span><span id="line-134"></span><span id="local-6989586621679101884"><span id="local-6989586621679101885"><span id="local-6989586621679101886"><span id="local-6989586621679101887"><span id="local-6989586621679101888"><span id="local-6989586621679101889"><span id="local-6989586621679101890"><span id="local-6989586621679101891"><span id="local-6989586621679101892"><span id="local-6989586621679101893"><span id="local-6989586621679101894"><span id="local-6989586621679101895"><span class="annot"><a href="Optics.Internal.Optic.html#%25"><span class="hs-operator hs-type">(%)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Optics.Internal.Optic.Subtyping.html#Is"><span class="hs-identifier hs-type">Is</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101895"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101894"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.Subtyping.html#Is"><span class="hs-identifier hs-type">Is</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101893"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101894"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679101894"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Optics.Internal.Optic.Subtyping.html#Join"><span class="hs-identifier hs-type">Join</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101895"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101893"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679101892"><span class="hs-identifier hs-type">ks</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Optics.Internal.Optic.TypeLevel.html#Append"><span class="hs-identifier hs-type">Append</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101891"><span class="hs-identifier hs-type">is</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101890"><span class="hs-identifier hs-type">js</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#Optic"><span class="hs-identifier hs-type">Optic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101895"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101891"><span class="hs-identifier hs-type">is</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101889"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101888"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101887"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101886"><span class="hs-identifier hs-type">v</span></a></span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#Optic"><span class="hs-identifier hs-type">Optic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101893"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101890"><span class="hs-identifier hs-type">js</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101887"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101886"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101885"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101884"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-137"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#Optic"><span class="hs-identifier hs-type">Optic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101894"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101892"><span class="hs-identifier hs-type">ks</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101889"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101888"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101885"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101884"><span class="hs-identifier hs-type">b</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-138"></span><span id="local-6989586621679101882"><span class="annot"><span class="annottext">Optic k is s t u v
</span><a href="#local-6989586621679101882"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="%25"><span class="annot"><span class="annottext">% :: Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><a href="Optics.Internal.Optic.html#%25"><span class="hs-operator hs-var hs-var">%</span></a></span></span><span> </span><span id="local-6989586621679101881"><span class="annot"><span class="annottext">Optic l js u v a b
</span><a href="#local-6989586621679101881"><span class="hs-identifier hs-var">o'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Optic k is s t u v -&gt; Optic m is s t u v
forall destKind srcKind (is :: IxList) s t a b.
Is srcKind destKind =&gt;
Optic srcKind is s t a b -&gt; Optic destKind is s t a b
</span><a href="Optics.Internal.Optic.html#castOptic"><span class="hs-identifier hs-var">castOptic</span></a></span><span> </span><span class="annot"><span class="annottext">Optic k is s t u v
</span><a href="#local-6989586621679101882"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Optic m is s t u v -&gt; Optic m js u v a b -&gt; Optic m ks s t a b
forall k (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a b.
(ks ~ Append is js) =&gt;
Optic k is s t u v -&gt; Optic k js u v a b -&gt; Optic k ks s t a b
</span><a href="Optics.Internal.Optic.html#%25%25"><span class="hs-operator hs-var">%%</span></a></span><span> </span><span class="annot"><span class="annottext">Optic l js u v a b -&gt; Optic m js u v a b
forall destKind srcKind (is :: IxList) s t a b.
Is srcKind destKind =&gt;
Optic srcKind is s t a b -&gt; Optic destKind is s t a b
</span><a href="Optics.Internal.Optic.html#castOptic"><span class="hs-identifier hs-var">castOptic</span></a></span><span> </span><span class="annot"><span class="annottext">Optic l js u v a b
</span><a href="#local-6989586621679101881"><span class="hs-identifier hs-var">o'</span></a></span><span>
</span><span id="line-139"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">%</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="hs-comment">-- | Compose two optics of the same flavour.</span><span>
</span><span id="line-142"></span><span class="hs-comment">--</span><span>
</span><span id="line-143"></span><span class="hs-comment">-- Normally you can simply use ('%') instead, but this may be useful to help</span><span>
</span><span id="line-144"></span><span class="hs-comment">-- type inference if the type of one of the optics is otherwise</span><span>
</span><span id="line-145"></span><span class="hs-comment">-- under-constrained.</span><span>
</span><span id="line-146"></span><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">9</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#%25%25"><span class="hs-operator hs-type">%%</span></a></span><span>
</span><span id="line-147"></span><span class="annot"><a href="Optics.Internal.Optic.html#%25%25"><span class="hs-operator hs-type">(%%)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679102043"><span class="annot"><a href="#local-6989586621679102043"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679102046"><span class="annot"><a href="#local-6989586621679102046"><span class="hs-identifier hs-type">is</span></a></span></span><span> </span><span id="local-6989586621679102045"><span class="annot"><a href="#local-6989586621679102045"><span class="hs-identifier hs-type">js</span></a></span></span><span> </span><span id="local-6989586621679102047"><span class="annot"><a href="#local-6989586621679102047"><span class="hs-identifier hs-type">ks</span></a></span></span><span> </span><span id="local-6989586621679102042"><span class="annot"><a href="#local-6989586621679102042"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679102041"><span class="annot"><a href="#local-6989586621679102041"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621679102040"><span class="annot"><a href="#local-6989586621679102040"><span class="hs-identifier hs-type">u</span></a></span></span><span> </span><span id="local-6989586621679102039"><span class="annot"><a href="#local-6989586621679102039"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621679102038"><span class="annot"><a href="#local-6989586621679102038"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679102037"><span class="annot"><a href="#local-6989586621679102037"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679102047"><span class="hs-identifier hs-type">ks</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Optics.Internal.Optic.TypeLevel.html#Append"><span class="hs-identifier hs-type">Append</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102046"><span class="hs-identifier hs-type">is</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102045"><span class="hs-identifier hs-type">js</span></a></span><span>
</span><span id="line-148"></span><span>     </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#Optic"><span class="hs-identifier hs-type">Optic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102043"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102046"><span class="hs-identifier hs-type">is</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102042"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102041"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102040"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102039"><span class="hs-identifier hs-type">v</span></a></span><span>
</span><span id="line-149"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#Optic"><span class="hs-identifier hs-type">Optic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102043"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102045"><span class="hs-identifier hs-type">js</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102040"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102039"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102038"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102037"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-150"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#Optic"><span class="hs-identifier hs-type">Optic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102043"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102047"><span class="hs-identifier hs-type">ks</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102042"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102041"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102038"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102037"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-151"></span><span class="annot"><a href="Optics.Internal.Optic.html#Optic"><span class="hs-identifier hs-type">Optic</span></a></span><span> </span><span id="local-6989586621679101880"><span class="annot"><span class="annottext">forall (p :: * -&gt; * -&gt; * -&gt; *) i.
Profunctor p =&gt;
Optic_ k p i (Curry is i) s t u v
</span><a href="#local-6989586621679101880"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="%25%25"><span class="annot"><span class="annottext">%% :: Optic k is s t u v -&gt; Optic k js u v a b -&gt; Optic k ks s t a b
</span><a href="Optics.Internal.Optic.html#%25%25"><span class="hs-operator hs-var hs-var">%%</span></a></span></span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#Optic"><span class="hs-identifier hs-type">Optic</span></a></span><span> </span><span id="local-6989586621679101879"><span class="annot"><span class="annottext">forall (p :: * -&gt; * -&gt; * -&gt; *) i.
Profunctor p =&gt;
Optic_ k p i (Curry js i) u v a b
</span><a href="#local-6989586621679101879"><span class="hs-identifier hs-var">o'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall (p :: * -&gt; * -&gt; * -&gt; *) i.
 Profunctor p =&gt;
 Optic_ k p i (Curry ks i) s t a b)
-&gt; Optic k ks s t a b
forall k (is :: IxList) s t a b.
(forall (p :: * -&gt; * -&gt; * -&gt; *) i.
 Profunctor p =&gt;
 Optic_ k p i (Curry is i) s t a b)
-&gt; Optic k is s t a b
</span><a href="Optics.Internal.Optic.html#Optic"><span class="hs-identifier hs-var">Optic</span></a></span><span> </span><span class="annot"><span class="annottext">forall (p :: * -&gt; * -&gt; * -&gt; *) i.
Profunctor p =&gt;
Optic_ k p i (Curry ks i) s t a b
</span><a href="#local-6989586621679101878"><span class="hs-identifier hs-var">oo</span></a></span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-153"></span><span>    </span><span class="hs-comment">-- unsafeCoerce to the rescue, for a proof see below.</span><span>
</span><span id="line-154"></span><span>    </span><span class="annot"><a href="#local-6989586621679101878"><span class="hs-identifier hs-type">oo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679101877"><span class="annot"><a href="#local-6989586621679101877"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span id="local-6989586621679101876"><span class="annot"><a href="#local-6989586621679101876"><span class="hs-identifier hs-type">i</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Profunctor</span></span><span> </span><span class="annot"><a href="#local-6989586621679101877"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.Types.html#Constraints"><span class="hs-identifier hs-type">Constraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102043"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101877"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#Optic__"><span class="hs-identifier hs-type">Optic__</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101877"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101876"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Optics.Internal.Optic.TypeLevel.html#Curry"><span class="hs-identifier hs-type">Curry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102047"><span class="hs-identifier hs-type">ks</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101876"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102042"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102041"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102038"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102037"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-155"></span><span>    </span><span id="local-6989586621679101878"><span class="annot"><span class="annottext">oo :: Optic__ p i (Curry ks i) s t a b
</span><a href="#local-6989586621679101878"><span class="hs-identifier hs-var hs-var">oo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Optic__ p i (Curry is (Curry js i)) s t a b
-&gt; Optic__ p i (Curry ks i) s t a b
forall a b. a -&gt; b
</span><span class="hs-identifier hs-var">unsafeCoerce</span></span><span>
</span><span id="line-156"></span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#Optic__"><span class="hs-identifier hs-type">Optic__</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101877"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101876"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Optics.Internal.Optic.TypeLevel.html#Curry"><span class="hs-identifier hs-type">Curry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102046"><span class="hs-identifier hs-type">is</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Optics.Internal.Optic.TypeLevel.html#Curry"><span class="hs-identifier hs-type">Curry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102045"><span class="hs-identifier hs-type">js</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101876"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102042"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102041"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102038"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102037"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-157"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#Optic__"><span class="hs-identifier hs-type">Optic__</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101877"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101876"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Optics.Internal.Optic.TypeLevel.html#Curry"><span class="hs-identifier hs-type">Curry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102047"><span class="hs-identifier hs-type">ks</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101876"><span class="hs-identifier hs-type">i</span></a></span><span>           </span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102042"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102041"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102038"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102037"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Optic__ p (Curry js i) (Curry is (Curry js i)) s t u v
forall (p :: * -&gt; * -&gt; * -&gt; *) i.
Profunctor p =&gt;
Optic_ k p i (Curry is i) s t u v
</span><a href="#local-6989586621679101880"><span class="hs-identifier hs-var">o</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#Optic__"><span class="hs-identifier hs-type">Optic__</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101877"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Optics.Internal.Optic.TypeLevel.html#Curry"><span class="hs-identifier hs-type">Curry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102045"><span class="hs-identifier hs-type">js</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101876"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Optics.Internal.Optic.TypeLevel.html#Curry"><span class="hs-identifier hs-type">Curry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102046"><span class="hs-identifier hs-type">is</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Optics.Internal.Optic.TypeLevel.html#Curry"><span class="hs-identifier hs-type">Curry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102045"><span class="hs-identifier hs-type">js</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101876"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102042"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102041"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102040"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102039"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>      </span><span class="annot"><span class="annottext">Optic__ p (Curry js i) (Curry is (Curry js i)) s t u v
-&gt; (p i a b -&gt; p (Curry js i) u v)
-&gt; Optic__ p i (Curry is (Curry js i)) s t a b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">p i a b -&gt; p (Curry js i) u v
forall (p :: * -&gt; * -&gt; * -&gt; *) i.
Profunctor p =&gt;
Optic_ k p i (Curry js i) u v a b
</span><a href="#local-6989586621679101879"><span class="hs-identifier hs-var">o'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#Optic__"><span class="hs-identifier hs-type">Optic__</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101877"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101876"><span class="hs-identifier hs-type">i</span></a></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="Optics.Internal.Optic.TypeLevel.html#Curry"><span class="hs-identifier hs-type">Curry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102045"><span class="hs-identifier hs-type">js</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101876"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span>            </span><span class="annot"><a href="#local-6989586621679102040"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102039"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102038"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102037"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">%%</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="hs-comment">-- | Flipped function application, specialised to optics and binding tightly.</span><span>
</span><span id="line-164"></span><span class="hs-comment">--</span><span>
</span><span id="line-165"></span><span class="hs-comment">-- Useful for post-composing optics transformations:</span><span>
</span><span id="line-166"></span><span class="hs-comment">--</span><span>
</span><span id="line-167"></span><span class="hs-comment">-- &gt;&gt;&gt; toListOf (ifolded %&amp; ifiltered (\i s -&gt; length s &lt;= i)) [&quot;&quot;, &quot;a&quot;,&quot;abc&quot;]</span><span>
</span><span id="line-168"></span><span class="hs-comment">-- [&quot;&quot;,&quot;a&quot;]</span><span>
</span><span id="line-169"></span><span class="hs-comment">--</span><span>
</span><span id="line-170"></span><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">9</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#%25%26"><span class="hs-operator hs-type">%&amp;</span></a></span><span>
</span><span id="line-171"></span><span id="local-6989586621679101863"><span id="local-6989586621679101864"><span id="local-6989586621679101865"><span id="local-6989586621679101866"><span id="local-6989586621679101867"><span id="local-6989586621679101868"><span id="local-6989586621679101869"><span id="local-6989586621679101870"><span id="local-6989586621679101871"><span id="local-6989586621679101872"><span id="local-6989586621679101873"><span id="local-6989586621679101874"><span class="annot"><a href="Optics.Internal.Optic.html#%25%26"><span class="hs-operator hs-type">(%&amp;)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#Optic"><span class="hs-identifier hs-type">Optic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101874"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101873"><span class="hs-identifier hs-type">is</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101872"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101871"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101870"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101869"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-172"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Optics.Internal.Optic.html#Optic"><span class="hs-identifier hs-type">Optic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101874"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101873"><span class="hs-identifier hs-type">is</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101872"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101871"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101870"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101869"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#Optic"><span class="hs-identifier hs-type">Optic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101868"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101867"><span class="hs-identifier hs-type">js</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101866"><span class="hs-identifier hs-type">s'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101865"><span class="hs-identifier hs-type">t'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101864"><span class="hs-identifier hs-type">a'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101863"><span class="hs-identifier hs-type">b'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#Optic"><span class="hs-identifier hs-type">Optic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101868"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101867"><span class="hs-identifier hs-type">js</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101866"><span class="hs-identifier hs-type">s'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101865"><span class="hs-identifier hs-type">t'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101864"><span class="hs-identifier hs-type">a'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101863"><span class="hs-identifier hs-type">b'</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-174"></span><span id="%25%26"><span class="annot"><span class="annottext">%&amp; :: Optic k is s t a b
-&gt; (Optic k is s t a b -&gt; Optic l js s' t' a' b')
-&gt; Optic l js s' t' a' b'
</span><a href="Optics.Internal.Optic.html#%25%26"><span class="hs-operator hs-var hs-var">(%&amp;)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Optic k is s t a b
-&gt; (Optic k is s t a b -&gt; Optic l js s' t' a' b')
-&gt; Optic l js s' t' a' b'
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">(&amp;)</span></span><span>
</span><span id="line-175"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">%&amp;</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-179"></span><span class="hs-comment">--</span><span>
</span><span id="line-180"></span><span class="hs-comment">-- 'AppendProof' is a very simple class which provides a witness</span><span>
</span><span id="line-181"></span><span class="hs-comment">--</span><span>
</span><span id="line-182"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-183"></span><span class="hs-comment">-- foldr f (foldr f init xs) ys = foldr f init (ys ++ xs)</span><span>
</span><span id="line-184"></span><span class="hs-comment">--    where f = (-&gt;)</span><span>
</span><span id="line-185"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-186"></span><span class="hs-comment">--</span><span>
</span><span id="line-187"></span><span class="hs-comment">-- It shows that usage of 'unsafeCoerce' in '(%%)' is, in fact, safe.</span><span>
</span><span id="line-188"></span><span class="hs-comment">--</span><span>
</span><span id="line-189"></span><span class="hs-keyword">class</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.TypeLevel.html#Append"><span class="hs-identifier hs-type">Append</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101999"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101998"><span class="hs-identifier hs-type">ys</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="#local-6989586621679101997"><span class="hs-identifier hs-type">zs</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="AppendProof"><span class="annot"><a href="Optics.Internal.Optic.html#AppendProof"><span class="hs-identifier hs-var">AppendProof</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679101999"><span class="annot"><a href="#local-6989586621679101999"><span class="hs-identifier hs-type">xs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679101998"><span class="annot"><a href="#local-6989586621679101998"><span class="hs-identifier hs-type">ys</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679101997"><span class="annot"><a href="#local-6989586621679101997"><span class="hs-identifier hs-type">zs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621679101999"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101998"><span class="hs-identifier hs-type">ys</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679101997"><span class="hs-identifier hs-type">zs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679101997"><span class="hs-identifier hs-type">zs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101999"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679101998"><span class="hs-identifier hs-type">ys</span></a></span><span> </span><span class="hs-comment">{- , zs ys -&gt; xs -}</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-191"></span><span>  </span><span id="local-6989586621679102003"><span id="appendProof"><span class="annot"><a href="Optics.Internal.Optic.html#appendProof"><span class="hs-identifier hs-type">appendProof</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679102003"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.TypeLevel.html#Curry"><span class="hs-identifier hs-type">Curry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101999"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Optics.Internal.Optic.TypeLevel.html#Curry"><span class="hs-identifier hs-type">Curry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101998"><span class="hs-identifier hs-type">ys</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102003"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">:~:</span></span><span> </span><span class="annot"><a href="Optics.Internal.Optic.TypeLevel.html#Curry"><span class="hs-identifier hs-type">Curry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101997"><span class="hs-identifier hs-type">zs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102003"><span class="hs-identifier hs-type">i</span></a></span></span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span id="local-6989586621679101860"><span id="local-6989586621679101861"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="#local-6989586621679101861"><span class="hs-identifier hs-type">ys</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="#local-6989586621679101860"><span class="hs-identifier hs-type">zs</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#AppendProof"><span class="hs-identifier hs-type">AppendProof</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679101861"><span class="hs-identifier hs-type">ys</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101860"><span class="hs-identifier hs-type">zs</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-194"></span><span>  </span><span id="local-6989586621679101856"><span class="annot"><span class="annottext">appendProof :: Proxy i -&gt; Curry '[] (Curry ys i) :~: Curry zs i
</span><a href="#local-6989586621679101856"><span class="hs-identifier hs-var hs-var hs-var hs-var">appendProof</span></a></span></span><span> </span><span class="annot"><span class="annottext">Proxy i
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Curry '[] (Curry ys i) :~: Curry zs i
forall k (a :: k). a :~: a
</span><span class="hs-identifier hs-var">Refl</span></span></span></span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span id="local-6989586621679101851"><span id="local-6989586621679101852"><span id="local-6989586621679101853"><span id="local-6989586621679101854"><span class="hs-keyword">instance</span><span>
</span><span id="line-197"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Optics.Internal.Optic.TypeLevel.html#Append"><span class="hs-identifier hs-type">Append</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679101854"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621679101853"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679101852"><span class="hs-identifier hs-type">ys</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679101854"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621679101851"><span class="hs-identifier hs-type">zs</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#AppendProof"><span class="hs-identifier hs-type">AppendProof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101853"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101852"><span class="hs-identifier hs-type">ys</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101851"><span class="hs-identifier hs-type">zs</span></a></span><span>
</span><span id="line-198"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#AppendProof"><span class="hs-identifier hs-type">AppendProof</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679101854"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679101853"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679101852"><span class="hs-identifier hs-type">ys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679101854"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679101851"><span class="hs-identifier hs-type">zs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-199"></span><span>  </span><span class="annot"><a href="Optics.Internal.Optic.html#appendProof"><span class="hs-identifier hs-type">appendProof</span></a></span><span>
</span><span id="line-200"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679101848"><span class="annot"><a href="#local-6989586621679101848"><span class="hs-identifier hs-type">i</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679101848"><span class="hs-identifier hs-type">i</span></a></span><span>
</span><span id="line-201"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.TypeLevel.html#Curry"><span class="hs-identifier hs-type">Curry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679101854"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679101853"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Optics.Internal.Optic.TypeLevel.html#Curry"><span class="hs-identifier hs-type">Curry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101852"><span class="hs-identifier hs-type">ys</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101848"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">:~:</span></span><span> </span><span class="annot"><a href="Optics.Internal.Optic.TypeLevel.html#Curry"><span class="hs-identifier hs-type">Curry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679101854"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679101851"><span class="hs-identifier hs-type">zs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679101848"><span class="hs-identifier hs-type">i</span></a></span><span>
</span><span id="line-202"></span><span>  </span><span id="local-6989586621679101847"><span class="annot"><span class="annottext">appendProof :: Proxy i -&gt; Curry (x : xs) (Curry ys i) :~: Curry (x : zs) i
</span><a href="#local-6989586621679101847"><span class="hs-identifier hs-var hs-var hs-var hs-var">appendProof</span></a></span></span><span> </span><span id="local-6989586621679101846"><span class="annot"><span class="annottext">Proxy i
</span><a href="#local-6989586621679101846"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Proxy i -&gt; Curry xs (Curry ys i) :~: Curry zs i
forall (xs :: IxList) (ys :: IxList) (zs :: IxList) i.
AppendProof xs ys zs =&gt;
Proxy i -&gt; Curry xs (Curry ys i) :~: Curry zs i
</span><a href="Optics.Internal.Optic.html#appendProof"><span class="hs-identifier hs-var">appendProof</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679101853"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679101852"><span class="hs-identifier hs-type">ys</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679101851"><span class="hs-identifier hs-type">zs</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy i
</span><a href="#local-6989586621679101846"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-203"></span><span>    </span><span class="annot"><span class="annottext">Curry xs (Curry ys i) :~: Curry zs i
</span><span class="hs-identifier hs-var">Refl</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Curry (x : xs) (Curry ys i) :~: Curry (x : zs) i
forall k (a :: k). a :~: a
</span><span class="hs-identifier hs-var">Refl</span></span></span></span></span></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span class="hs-comment">----------------------------------------</span><span>
</span><span id="line-206"></span><span class="hs-comment">-- Labels</span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span class="hs-comment">-- | Support for overloaded labels as optics. An overloaded label @#foo@ can be</span><span>
</span><span id="line-209"></span><span class="hs-comment">-- used as an optic if there is an instance of @'LabelOptic' &quot;foo&quot; k s t a b@.</span><span>
</span><span id="line-210"></span><span class="hs-keyword">class</span><span> </span><span id="LabelOptic"><span class="annot"><a href="Optics.Internal.Optic.html#LabelOptic"><span class="hs-identifier hs-var">LabelOptic</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679101976"><span class="annot"><a href="#local-6989586621679101976"><span class="hs-identifier hs-type">name</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679101981"><span class="annot"><a href="#local-6989586621679101981"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679101980"><span class="annot"><a href="#local-6989586621679101980"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679101979"><span class="annot"><a href="#local-6989586621679101979"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621679101978"><span class="annot"><a href="#local-6989586621679101978"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679101977"><span class="annot"><a href="#local-6989586621679101977"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621679101976"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101980"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679101981"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101978"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-211"></span><span>                                            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679101976"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101979"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679101981"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101977"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-212"></span><span>                                            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679101976"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101980"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101977"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679101979"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-213"></span><span>                                            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679101976"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101979"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101978"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679101980"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-214"></span><span>  </span><span class="hs-comment">-- | Used to interpret overloaded label syntax.  An overloaded label @#foo@</span><span>
</span><span id="line-215"></span><span>  </span><span class="hs-comment">-- corresponds to @'labelOptic' \@&quot;foo&quot;@.</span><span>
</span><span id="line-216"></span><span>  </span><span id="labelOptic"><span class="annot"><a href="Optics.Internal.Optic.html#labelOptic"><span class="hs-identifier hs-type">labelOptic</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#Optic"><span class="hs-identifier hs-type">Optic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101981"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="Optics.Internal.Optic.TypeLevel.html#NoIx"><span class="hs-identifier hs-type">NoIx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101980"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101979"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101978"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101977"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span class="hs-comment">-- | Type synonym for a type-preserving optic as overloaded label.</span><span>
</span><span id="line-219"></span><span class="hs-keyword">type</span><span> </span><span id="LabelOptic%27"><span class="annot"><a href="Optics.Internal.Optic.html#LabelOptic%27"><span class="hs-identifier hs-var">LabelOptic'</span></a></span></span><span> </span><span id="local-6989586621679101843"><span class="annot"><a href="#local-6989586621679101843"><span class="hs-identifier hs-type">name</span></a></span></span><span> </span><span id="local-6989586621679101842"><span class="annot"><a href="#local-6989586621679101842"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679101841"><span class="annot"><a href="#local-6989586621679101841"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679101840"><span class="annot"><a href="#local-6989586621679101840"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#LabelOptic"><span class="hs-identifier hs-type">LabelOptic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101843"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101842"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101841"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101841"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101840"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101840"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span class="hs-comment">-- | Implements fallback behaviour in case there is no explicit 'LabelOptic'</span><span>
</span><span id="line-222"></span><span class="hs-comment">-- instance. This has a catch-all incoherent instance that merely yields an</span><span>
</span><span id="line-223"></span><span class="hs-comment">-- error message.  However, a downstream module can give a more specific</span><span>
</span><span id="line-224"></span><span class="hs-comment">-- instance that uses 'Generic' to construct an optic automatically.</span><span>
</span><span id="line-225"></span><span class="hs-comment">--</span><span>
</span><span id="line-226"></span><span class="hs-comment">-- To support this, the last parameter will be instantiated to 'RepDefined' if</span><span>
</span><span id="line-227"></span><span class="hs-comment">-- at least one of @s@ or @t@ has a 'Generic' instance.</span><span>
</span><span id="line-228"></span><span class="hs-keyword">class</span><span> </span><span id="GeneralLabelOptic"><span class="annot"><a href="Optics.Internal.Optic.html#GeneralLabelOptic"><span class="hs-identifier hs-var">GeneralLabelOptic</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679101965"><span class="annot"><a href="#local-6989586621679101965"><span class="hs-identifier hs-type">name</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679101964"><span class="annot"><a href="#local-6989586621679101964"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679101963"><span class="annot"><a href="#local-6989586621679101963"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679101962"><span class="annot"><a href="#local-6989586621679101962"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621679101961"><span class="annot"><a href="#local-6989586621679101961"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679101960"><span class="annot"><a href="#local-6989586621679101960"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679101959"><span class="annot"><a href="#local-6989586621679101959"><span class="hs-identifier hs-type">repDefined</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.TypeLevel.html#RepDefined"><span class="hs-identifier hs-type">RepDefined</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-229"></span><span>  </span><span class="hs-comment">-- | Used to interpret overloaded label syntax in the absence of an explicit</span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-comment">-- 'LabelOptic' instance.</span><span>
</span><span id="line-231"></span><span>  </span><span id="generalLabelOptic"><span class="annot"><a href="Optics.Internal.Optic.html#generalLabelOptic"><span class="hs-identifier hs-type">generalLabelOptic</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#Optic"><span class="hs-identifier hs-type">Optic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101964"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="Optics.Internal.Optic.TypeLevel.html#NoIx"><span class="hs-identifier hs-type">NoIx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101963"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101962"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101961"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101960"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span class="hs-keyword">data</span><span> </span><span id="Void0"><span class="annot"><a href="Optics.Internal.Optic.html#Void0"><span class="hs-identifier hs-var">Void0</span></a></span></span><span>
</span><span id="line-234"></span><span class="hs-comment">-- | If for an overloaded label @#label@ there is no instance starting with</span><span>
</span><span id="line-235"></span><span class="hs-comment">-- @LabelOptic &quot;label&quot;@, using it in the context of optics makes GHC immediately</span><span>
</span><span id="line-236"></span><span class="hs-comment">-- pick the overlappable instance defined below (since no other instance could</span><span>
</span><span id="line-237"></span><span class="hs-comment">-- match). If at this point GHC has no information about @s@ or @t@, it ends up</span><span>
</span><span id="line-238"></span><span class="hs-comment">-- picking incoherent instance of GeneralLabelOptic defined below. Prevent that</span><span>
</span><span id="line-239"></span><span class="hs-comment">-- (if only to be able to inspect most polymorphic types of @#foo % #bar@ or</span><span>
</span><span id="line-240"></span><span class="hs-comment">-- @view #foo@ in GHCi) by defining a dummy instance that matches all names,</span><span>
</span><span id="line-241"></span><span class="hs-comment">-- thus postponing instance resolution.</span><span>
</span><span id="line-242"></span><span id="local-6989586621679101835"><span id="local-6989586621679101836"><span id="local-6989586621679101837"><span id="local-6989586621679101838"><span class="hs-keyword">instance</span><span>
</span><span id="line-243"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="#local-6989586621679101838"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Optics.Internal.Optic.Types.html#An_Iso"><span class="hs-identifier hs-type">An_Iso</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679101837"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#Void0"><span class="hs-identifier hs-type">Void0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679101836"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#Void0"><span class="hs-identifier hs-type">Void0</span></a></span><span>
</span><span id="line-244"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#LabelOptic"><span class="hs-identifier hs-type">LabelOptic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101835"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101838"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#Void0"><span class="hs-identifier hs-type">Void0</span></a></span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#Void0"><span class="hs-identifier hs-type">Void0</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101837"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101836"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-245"></span><span>  </span><span id="local-6989586621679101832"><span class="annot"><span class="annottext">labelOptic :: Optic k '[] Void0 Void0 a b
</span><a href="#local-6989586621679101832"><span class="hs-identifier hs-var hs-var hs-var hs-var">labelOptic</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall (p :: * -&gt; * -&gt; * -&gt; *) i.
 Profunctor p =&gt;
 Optic_ k p i (Curry '[] i) Void0 Void0 a b)
-&gt; Optic k '[] Void0 Void0 a b
forall k (is :: IxList) s t a b.
(forall (p :: * -&gt; * -&gt; * -&gt; *) i.
 Profunctor p =&gt;
 Optic_ k p i (Curry is i) s t a b)
-&gt; Optic k is s t a b
</span><a href="Optics.Internal.Optic.html#Optic"><span class="hs-identifier hs-var">Optic</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
forall (p :: * -&gt; * -&gt; * -&gt; *) i.
Profunctor p =&gt;
Optic_ k p i (Curry '[] i) Void0 Void0 a b
</span><span class="hs-identifier hs-var">id</span></span></span></span></span></span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span class="hs-comment">-- | If no instance matches, fall back on 'GeneralLabelOptic'.</span><span>
</span><span id="line-248"></span><span id="local-6989586621679101825"><span id="local-6989586621679101826"><span id="local-6989586621679101827"><span id="local-6989586621679101828"><span id="local-6989586621679101829"><span id="local-6989586621679101830"><span class="hs-keyword">instance</span><span> </span><span class="hs-pragma">{-# OVERLAPPABLE</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-249"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#LabelOptic"><span class="hs-identifier hs-type">LabelOptic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101830"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101829"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101828"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101827"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101826"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101825"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-comment">-- Needed to satisfy functional dependencies</span><span>
</span><span id="line-250"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#GeneralLabelOptic"><span class="hs-identifier hs-type">GeneralLabelOptic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101830"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101829"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101828"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101827"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101826"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101825"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Optics.Internal.Optic.TypeLevel.html#AnyHasRep"><span class="hs-identifier hs-type">AnyHasRep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Rep</span></span><span> </span><span class="annot"><a href="#local-6989586621679101828"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Rep</span></span><span> </span><span class="annot"><a href="#local-6989586621679101827"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#LabelOptic"><span class="hs-identifier hs-type">LabelOptic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101830"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101829"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101828"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101827"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101826"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101825"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-252"></span><span>  </span><span id="local-6989586621679101823"><span class="annot"><span class="annottext">labelOptic :: Optic k '[] s t a b
</span><a href="#local-6989586621679101823"><span class="hs-identifier hs-var hs-var hs-var hs-var">labelOptic</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GeneralLabelOptic name k s t a b (AnyHasRep (Rep s) (Rep t)) =&gt;
Optic k '[] s t a b
forall (name :: Symbol) k s t a b (repDefined :: RepDefined).
GeneralLabelOptic name k s t a b repDefined =&gt;
Optic k '[] s t a b
</span><a href="Optics.Internal.Optic.html#generalLabelOptic"><span class="hs-identifier hs-var">generalLabelOptic</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679101830"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679101829"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679101828"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679101827"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679101826"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679101825"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Optics.Internal.Optic.TypeLevel.html#AnyHasRep"><span class="hs-identifier hs-type">AnyHasRep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Rep</span></span><span> </span><span class="annot"><a href="#local-6989586621679101828"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Rep</span></span><span> </span><span class="annot"><a href="#local-6989586621679101827"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="hs-comment">-- | If no instance matches, GHC tends to bury error messages &quot;No instance for</span><span>
</span><span id="line-255"></span><span class="hs-comment">-- LabelOptic...&quot; within a ton of other error messages about ambiguous type</span><span>
</span><span id="line-256"></span><span class="hs-comment">-- variables and overlapping instances which are irrelevant and confusing. Use</span><span>
</span><span id="line-257"></span><span class="hs-comment">-- incoherent instance providing a custom type error to cut its efforts short.</span><span>
</span><span id="line-258"></span><span id="local-6989586621679101816"><span id="local-6989586621679101817"><span id="local-6989586621679101818"><span id="local-6989586621679101819"><span id="local-6989586621679101820"><span id="local-6989586621679101821"><span id="local-6989586621679101822"><span class="hs-keyword">instance</span><span> </span><span class="hs-pragma">{-# INCOHERENT</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-259"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">TypeError</span></span><span>
</span><span id="line-260"></span><span>   </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="hs-string">&quot;No instance for LabelOptic &quot;</span></span><span> </span><span class="hs-special">'</span><span class="hs-operator">:&lt;&gt;:</span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">ShowType</span></span><span> </span><span class="annot"><a href="#local-6989586621679101822"><span class="hs-identifier hs-type">name</span></a></span><span>
</span><span id="line-261"></span><span>    </span><span class="hs-special">'</span><span class="hs-operator">:&lt;&gt;:</span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="hs-special">'</span><span class="hs-operator">:&lt;&gt;:</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.TypeLevel.html#QuoteType"><span class="hs-identifier hs-type">QuoteType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101821"><span class="hs-identifier hs-type">k</span></a></span><span>
</span><span id="line-262"></span><span>    </span><span class="hs-special">'</span><span class="hs-operator">:&lt;&gt;:</span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="hs-special">'</span><span class="hs-operator">:&lt;&gt;:</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.TypeLevel.html#QuoteType"><span class="hs-identifier hs-type">QuoteType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101820"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-263"></span><span>    </span><span class="hs-special">'</span><span class="hs-operator">:&lt;&gt;:</span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="hs-special">'</span><span class="hs-operator">:&lt;&gt;:</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.TypeLevel.html#QuoteType"><span class="hs-identifier hs-type">QuoteType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101819"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-264"></span><span>    </span><span class="hs-special">'</span><span class="hs-operator">:&lt;&gt;:</span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="hs-special">'</span><span class="hs-operator">:&lt;&gt;:</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.TypeLevel.html#QuoteType"><span class="hs-identifier hs-type">QuoteType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101818"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-265"></span><span>    </span><span class="hs-special">'</span><span class="hs-operator">:&lt;&gt;:</span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="hs-special">'</span><span class="hs-operator">:&lt;&gt;:</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.TypeLevel.html#QuoteType"><span class="hs-identifier hs-type">QuoteType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101817"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-266"></span><span>    </span><span class="hs-special">'</span><span class="hs-operator">:$$:</span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Perhaps you forgot to define it or misspelled its name?&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-267"></span><span>   </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Optics.Internal.Optic.html#GeneralLabelOptic"><span class="hs-identifier hs-type">GeneralLabelOptic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101822"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101821"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101820"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101819"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101818"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101817"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101816"><span class="hs-identifier hs-type">repDefined</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-268"></span><span>  </span><span id="local-6989586621679101813"><span class="annot"><span class="annottext">generalLabelOptic :: Optic k '[] s t a b
</span><a href="#local-6989586621679101813"><span class="hs-identifier hs-var hs-var hs-var hs-var">generalLabelOptic</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Optic k '[] s t a b
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;unreachable&quot;</span></span></span></span></span></span></span></span></span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span id="local-6989586621679101805"><span id="local-6989586621679101806"><span id="local-6989586621679101807"><span id="local-6989586621679101808"><span id="local-6989586621679101809"><span id="local-6989586621679101810"><span id="local-6989586621679101811"><span class="hs-keyword">instance</span><span>
</span><span id="line-271"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Optics.Internal.Optic.html#LabelOptic"><span class="hs-identifier hs-type">LabelOptic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101811"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101810"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101809"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101808"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101807"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101806"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679101805"><span class="hs-identifier hs-type">is</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Optics.Internal.Optic.TypeLevel.html#NoIx"><span class="hs-identifier hs-type">NoIx</span></a></span><span>
</span><span id="line-272"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsLabel</span></span><span> </span><span class="annot"><a href="#local-6989586621679101811"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Optics.Internal.Optic.html#Optic"><span class="hs-identifier hs-type">Optic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101810"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101805"><span class="hs-identifier hs-type">is</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101809"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101808"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101807"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101806"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 802
</span><span>  </span><span id="local-6989586621679101802"><span class="annot"><span class="annottext">fromLabel :: Optic k is s t a b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fromLabel</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LabelOptic name k s t a b =&gt; Optic k '[] s t a b
forall (name :: Symbol) k s t a b.
LabelOptic name k s t a b =&gt;
Optic k '[] s t a b
</span><a href="Optics.Internal.Optic.html#labelOptic"><span class="hs-identifier hs-var">labelOptic</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679101811"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679101810"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679101809"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679101808"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679101807"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679101806"><span class="hs-identifier hs-type">b</span></a></span></span></span></span></span></span></span></span><span class="hs-cpp">
#else
</span><span>  </span><span class="hs-identifier">fromLabel</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">labelOptic</span><span> </span><span class="hs-glyph">@</span><span class="hs-identifier">name</span><span> </span><span class="hs-glyph">@</span><span class="hs-identifier">k</span><span> </span><span class="hs-glyph">@</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">@</span><span class="hs-identifier">t</span><span> </span><span class="hs-glyph">@</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">@</span><span class="hs-identifier">b</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-279"></span><span class="hs-comment">-- $setup</span><span>
</span><span id="line-280"></span><span class="hs-comment">-- &gt;&gt;&gt; import Optics.Core</span><span>
</span><span id="line-281"></span></pre></body></html>