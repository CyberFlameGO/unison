<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell #-}</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Unison.Codebase.Editor.Command</span><span>
</span><span id="line-6"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Command"><span class="hs-identifier">Command</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-7"></span><span>    </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Env"><span class="hs-identifier">Env</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-8"></span><span>    </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#LoopState"><span class="hs-identifier">LoopState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>    </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#AmbientAbilities"><span class="hs-identifier">AmbientAbilities</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>    </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#LexedSource"><span class="hs-identifier">LexedSource</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Source"><span class="hs-identifier">Source</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>    </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#SourceName"><span class="hs-identifier">SourceName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#TypecheckingResult"><span class="hs-identifier">TypecheckingResult</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#LoadSourceResult"><span class="hs-identifier">LoadSourceResult</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#UseCache"><span class="hs-identifier">UseCache</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#EvalResult"><span class="hs-identifier">EvalResult</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#commandName"><span class="hs-identifier">commandName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#lookupEvalResult"><span class="hs-identifier">lookupEvalResult</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#abort"><span class="hs-identifier">abort</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#quit"><span class="hs-identifier">quit</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#with"><span class="hs-identifier">with</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#reset"><span class="hs-identifier">reset</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#root"><span class="hs-identifier">root</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#numberedArgs"><span class="hs-identifier">numberedArgs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#currentPathStack"><span class="hs-identifier">currentPathStack</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#lastInput"><span class="hs-identifier">lastInput</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#lastSavedRoot"><span class="hs-identifier">lastSavedRoot</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#latestFile"><span class="hs-identifier">latestFile</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#latestTypecheckedFile"><span class="hs-identifier">latestTypecheckedFile</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#currentPath"><span class="hs-identifier">currentPath</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#loopState0"><span class="hs-identifier">loopState0</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>    </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#respond"><span class="hs-identifier">respond</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#respondNumbered"><span class="hs-identifier">respondNumbered</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>    </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#askCodebase"><span class="hs-identifier">askCodebase</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#askGenerateUniqueName"><span class="hs-identifier">askGenerateUniqueName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#askLoadSource"><span class="hs-identifier">askLoadSource</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#askRuntime"><span class="hs-identifier">askRuntime</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#askSandboxedRuntime"><span class="hs-identifier">askSandboxedRuntime</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#askServerBaseUrl"><span class="hs-identifier">askServerBaseUrl</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>    </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#getConfig"><span class="hs-identifier">getConfig</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#InputDescription"><span class="hs-identifier">InputDescription</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>    </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Action"><span class="hs-identifier">Action</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>    </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#eval"><span class="hs-identifier">eval</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">where</span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Getter</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">makeLenses</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">to</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">view</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(.=)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">_5</span></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-comment">-- TODO: Don't import backend, but move dependencies to own modules</span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Reader</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadReader</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">asks</span></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadState</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Configurator</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Configurator</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Configurator.Types</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Configurator</span></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Nel</span></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Unison.Auth.CredentialManager.html"><span class="hs-identifier">Unison.Auth.CredentialManager</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.Auth.CredentialManager.html#CredentialManager"><span class="hs-identifier">CredentialManager</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Unison.Auth.HTTPClient.html"><span class="hs-identifier">Unison.Auth.HTTPClient</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.Auth.HTTPClient.html#AuthenticatedHttpClient"><span class="hs-identifier">AuthenticatedHttpClient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Codebase</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Codebase</span></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Codebase.Branch</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Branch</span></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Input.html"><span class="hs-identifier">Unison.Codebase.Editor.Input</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.Codebase.Editor.Input.html#Input"><span class="hs-identifier">Input</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Output.html"><span class="hs-identifier">Unison.Codebase.Editor.Output</span></a></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.UCMVersion.html"><span class="hs-identifier">Unison.Codebase.Editor.UCMVersion</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.Codebase.Editor.UCMVersion.html#UCMVersion"><span class="hs-identifier">UCMVersion</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Codebase.Path</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Path</span></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Codebase.Runtime</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Runtime</span></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Codebase.Runtime</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Runtime</span></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Lexer</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L</span></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Names</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Names</span></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Parser</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Parser</span></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Parser.Ann</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Ann</span></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Prelude</span></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Reference</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Reference</span></span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Result</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Note</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Result</span></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Server.CodebaseServer</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Server</span></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Symbol</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Symbol</span></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Term</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Term</span></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Type</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Unison.UnisonFile</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">UF</span></span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Util.Free</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Free</span></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Util.Free</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Free</span></span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Unison.WatchKind</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">WK</span></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="hs-keyword">type</span><span> </span><span id="AmbientAbilities"><span class="annot"><a href="Unison.Codebase.Editor.Command.html#AmbientAbilities"><span class="hs-identifier hs-var">AmbientAbilities</span></a></span></span><span> </span><span id="local-6989586621680023160"><span class="annot"><a href="#local-6989586621680023160"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="annot"><a href="#local-6989586621680023160"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ann</span></span><span class="hs-special">]</span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="hs-keyword">type</span><span> </span><span id="SourceName"><span class="annot"><a href="Unison.Codebase.Editor.Command.html#SourceName"><span class="hs-identifier hs-var">SourceName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-keyword">type</span><span> </span><span id="Source"><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Source"><span class="hs-identifier hs-var">Source</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="hs-keyword">type</span><span> </span><span id="LexedSource"><span class="annot"><a href="Unison.Codebase.Editor.Command.html#LexedSource"><span class="hs-identifier hs-var">LexedSource</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">L.Token</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">L.Lexeme</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-keyword">data</span><span> </span><span id="LoadSourceResult"><span class="annot"><a href="Unison.Codebase.Editor.Command.html#LoadSourceResult"><span class="hs-identifier hs-var">LoadSourceResult</span></a></span></span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="InvalidSourceNameError"><span class="annot"><a href="Unison.Codebase.Editor.Command.html#InvalidSourceNameError"><span class="hs-identifier hs-var">InvalidSourceNameError</span></a></span></span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="LoadError"><span class="annot"><a href="Unison.Codebase.Editor.Command.html#LoadError"><span class="hs-identifier hs-var">LoadError</span></a></span></span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="LoadSuccess"><span class="annot"><a href="Unison.Codebase.Editor.Command.html#LoadSuccess"><span class="hs-identifier hs-var">LoadSuccess</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="hs-keyword">type</span><span> </span><span id="TypecheckingResult"><span class="annot"><a href="Unison.Codebase.Editor.Command.html#TypecheckingResult"><span class="hs-identifier hs-var">TypecheckingResult</span></a></span></span><span> </span><span id="local-6989586621680023153"><span class="annot"><a href="#local-6989586621680023153"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-97"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Result</span></span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Note</span></span><span> </span><span class="annot"><a href="#local-6989586621680023153"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ann</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Names</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UF.TypecheckedUnisonFile</span></span><span> </span><span class="annot"><a href="#local-6989586621680023153"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ann</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="hs-keyword">data</span><span> </span><span id="Command"><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Command"><span class="hs-identifier hs-var">Command</span></a></span></span><span> </span><span id="local-6989586621680023151"><span class="annot"><a href="#local-6989586621680023151"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-102"></span><span>  </span><span id="AskEnv"><span class="annot"><a href="Unison.Codebase.Editor.Command.html#AskEnv"><span class="hs-identifier hs-var">AskEnv</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Command"><span class="hs-identifier hs-type">Command</span></a></span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span>
</span><span id="line-103"></span><span>  </span><span id="local-6989586621680023262"><span id="LocalEnv"><span class="annot"><a href="Unison.Codebase.Editor.Command.html#LocalEnv"><span class="hs-identifier hs-var">LocalEnv</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Free</span></span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Command"><span class="hs-identifier hs-type">Command</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680023262"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Command"><span class="hs-identifier hs-type">Command</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680023262"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-104"></span><span>  </span><span id="GetLoopState"><span class="annot"><a href="Unison.Codebase.Editor.Command.html#GetLoopState"><span class="hs-identifier hs-var">GetLoopState</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Command"><span class="hs-identifier hs-type">Command</span></a></span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#LoopState"><span class="hs-identifier hs-type">LoopState</span></a></span><span>
</span><span id="line-105"></span><span>  </span><span id="PutLoopState"><span class="annot"><a href="Unison.Codebase.Editor.Command.html#PutLoopState"><span class="hs-identifier hs-var">PutLoopState</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#LoopState"><span class="hs-identifier hs-type">LoopState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Command"><span class="hs-identifier hs-type">Command</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>  </span><span id="local-6989586621680023359"><span id="Eval"><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Eval"><span class="hs-identifier hs-var">Eval</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621680023359"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Command"><span class="hs-identifier hs-type">Command</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680023359"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-107"></span><span>  </span><span class="hs-comment">-- IsDerivedTerm :: H.Hash -&gt; Command m i v Bool</span><span>
</span><span id="line-108"></span><span>  </span><span class="hs-comment">-- IsDerivedType :: H.Hash -&gt; Command m i v Bool</span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span>  </span><span id="local-6989586621680023251"><span id="WithRunInIO"><span class="annot"><a href="Unison.Codebase.Editor.Command.html#WithRunInIO"><span class="hs-identifier hs-var">WithRunInIO</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680023144"><span class="annot"><a href="#local-6989586621680023144"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680023144"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621680023144"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621680023251"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Command"><span class="hs-identifier hs-type">Command</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680023251"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-111"></span><span>  </span><span id="local-6989586621680023244"><span id="WithResource"><span class="annot"><a href="Unison.Codebase.Editor.Command.html#WithResource"><span class="hs-identifier hs-var">WithResource</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680023243"><span class="annot"><a href="#local-6989586621680023243"><span class="hs-identifier hs-type">r</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680023244"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621680023243"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621680023243"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Command"><span class="hs-identifier hs-type">Command</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680023244"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-112"></span><span>  </span><span id="local-6989586621680023241"><span id="Reset"><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Reset"><span class="hs-identifier hs-var">Reset</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680023241"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Command"><span class="hs-identifier hs-type">Command</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680023241"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-113"></span><span>  </span><span id="local-6989586621680023249"><span id="Abort"><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Abort"><span class="hs-identifier hs-var">Abort</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Command"><span class="hs-identifier hs-type">Command</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680023249"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-114"></span><span>  </span><span id="local-6989586621680023140"><span id="Quit"><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Quit"><span class="hs-identifier hs-var">Quit</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Command"><span class="hs-identifier hs-type">Command</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680023140"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Free</span></span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Command"><span class="hs-identifier hs-type">Command</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-117"></span><span>  </span><span id="local-6989586621680023135"><span class="annot"><span class="annottext">liftIO :: IO a -&gt; Free Command a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">liftIO</span></span></span><span> </span><span id="local-6989586621680023133"><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621680023133"><span class="hs-identifier hs-var">io</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Command a -&gt; Free Command a
forall (f :: * -&gt; *) a. f a -&gt; Free f a
</span><span class="hs-identifier hs-var">Free.eval</span></span><span> </span><span class="annot"><span class="annottext">(Command a -&gt; Free Command a) -&gt; Command a -&gt; Free Command a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IO a -&gt; Command a
forall a. IO a -&gt; Command a
</span><a href="Unison.Codebase.Editor.Command.html#Eval"><span class="hs-identifier hs-var">Eval</span></a></span><span> </span><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621680023133"><span class="hs-identifier hs-var">io</span></a></span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span class="hs-keyword">type</span><span> </span><span id="UseCache"><span class="annot"><a href="Unison.Codebase.Editor.Command.html#UseCache"><span class="hs-identifier hs-var">UseCache</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span class="hs-keyword">type</span><span> </span><span id="EvalResult"><span class="annot"><a href="Unison.Codebase.Editor.Command.html#EvalResult"><span class="hs-identifier hs-var">EvalResult</span></a></span></span><span> </span><span id="local-6989586621680023131"><span class="annot"><a href="#local-6989586621680023131"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-122"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680023131"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621680023131"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-123"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621680023131"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ann</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WK.WatchKind</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reference.Id</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621680023131"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621680023131"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Runtime.IsCacheHit</span></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span id="local-6989586621680023130"><span class="annot"><a href="Unison.Codebase.Editor.Command.html#lookupEvalResult"><span class="hs-identifier hs-type">lookupEvalResult</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680023130"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680023130"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#EvalResult"><span class="hs-identifier hs-type">EvalResult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680023130"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621680023130"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-127"></span><span id="lookupEvalResult"><span class="annot"><span class="annottext">lookupEvalResult :: v -&gt; EvalResult v -&gt; Maybe (Term v ())
</span><a href="Unison.Codebase.Editor.Command.html#lookupEvalResult"><span class="hs-identifier hs-var hs-var">lookupEvalResult</span></a></span></span><span> </span><span id="local-6989586621680023129"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680023129"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(v, Term v ())]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680023128"><span class="annot"><span class="annottext">Map v (Ann, WatchKind, Id, Term v (), Term v (), IsCacheHit)
</span><a href="#local-6989586621680023128"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Getting
  (Term v ())
  (Ann, WatchKind, Id, Term v (), Term v (), IsCacheHit)
  (Term v ())
-&gt; (Ann, WatchKind, Id, Term v (), Term v (), IsCacheHit)
-&gt; Term v ()
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (Term v ())
  (Ann, WatchKind, Id, Term v (), Term v (), IsCacheHit)
  (Term v ())
forall s t a b. Field5 s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">_5</span></span><span> </span><span class="annot"><span class="annottext">((Ann, WatchKind, Id, Term v (), Term v (), IsCacheHit)
 -&gt; Term v ())
-&gt; Maybe (Ann, WatchKind, Id, Term v (), Term v (), IsCacheHit)
-&gt; Maybe (Term v ())
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">v
-&gt; Map v (Ann, WatchKind, Id, Term v (), Term v (), IsCacheHit)
-&gt; Maybe (Ann, WatchKind, Id, Term v (), Term v (), IsCacheHit)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680023129"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Map v (Ann, WatchKind, Id, Term v (), Term v (), IsCacheHit)
</span><a href="#local-6989586621680023128"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span id="local-6989586621680023125"><span class="annot"><a href="Unison.Codebase.Editor.Command.html#commandName"><span class="hs-identifier hs-type">commandName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Command"><span class="hs-identifier hs-type">Command</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680023125"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span></span><span>
</span><span id="line-130"></span><span id="commandName"><span class="annot"><span class="annottext">commandName :: Command a -&gt; WatchKind
</span><a href="Unison.Codebase.Editor.Command.html#commandName"><span class="hs-identifier hs-var hs-var">commandName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-131"></span><span>  </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#WithResource"><span class="hs-identifier hs-type">WithResource</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WatchKind
</span><span class="hs-string">&quot;WithResource&quot;</span></span><span>
</span><span id="line-132"></span><span>  </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Reset"><span class="hs-identifier hs-type">Reset</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WatchKind
</span><span class="hs-string">&quot;Reset&quot;</span></span><span>
</span><span id="line-133"></span><span>  </span><span class="annot"><span class="annottext">Command a
</span><a href="Unison.Codebase.Editor.Command.html#AskEnv"><span class="hs-identifier hs-var">AskEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WatchKind
</span><span class="hs-string">&quot;AskEnv&quot;</span></span><span>
</span><span id="line-134"></span><span>  </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#LocalEnv"><span class="hs-identifier hs-type">LocalEnv</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WatchKind
</span><span class="hs-string">&quot;LocalEnv&quot;</span></span><span>
</span><span id="line-135"></span><span>  </span><span class="annot"><span class="annottext">Command a
</span><a href="Unison.Codebase.Editor.Command.html#GetLoopState"><span class="hs-identifier hs-var">GetLoopState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WatchKind
</span><span class="hs-string">&quot;GetLoopState&quot;</span></span><span>
</span><span id="line-136"></span><span>  </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#PutLoopState"><span class="hs-identifier hs-type">PutLoopState</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WatchKind
</span><span class="hs-string">&quot;PutLoopState&quot;</span></span><span>
</span><span id="line-137"></span><span>  </span><span class="annot"><span class="annottext">Command a
</span><a href="Unison.Codebase.Editor.Command.html#Abort"><span class="hs-identifier hs-var">Abort</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WatchKind
</span><span class="hs-string">&quot;Abort&quot;</span></span><span>
</span><span id="line-138"></span><span>  </span><span class="annot"><span class="annottext">Command a
</span><a href="Unison.Codebase.Editor.Command.html#Quit"><span class="hs-identifier hs-var">Quit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WatchKind
</span><span class="hs-string">&quot;Quit&quot;</span></span><span>
</span><span id="line-139"></span><span>  </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#WithRunInIO"><span class="hs-identifier hs-type">WithRunInIO</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WatchKind
</span><span class="hs-string">&quot;WithRunInIO&quot;</span></span><span>
</span><span id="line-140"></span><span>  </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WatchKind
</span><span class="hs-string">&quot;Eval&quot;</span></span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span class="hs-keyword">data</span><span> </span><span id="LoopState"><span class="annot"><a href="Unison.Codebase.Editor.Command.html#LoopState"><span class="hs-identifier hs-var">LoopState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="LoopState"><span class="annot"><a href="Unison.Codebase.Editor.Command.html#LoopState"><span class="hs-identifier hs-var">LoopState</span></a></span></span><span>
</span><span id="line-143"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="%24sel%3A_root%3ALoopState"><span class="annot"><span class="annottext">LoopState -&gt; Branch IO
</span><a href="Unison.Codebase.Editor.Command.html#%24sel%3A_root%3ALoopState"><span class="hs-identifier hs-var hs-var">_root</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Branch</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span class="hs-special">,</span><span>
</span><span id="line-144"></span><span>    </span><span id="%24sel%3A_lastSavedRoot%3ALoopState"><span class="annot"><span class="annottext">LoopState -&gt; Branch IO
</span><a href="Unison.Codebase.Editor.Command.html#%24sel%3A_lastSavedRoot%3ALoopState"><span class="hs-identifier hs-var hs-var">_lastSavedRoot</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Branch</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span class="hs-special">,</span><span>
</span><span id="line-145"></span><span>    </span><span class="hs-comment">-- the current position in the namespace</span><span>
</span><span id="line-146"></span><span>    </span><span id="%24sel%3A_currentPathStack%3ALoopState"><span class="annot"><span class="annottext">LoopState -&gt; NonEmpty Absolute
</span><a href="Unison.Codebase.Editor.Command.html#%24sel%3A_currentPathStack%3ALoopState"><span class="hs-identifier hs-var hs-var">_currentPathStack</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Path.Absolute</span></span><span class="hs-special">,</span><span>
</span><span id="line-147"></span><span>    </span><span class="hs-comment">-- TBD</span><span>
</span><span id="line-148"></span><span>    </span><span class="hs-comment">-- , _activeEdits :: Set Branch.EditGuid</span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span>    </span><span class="hs-comment">-- The file name last modified, and whether to skip the next file</span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-comment">-- change event for that path (we skip file changes if the file has</span><span>
</span><span id="line-152"></span><span>    </span><span class="hs-comment">-- just been modified programmatically)</span><span>
</span><span id="line-153"></span><span>    </span><span id="%24sel%3A_latestFile%3ALoopState"><span class="annot"><span class="annottext">LoopState -&gt; Maybe (WatchKind, IsCacheHit)
</span><a href="Unison.Codebase.Editor.Command.html#%24sel%3A_latestFile%3ALoopState"><span class="hs-identifier hs-var hs-var">_latestFile</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#SkipNextUpdate"><span class="hs-identifier hs-type">SkipNextUpdate</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-154"></span><span>    </span><span id="%24sel%3A_latestTypecheckedFile%3ALoopState"><span class="annot"><span class="annottext">LoopState -&gt; Maybe (TypecheckedUnisonFile Symbol Ann)
</span><a href="Unison.Codebase.Editor.Command.html#%24sel%3A_latestTypecheckedFile%3ALoopState"><span class="hs-identifier hs-var hs-var">_latestTypecheckedFile</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UF.TypecheckedUnisonFile</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ann</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-155"></span><span>    </span><span class="hs-comment">-- The previous user input. Used to request confirmation of</span><span>
</span><span id="line-156"></span><span>    </span><span class="hs-comment">-- questionable user commands.</span><span>
</span><span id="line-157"></span><span>    </span><span id="%24sel%3A_lastInput%3ALoopState"><span class="annot"><span class="annottext">LoopState -&gt; Maybe Input
</span><a href="Unison.Codebase.Editor.Command.html#%24sel%3A_lastInput%3ALoopState"><span class="hs-identifier hs-var hs-var">_lastInput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Input.html#Input"><span class="hs-identifier hs-type">Input</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-158"></span><span>    </span><span class="hs-comment">-- A 1-indexed list of strings that can be referenced by index at the</span><span>
</span><span id="line-159"></span><span>    </span><span class="hs-comment">-- CLI prompt.  e.g. Given [&quot;Foo.bat&quot;, &quot;Foo.cat&quot;],</span><span>
</span><span id="line-160"></span><span>    </span><span class="hs-comment">-- `rename 2 Foo.foo` will rename `Foo.cat` to `Foo.foo`.</span><span>
</span><span id="line-161"></span><span>    </span><span id="%24sel%3A_numberedArgs%3ALoopState"><span class="annot"><span class="annottext">LoopState -&gt; NumberedArgs
</span><a href="Unison.Codebase.Editor.Command.html#%24sel%3A_numberedArgs%3ALoopState"><span class="hs-identifier hs-var hs-var">_numberedArgs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Output.html#NumberedArgs"><span class="hs-identifier hs-type">NumberedArgs</span></a></span><span>
</span><span id="line-162"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="hs-keyword">type</span><span> </span><span id="SkipNextUpdate"><span class="annot"><a href="Unison.Codebase.Editor.Command.html#SkipNextUpdate"><span class="hs-identifier hs-var">SkipNextUpdate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="hs-keyword">data</span><span> </span><span id="Env"><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Env"><span class="hs-identifier hs-var">Env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Env"><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Env"><span class="hs-identifier hs-var">Env</span></a></span></span><span>
</span><span id="line-167"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="%24sel%3AauthHTTPClient%3AEnv"><span class="annot"><span class="annottext">Env -&gt; AuthenticatedHttpClient
</span><a href="Unison.Codebase.Editor.Command.html#%24sel%3AauthHTTPClient%3AEnv"><span class="hs-identifier hs-var hs-var">authHTTPClient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.Auth.HTTPClient.html#AuthenticatedHttpClient"><span class="hs-identifier hs-type">AuthenticatedHttpClient</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-168"></span><span>    </span><span id="%24sel%3Acodebase%3AEnv"><span class="annot"><span class="annottext">Env -&gt; Codebase IO Symbol Ann
</span><a href="Unison.Codebase.Editor.Command.html#%24sel%3Acodebase%3AEnv"><span class="hs-identifier hs-var hs-var">codebase</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Codebase</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ann</span></span><span class="hs-special">,</span><span>
</span><span id="line-169"></span><span>    </span><span id="%24sel%3Aconfig%3AEnv"><span class="annot"><span class="annottext">Env -&gt; Config
</span><a href="Unison.Codebase.Editor.Command.html#%24sel%3Aconfig%3AEnv"><span class="hs-identifier hs-var hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Configurator.Config</span></span><span class="hs-special">,</span><span>
</span><span id="line-170"></span><span>    </span><span id="%24sel%3AcredentialManager%3AEnv"><span class="annot"><span class="annottext">Env -&gt; CredentialManager
</span><a href="Unison.Codebase.Editor.Command.html#%24sel%3AcredentialManager%3AEnv"><span class="hs-identifier hs-var hs-var">credentialManager</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.Auth.CredentialManager.html#CredentialManager"><span class="hs-identifier hs-type">CredentialManager</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-171"></span><span>    </span><span class="hs-comment">-- | Generate a unique name.</span><span>
</span><span id="line-172"></span><span>    </span><span id="%24sel%3AgenerateUniqueName%3AEnv"><span class="annot"><span class="annottext">Env -&gt; IO UniqueName
</span><a href="Unison.Codebase.Editor.Command.html#%24sel%3AgenerateUniqueName%3AEnv"><span class="hs-identifier hs-var hs-var">generateUniqueName</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser.UniqueName</span></span><span class="hs-special">,</span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-comment">-- | How to load source code.</span><span>
</span><span id="line-174"></span><span>    </span><span id="%24sel%3AloadSource%3AEnv"><span class="annot"><span class="annottext">Env -&gt; SourceName -&gt; IO LoadSourceResult
</span><a href="Unison.Codebase.Editor.Command.html#%24sel%3AloadSource%3AEnv"><span class="hs-identifier hs-var hs-var">loadSource</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#SourceName"><span class="hs-identifier hs-type">SourceName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#LoadSourceResult"><span class="hs-identifier hs-type">LoadSourceResult</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-175"></span><span>    </span><span class="hs-comment">-- | What to do with output for the user.</span><span>
</span><span id="line-176"></span><span>    </span><span id="%24sel%3Anotify%3AEnv"><span class="annot"><span class="annottext">Env -&gt; Output -&gt; IO ()
</span><a href="Unison.Codebase.Editor.Command.html#%24sel%3Anotify%3AEnv"><span class="hs-identifier hs-var hs-var">notify</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Output.html#Output"><span class="hs-identifier hs-type">Output</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-177"></span><span>    </span><span class="hs-comment">-- | What to do with numbered output for the user.</span><span>
</span><span id="line-178"></span><span>    </span><span id="%24sel%3AnotifyNumbered%3AEnv"><span class="annot"><span class="annottext">Env -&gt; NumberedOutput -&gt; IO NumberedArgs
</span><a href="Unison.Codebase.Editor.Command.html#%24sel%3AnotifyNumbered%3AEnv"><span class="hs-identifier hs-var hs-var">notifyNumbered</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Output.html#NumberedOutput"><span class="hs-identifier hs-type">NumberedOutput</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Output.html#NumberedArgs"><span class="hs-identifier hs-type">NumberedArgs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-179"></span><span>    </span><span id="%24sel%3Aruntime%3AEnv"><span class="annot"><span class="annottext">Env -&gt; Runtime Symbol
</span><a href="Unison.Codebase.Editor.Command.html#%24sel%3Aruntime%3AEnv"><span class="hs-identifier hs-var hs-var">runtime</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Runtime</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">,</span><span>
</span><span id="line-180"></span><span>    </span><span id="%24sel%3AsandboxedRuntime%3AEnv"><span class="annot"><span class="annottext">Env -&gt; Runtime Symbol
</span><a href="Unison.Codebase.Editor.Command.html#%24sel%3AsandboxedRuntime%3AEnv"><span class="hs-identifier hs-var hs-var">sandboxedRuntime</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Runtime</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">,</span><span>
</span><span id="line-181"></span><span>    </span><span id="%24sel%3AserverBaseUrl%3AEnv"><span class="annot"><span class="annottext">Env -&gt; Maybe BaseUrl
</span><a href="Unison.Codebase.Editor.Command.html#%24sel%3AserverBaseUrl%3AEnv"><span class="hs-identifier hs-var hs-var">serverBaseUrl</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Server.BaseUrl</span></span><span class="hs-special">,</span><span>
</span><span id="line-182"></span><span>    </span><span id="%24sel%3AucmVersion%3AEnv"><span class="annot"><span class="annottext">Env -&gt; SourceName
</span><a href="Unison.Codebase.Editor.Command.html#%24sel%3AucmVersion%3AEnv"><span class="hs-identifier hs-var hs-var">ucmVersion</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.UCMVersion.html#UCMVersion"><span class="hs-identifier hs-type">UCMVersion</span></a></span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="hs-keyword">newtype</span><span> </span><span id="Action"><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Action"><span class="hs-identifier hs-var">Action</span></a></span></span><span> </span><span id="local-6989586621680023264"><span class="annot"><a href="#local-6989586621680023264"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Action"><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Action"><span class="hs-identifier hs-var">Action</span></a></span></span><span> </span><span class="hs-special">{</span><span id="%24sel%3AunAction%3AAction"><span class="annot"><span class="annottext">Action a -&gt; Free Command a
</span><a href="Unison.Codebase.Editor.Command.html#%24sel%3AunAction%3AAction"><span class="hs-identifier hs-var hs-var">unAction</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Free</span></span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Command"><span class="hs-identifier hs-type">Command</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680023264"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">newtype</span></span><span>
</span><span id="line-187"></span><span>    </span><span class="hs-special">(</span><span> </span><span id="local-6989586621680023095"><span id="local-6989586621680023097"><span class="annot"><span class="annottext">a -&gt; Action b -&gt; Action a
(a -&gt; b) -&gt; Action a -&gt; Action b
(forall a b. (a -&gt; b) -&gt; Action a -&gt; Action b)
-&gt; (forall a b. a -&gt; Action b -&gt; Action a) -&gt; Functor Action
forall a b. a -&gt; Action b -&gt; Action a
forall a b. (a -&gt; b) -&gt; Action a -&gt; Action b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: a -&gt; Action b -&gt; Action a
$c&lt;$ :: forall a b. a -&gt; Action b -&gt; Action a
fmap :: (a -&gt; b) -&gt; Action a -&gt; Action b
$cfmap :: forall a b. (a -&gt; b) -&gt; Action a -&gt; Action b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span>
</span><span id="line-188"></span><span>      </span><span id="local-6989586621680023083"><span id="local-6989586621680023085"><span id="local-6989586621680023087"><span id="local-6989586621680023089"><span id="local-6989586621680023091"><span class="annot"><span class="annottext">Functor Action
a -&gt; Action a
Functor Action
-&gt; (forall a. a -&gt; Action a)
-&gt; (forall a b. Action (a -&gt; b) -&gt; Action a -&gt; Action b)
-&gt; (forall a b c.
    (a -&gt; b -&gt; c) -&gt; Action a -&gt; Action b -&gt; Action c)
-&gt; (forall a b. Action a -&gt; Action b -&gt; Action b)
-&gt; (forall a b. Action a -&gt; Action b -&gt; Action a)
-&gt; Applicative Action
Action a -&gt; Action b -&gt; Action b
Action a -&gt; Action b -&gt; Action a
Action (a -&gt; b) -&gt; Action a -&gt; Action b
(a -&gt; b -&gt; c) -&gt; Action a -&gt; Action b -&gt; Action c
forall a. a -&gt; Action a
forall a b. Action a -&gt; Action b -&gt; Action a
forall a b. Action a -&gt; Action b -&gt; Action b
forall a b. Action (a -&gt; b) -&gt; Action a -&gt; Action b
forall a b c. (a -&gt; b -&gt; c) -&gt; Action a -&gt; Action b -&gt; Action c
forall (f :: * -&gt; *).
Functor f
-&gt; (forall a. a -&gt; f a)
-&gt; (forall a b. f (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c)
-&gt; (forall a b. f a -&gt; f b -&gt; f b)
-&gt; (forall a b. f a -&gt; f b -&gt; f a)
-&gt; Applicative f
&lt;* :: Action a -&gt; Action b -&gt; Action a
$c&lt;* :: forall a b. Action a -&gt; Action b -&gt; Action a
*&gt; :: Action a -&gt; Action b -&gt; Action b
$c*&gt; :: forall a b. Action a -&gt; Action b -&gt; Action b
liftA2 :: (a -&gt; b -&gt; c) -&gt; Action a -&gt; Action b -&gt; Action c
$cliftA2 :: forall a b c. (a -&gt; b -&gt; c) -&gt; Action a -&gt; Action b -&gt; Action c
&lt;*&gt; :: Action (a -&gt; b) -&gt; Action a -&gt; Action b
$c&lt;*&gt; :: forall a b. Action (a -&gt; b) -&gt; Action a -&gt; Action b
pure :: a -&gt; Action a
$cpure :: forall a. a -&gt; Action a
$cp1Applicative :: Functor Action
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Applicative</span></span></span></span></span></span></span><span class="hs-special">,</span><span>
</span><span id="line-189"></span><span>      </span><span id="local-6989586621680023075"><span id="local-6989586621680023077"><span id="local-6989586621680023079"><span class="annot"><span class="annottext">Applicative Action
a -&gt; Action a
Applicative Action
-&gt; (forall a b. Action a -&gt; (a -&gt; Action b) -&gt; Action b)
-&gt; (forall a b. Action a -&gt; Action b -&gt; Action b)
-&gt; (forall a. a -&gt; Action a)
-&gt; Monad Action
Action a -&gt; (a -&gt; Action b) -&gt; Action b
Action a -&gt; Action b -&gt; Action b
forall a. a -&gt; Action a
forall a b. Action a -&gt; Action b -&gt; Action b
forall a b. Action a -&gt; (a -&gt; Action b) -&gt; Action b
forall (m :: * -&gt; *).
Applicative m
-&gt; (forall a b. m a -&gt; (a -&gt; m b) -&gt; m b)
-&gt; (forall a b. m a -&gt; m b -&gt; m b)
-&gt; (forall a. a -&gt; m a)
-&gt; Monad m
return :: a -&gt; Action a
$creturn :: forall a. a -&gt; Action a
&gt;&gt; :: Action a -&gt; Action b -&gt; Action b
$c&gt;&gt; :: forall a b. Action a -&gt; Action b -&gt; Action b
&gt;&gt;= :: Action a -&gt; (a -&gt; Action b) -&gt; Action b
$c&gt;&gt;= :: forall a b. Action a -&gt; (a -&gt; Action b) -&gt; Action b
$cp1Monad :: Applicative Action
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monad</span></span></span></span></span><span class="hs-special">,</span><span>
</span><span id="line-190"></span><span>      </span><span id="local-6989586621680023071"><span class="annot"><span class="annottext">Monad Action
Monad Action -&gt; (forall a. IO a -&gt; Action a) -&gt; MonadIO Action
IO a -&gt; Action a
forall a. IO a -&gt; Action a
forall (m :: * -&gt; *).
Monad m -&gt; (forall a. IO a -&gt; m a) -&gt; MonadIO m
liftIO :: IO a -&gt; Action a
$cliftIO :: forall a. IO a -&gt; Action a
$cp1MonadIO :: Monad Action
</span><a href="#local-6989586621680023071"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var">MonadIO</span></a></span></span><span>
</span><span id="line-191"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680023066"><span class="annot"><span class="hs-identifier hs-type">MonadReader</span></span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Action"><span class="hs-identifier hs-type">Action</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-194"></span><span>  </span><span id="local-6989586621680023064"><span class="annot"><span class="annottext">ask :: Action Env
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">ask</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Free Command Env -&gt; Action Env
forall a. Free Command a -&gt; Action a
</span><a href="Unison.Codebase.Editor.Command.html#Action"><span class="hs-identifier hs-var">Action</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Command Env -&gt; Free Command Env
forall (f :: * -&gt; *) a. f a -&gt; Free f a
</span><span class="hs-identifier hs-var">Free.eval</span></span><span> </span><span class="annot"><span class="annottext">Command Env
</span><a href="Unison.Codebase.Editor.Command.html#AskEnv"><span class="hs-identifier hs-var">AskEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>  </span><span id="local-6989586621680023062"><span class="annot"><span class="annottext">local :: (Env -&gt; Env) -&gt; Action a -&gt; Action a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">local</span></span></span><span> </span><span id="local-6989586621680023060"><span class="annot"><span class="annottext">Env -&gt; Env
</span><a href="#local-6989586621680023060"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span id="local-6989586621680023059"><span class="annot"><span class="annottext">Free Command a
</span><a href="#local-6989586621680023059"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Free Command a -&gt; Action a
forall a. Free Command a -&gt; Action a
</span><a href="Unison.Codebase.Editor.Command.html#Action"><span class="hs-identifier hs-var">Action</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Command a -&gt; Free Command a
forall (f :: * -&gt; *) a. f a -&gt; Free f a
</span><span class="hs-identifier hs-var">Free.eval</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Env -&gt; Env) -&gt; Free Command a -&gt; Command a
forall a. (Env -&gt; Env) -&gt; Free Command a -&gt; Command a
</span><a href="Unison.Codebase.Editor.Command.html#LocalEnv"><span class="hs-identifier hs-var">LocalEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Env -&gt; Env
</span><a href="#local-6989586621680023060"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Free Command a
</span><a href="#local-6989586621680023059"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680023054"><span class="annot"><span class="hs-identifier hs-type">MonadState</span></span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#LoopState"><span class="hs-identifier hs-type">LoopState</span></a></span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Action"><span class="hs-identifier hs-type">Action</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-198"></span><span>  </span><span id="local-6989586621680023052"><span class="annot"><span class="annottext">get :: Action LoopState
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Free Command LoopState -&gt; Action LoopState
forall a. Free Command a -&gt; Action a
</span><a href="Unison.Codebase.Editor.Command.html#Action"><span class="hs-identifier hs-var">Action</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Command LoopState -&gt; Free Command LoopState
forall (f :: * -&gt; *) a. f a -&gt; Free f a
</span><span class="hs-identifier hs-var">Free.eval</span></span><span> </span><span class="annot"><span class="annottext">Command LoopState
</span><a href="Unison.Codebase.Editor.Command.html#GetLoopState"><span class="hs-identifier hs-var">GetLoopState</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>  </span><span id="local-6989586621680023050"><span class="annot"><span class="annottext">put :: LoopState -&gt; Action ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">put</span></span></span><span> </span><span id="local-6989586621680023048"><span class="annot"><span class="annottext">LoopState
</span><a href="#local-6989586621680023048"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Free Command () -&gt; Action ()
forall a. Free Command a -&gt; Action a
</span><a href="Unison.Codebase.Editor.Command.html#Action"><span class="hs-identifier hs-var">Action</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Command () -&gt; Free Command ()
forall (f :: * -&gt; *) a. f a -&gt; Free f a
</span><span class="hs-identifier hs-var">Free.eval</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LoopState -&gt; Command ()
</span><a href="Unison.Codebase.Editor.Command.html#PutLoopState"><span class="hs-identifier hs-var">PutLoopState</span></a></span><span> </span><span class="annot"><span class="annottext">LoopState
</span><a href="#local-6989586621680023048"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadUnliftIO</span></span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-202"></span><span>  </span><span id="local-6989586621680023044"><span class="annot"><span class="annottext">withRunInIO :: ((forall a. Action a -&gt; IO a) -&gt; IO b) -&gt; Action b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">withRunInIO</span></span></span><span> </span><span id="local-6989586621680023042"><span class="annot"><span class="annottext">(forall a. Action a -&gt; IO a) -&gt; IO b
</span><a href="#local-6989586621680023042"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Free Command b -&gt; Action b
forall a. Free Command a -&gt; Action a
</span><a href="Unison.Codebase.Editor.Command.html#Action"><span class="hs-identifier hs-var">Action</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Command b -&gt; Free Command b
forall (f :: * -&gt; *) a. f a -&gt; Free f a
</span><span class="hs-identifier hs-var">Free.eval</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((forall a. Action a -&gt; IO a) -&gt; IO b) -&gt; Command b
forall a. ((forall a. Action a -&gt; IO a) -&gt; IO a) -&gt; Command a
</span><a href="Unison.Codebase.Editor.Command.html#WithRunInIO"><span class="hs-identifier hs-var">WithRunInIO</span></a></span><span> </span><span class="annot"><span class="annottext">(forall a. Action a -&gt; IO a) -&gt; IO b
</span><a href="#local-6989586621680023042"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span id="local-6989586621680023041"><span class="annot"><a href="Unison.Codebase.Editor.Command.html#abort"><span class="hs-identifier hs-type">abort</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680023041"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-205"></span><span id="abort"><span class="annot"><span class="annottext">abort :: Action a
</span><a href="Unison.Codebase.Editor.Command.html#abort"><span class="hs-identifier hs-var hs-var">abort</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Free Command a -&gt; Action a
forall a. Free Command a -&gt; Action a
</span><a href="Unison.Codebase.Editor.Command.html#Action"><span class="hs-identifier hs-var">Action</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Command a -&gt; Free Command a
forall (f :: * -&gt; *) a. f a -&gt; Free f a
</span><span class="hs-identifier hs-var">Free.eval</span></span><span> </span><span class="annot"><span class="annottext">Command a
forall a. Command a
</span><a href="Unison.Codebase.Editor.Command.html#Abort"><span class="hs-identifier hs-var">Abort</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span id="local-6989586621680023040"><span class="annot"><a href="Unison.Codebase.Editor.Command.html#quit"><span class="hs-identifier hs-type">quit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680023040"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-208"></span><span id="quit"><span class="annot"><span class="annottext">quit :: Action a
</span><a href="Unison.Codebase.Editor.Command.html#quit"><span class="hs-identifier hs-var hs-var">quit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Free Command a -&gt; Action a
forall a. Free Command a -&gt; Action a
</span><a href="Unison.Codebase.Editor.Command.html#Action"><span class="hs-identifier hs-var">Action</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Command a -&gt; Free Command a
forall (f :: * -&gt; *) a. f a -&gt; Free f a
</span><span class="hs-identifier hs-var">Free.eval</span></span><span> </span><span class="annot"><span class="annottext">Command a
forall a. Command a
</span><a href="Unison.Codebase.Editor.Command.html#Quit"><span class="hs-identifier hs-var">Quit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span id="local-6989586621680023039"><span class="annot"><a href="Unison.Codebase.Editor.Command.html#eval"><span class="hs-identifier hs-type">eval</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Command"><span class="hs-identifier hs-type">Command</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680023039"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680023039"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-211"></span><span id="eval"><span class="annot"><span class="annottext">eval :: Command a -&gt; Action a
</span><a href="Unison.Codebase.Editor.Command.html#eval"><span class="hs-identifier hs-var hs-var">eval</span></a></span></span><span> </span><span id="local-6989586621680023038"><span class="annot"><span class="annottext">Command a
</span><a href="#local-6989586621680023038"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Free Command a -&gt; Action a
forall a. Free Command a -&gt; Action a
</span><a href="Unison.Codebase.Editor.Command.html#Action"><span class="hs-identifier hs-var">Action</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Command a -&gt; Free Command a
forall (f :: * -&gt; *) a. f a -&gt; Free f a
</span><span class="hs-identifier hs-var">Free.eval</span></span><span> </span><span class="annot"><span class="annottext">Command a
</span><a href="#local-6989586621680023038"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span class="hs-comment">-- | Acquire a resource for the duration of an action.</span><span>
</span><span id="line-214"></span><span id="local-6989586621680023037"><span class="annot"><a href="Unison.Codebase.Editor.Command.html#with"><span class="hs-identifier hs-type">with</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680023245"><span class="annot"><a href="#local-6989586621680023245"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680023037"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621680023245"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621680023245"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680023037"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-215"></span><span id="with"><span class="annot"><span class="annottext">with :: (forall b. (a -&gt; IO b) -&gt; IO b) -&gt; Action a
</span><a href="Unison.Codebase.Editor.Command.html#with"><span class="hs-identifier hs-var hs-var">with</span></a></span></span><span> </span><span id="local-6989586621680023036"><span class="annot"><span class="annottext">forall b. (a -&gt; IO b) -&gt; IO b
</span><a href="#local-6989586621680023036"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Free Command a -&gt; Action a
forall a. Free Command a -&gt; Action a
</span><a href="Unison.Codebase.Editor.Command.html#Action"><span class="hs-identifier hs-var">Action</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Command a -&gt; Free Command a
forall (f :: * -&gt; *) a. f a -&gt; Free f a
</span><span class="hs-identifier hs-var">Free.eval</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall b. (a -&gt; IO b) -&gt; IO b) -&gt; Command a
forall a. (forall r. (a -&gt; IO r) -&gt; IO r) -&gt; Command a
</span><a href="Unison.Codebase.Editor.Command.html#WithResource"><span class="hs-identifier hs-var">WithResource</span></a></span><span> </span><span class="annot"><span class="annottext">forall b. (a -&gt; IO b) -&gt; IO b
</span><a href="#local-6989586621680023036"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span class="hs-comment">-- | Delimit the scope of inner 'with' actions.</span><span>
</span><span id="line-218"></span><span id="local-6989586621680023035"><span class="annot"><a href="Unison.Codebase.Editor.Command.html#reset"><span class="hs-identifier hs-type">reset</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680023035"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680023035"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-219"></span><span id="reset"><span class="annot"><span class="annottext">reset :: Action a -&gt; Action a
</span><a href="Unison.Codebase.Editor.Command.html#reset"><span class="hs-identifier hs-var hs-var">reset</span></a></span></span><span> </span><span id="local-6989586621680023034"><span class="annot"><span class="annottext">Action a
</span><a href="#local-6989586621680023034"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Free Command a -&gt; Action a
forall a. Free Command a -&gt; Action a
</span><a href="Unison.Codebase.Editor.Command.html#Action"><span class="hs-identifier hs-var">Action</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Command a -&gt; Free Command a
forall (f :: * -&gt; *) a. f a -&gt; Free f a
</span><span class="hs-identifier hs-var">Free.eval</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Action a -&gt; Command a
forall a. Action a -&gt; Command a
</span><a href="Unison.Codebase.Editor.Command.html#Reset"><span class="hs-identifier hs-var">Reset</span></a></span><span> </span><span class="annot"><span class="annottext">Action a
</span><a href="#local-6989586621680023034"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span id="latestTypecheckedFile"><span id="latestFile"><span id="lastSavedRoot"><span id="lastInput"><span id="currentPathStack"><span id="numberedArgs"><span id="root"><span class="hs-identifier">makeLenses</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">LoopState</span></span></span></span></span></span></span></span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span class="hs-comment">-- replacing the old read/write scalar Lens with &quot;peek&quot; Getter for the NonEmpty</span><span>
</span><span id="line-224"></span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#currentPath"><span class="hs-identifier hs-type">currentPath</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Getter</span></span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#LoopState"><span class="hs-identifier hs-type">LoopState</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Path.Absolute</span></span><span>
</span><span id="line-225"></span><span id="currentPath"><span class="annot"><span class="annottext">currentPath :: (Absolute -&gt; f Absolute) -&gt; LoopState -&gt; f LoopState
</span><a href="Unison.Codebase.Editor.Command.html#currentPath"><span class="hs-identifier hs-var hs-var">currentPath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NonEmpty Absolute -&gt; f (NonEmpty Absolute))
-&gt; LoopState -&gt; f LoopState
Lens' LoopState (NonEmpty Absolute)
</span><a href="Unison.Codebase.Editor.Command.html#currentPathStack"><span class="hs-identifier hs-var">currentPathStack</span></a></span><span> </span><span class="annot"><span class="annottext">((NonEmpty Absolute -&gt; f (NonEmpty Absolute))
 -&gt; LoopState -&gt; f LoopState)
-&gt; ((Absolute -&gt; f Absolute)
    -&gt; NonEmpty Absolute -&gt; f (NonEmpty Absolute))
-&gt; (Absolute -&gt; f Absolute)
-&gt; LoopState
-&gt; f LoopState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(NonEmpty Absolute -&gt; Absolute)
-&gt; (Absolute -&gt; f Absolute)
-&gt; NonEmpty Absolute
-&gt; f (NonEmpty Absolute)
forall (p :: * -&gt; * -&gt; *) (f :: * -&gt; *) s a.
(Profunctor p, Contravariant f) =&gt;
(s -&gt; a) -&gt; Optic' p f s a
</span><span class="hs-identifier hs-var">to</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty Absolute -&gt; Absolute
forall a. NonEmpty a -&gt; a
</span><span class="hs-identifier hs-var">Nel.head</span></span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#loopState0"><span class="hs-identifier hs-type">loopState0</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Branch</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Path.Absolute</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#LoopState"><span class="hs-identifier hs-type">LoopState</span></a></span><span>
</span><span id="line-228"></span><span id="loopState0"><span class="annot"><span class="annottext">loopState0 :: Branch IO -&gt; Absolute -&gt; LoopState
</span><a href="Unison.Codebase.Editor.Command.html#loopState0"><span class="hs-identifier hs-var hs-var">loopState0</span></a></span></span><span> </span><span id="local-6989586621680023031"><span class="annot"><span class="annottext">Branch IO
</span><a href="#local-6989586621680023031"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680023030"><span class="annot"><span class="annottext">Absolute
</span><a href="#local-6989586621680023030"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-229"></span><span>  </span><span class="annot"><span class="annottext">LoopState :: Branch IO
-&gt; Branch IO
-&gt; NonEmpty Absolute
-&gt; Maybe (WatchKind, IsCacheHit)
-&gt; Maybe (TypecheckedUnisonFile Symbol Ann)
-&gt; Maybe Input
-&gt; NumberedArgs
-&gt; LoopState
</span><a href="Unison.Codebase.Editor.Command.html#LoopState"><span class="hs-identifier hs-type">LoopState</span></a></span><span>
</span><span id="line-230"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:_root:LoopState :: Branch IO
</span><a href="Unison.Codebase.Editor.Command.html#%24sel%3A_root%3ALoopState"><span class="hs-identifier hs-var">_root</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Branch IO
</span><a href="#local-6989586621680023031"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-231"></span><span>      </span><span class="annot"><span class="annottext">$sel:_lastSavedRoot:LoopState :: Branch IO
</span><a href="Unison.Codebase.Editor.Command.html#%24sel%3A_lastSavedRoot%3ALoopState"><span class="hs-identifier hs-var">_lastSavedRoot</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Branch IO
</span><a href="#local-6989586621680023031"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-232"></span><span>      </span><span class="annot"><span class="annottext">$sel:_currentPathStack:LoopState :: NonEmpty Absolute
</span><a href="Unison.Codebase.Editor.Command.html#%24sel%3A_currentPathStack%3ALoopState"><span class="hs-identifier hs-var">_currentPathStack</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Absolute -&gt; NonEmpty Absolute
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Absolute
</span><a href="#local-6989586621680023030"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-233"></span><span>      </span><span class="annot"><span class="annottext">$sel:_latestFile:LoopState :: Maybe (WatchKind, IsCacheHit)
</span><a href="Unison.Codebase.Editor.Command.html#%24sel%3A_latestFile%3ALoopState"><span class="hs-identifier hs-var">_latestFile</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (WatchKind, IsCacheHit)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span>
</span><span id="line-234"></span><span>      </span><span class="annot"><span class="annottext">$sel:_latestTypecheckedFile:LoopState :: Maybe (TypecheckedUnisonFile Symbol Ann)
</span><a href="Unison.Codebase.Editor.Command.html#%24sel%3A_latestTypecheckedFile%3ALoopState"><span class="hs-identifier hs-var">_latestTypecheckedFile</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (TypecheckedUnisonFile Symbol Ann)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span>
</span><span id="line-235"></span><span>      </span><span class="annot"><span class="annottext">$sel:_lastInput:LoopState :: Maybe Input
</span><a href="Unison.Codebase.Editor.Command.html#%24sel%3A_lastInput%3ALoopState"><span class="hs-identifier hs-var">_lastInput</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Input
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span>
</span><span id="line-236"></span><span>      </span><span class="annot"><span class="annottext">$sel:_numberedArgs:LoopState :: NumberedArgs
</span><a href="Unison.Codebase.Editor.Command.html#%24sel%3A_numberedArgs%3ALoopState"><span class="hs-identifier hs-var">_numberedArgs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-237"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#respond"><span class="hs-identifier hs-type">respond</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Output.html#Output"><span class="hs-identifier hs-type">Output</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span id="respond"><span class="annot"><span class="annottext">respond :: Output -&gt; Action ()
</span><a href="Unison.Codebase.Editor.Command.html#respond"><span class="hs-identifier hs-var hs-var">respond</span></a></span></span><span> </span><span id="local-6989586621680023029"><span class="annot"><span class="annottext">Output
</span><a href="#local-6989586621680023029"><span class="hs-identifier hs-var">output</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-241"></span><span>  </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621680023028"><span class="annot"><span class="annottext">Output -&gt; IO ()
notify :: Output -&gt; IO ()
$sel:notify:Env :: Env -&gt; Output -&gt; IO ()
</span><a href="#local-6989586621680023028"><span class="hs-identifier hs-var hs-var">notify</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Action Env
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-242"></span><span>  </span><span class="annot"><span class="annottext">IO () -&gt; Action ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Output -&gt; IO ()
</span><a href="#local-6989586621680023028"><span class="hs-identifier hs-var">notify</span></a></span><span> </span><span class="annot"><span class="annottext">Output
</span><a href="#local-6989586621680023029"><span class="hs-identifier hs-var">output</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#respondNumbered"><span class="hs-identifier hs-type">respondNumbered</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Output.html#NumberedOutput"><span class="hs-identifier hs-type">NumberedOutput</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span id="respondNumbered"><span class="annot"><span class="annottext">respondNumbered :: NumberedOutput -&gt; Action ()
</span><a href="Unison.Codebase.Editor.Command.html#respondNumbered"><span class="hs-identifier hs-var hs-var">respondNumbered</span></a></span></span><span> </span><span id="local-6989586621680023027"><span class="annot"><span class="annottext">NumberedOutput
</span><a href="#local-6989586621680023027"><span class="hs-identifier hs-var">output</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-246"></span><span>  </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621680023026"><span class="annot"><span class="annottext">NumberedOutput -&gt; IO NumberedArgs
notifyNumbered :: NumberedOutput -&gt; IO NumberedArgs
$sel:notifyNumbered:Env :: Env -&gt; NumberedOutput -&gt; IO NumberedArgs
</span><a href="#local-6989586621680023026"><span class="hs-identifier hs-var hs-var">notifyNumbered</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Action Env
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-247"></span><span>  </span><span id="local-6989586621680023025"><span class="annot"><span class="annottext">NumberedArgs
</span><a href="#local-6989586621680023025"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO NumberedArgs -&gt; Action NumberedArgs
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumberedOutput -&gt; IO NumberedArgs
</span><a href="#local-6989586621680023026"><span class="hs-identifier hs-var">notifyNumbered</span></a></span><span> </span><span class="annot"><span class="annottext">NumberedOutput
</span><a href="#local-6989586621680023027"><span class="hs-identifier hs-var">output</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span>  </span><span class="annot"><span class="annottext">IsCacheHit -&gt; Action () -&gt; Action ()
forall (f :: * -&gt; *). Applicative f =&gt; IsCacheHit -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumberedArgs -&gt; IsCacheHit
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; IsCacheHit
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">NumberedArgs
</span><a href="#local-6989586621680023025"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Action () -&gt; Action ()) -&gt; Action () -&gt; Action ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-249"></span><span>    </span><span class="annot"><span class="annottext">(NumberedArgs -&gt; Identity NumberedArgs)
-&gt; LoopState -&gt; Identity LoopState
Lens' LoopState NumberedArgs
</span><a href="Unison.Codebase.Editor.Command.html#numberedArgs"><span class="hs-identifier hs-var">numberedArgs</span></a></span><span> </span><span class="annot"><span class="annottext">((NumberedArgs -&gt; Identity NumberedArgs)
 -&gt; LoopState -&gt; Identity LoopState)
-&gt; NumberedArgs -&gt; Action ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">NumberedArgs -&gt; NumberedArgs
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">NumberedArgs
</span><a href="#local-6989586621680023025"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span class="hs-comment">-- | Get the codebase out of the environment.</span><span>
</span><span id="line-252"></span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#askCodebase"><span class="hs-identifier hs-type">askCodebase</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Codebase</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ann</span></span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span id="askCodebase"><span class="annot"><span class="annottext">askCodebase :: Action (Codebase IO Symbol Ann)
</span><a href="Unison.Codebase.Editor.Command.html#askCodebase"><span class="hs-identifier hs-var hs-var">askCodebase</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-254"></span><span>  </span><span class="annot"><span class="annottext">(Env -&gt; Codebase IO Symbol Ann) -&gt; Action (Codebase IO Symbol Ann)
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">Env -&gt; Codebase IO Symbol Ann
</span><a href="Unison.Codebase.Editor.Command.html#%24sel%3Acodebase%3AEnv"><span class="hs-identifier hs-var hs-var">codebase</span></a></span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span class="hs-comment">-- | Get an action that generates a unique name out of the environment.</span><span>
</span><span id="line-257"></span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#askGenerateUniqueName"><span class="hs-identifier hs-type">askGenerateUniqueName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser.UniqueName</span></span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span id="askGenerateUniqueName"><span class="annot"><span class="annottext">askGenerateUniqueName :: Action (IO UniqueName)
</span><a href="Unison.Codebase.Editor.Command.html#askGenerateUniqueName"><span class="hs-identifier hs-var hs-var">askGenerateUniqueName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-259"></span><span>  </span><span class="annot"><span class="annottext">(Env -&gt; IO UniqueName) -&gt; Action (IO UniqueName)
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">Env -&gt; IO UniqueName
</span><a href="Unison.Codebase.Editor.Command.html#%24sel%3AgenerateUniqueName%3AEnv"><span class="hs-identifier hs-var hs-var">generateUniqueName</span></a></span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span class="hs-comment">-- | Get how to load source code out of the environment.</span><span>
</span><span id="line-262"></span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#askLoadSource"><span class="hs-identifier hs-type">askLoadSource</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#SourceName"><span class="hs-identifier hs-type">SourceName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#LoadSourceResult"><span class="hs-identifier hs-type">LoadSourceResult</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span id="askLoadSource"><span class="annot"><span class="annottext">askLoadSource :: Action (SourceName -&gt; IO LoadSourceResult)
</span><a href="Unison.Codebase.Editor.Command.html#askLoadSource"><span class="hs-identifier hs-var hs-var">askLoadSource</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-264"></span><span>  </span><span class="annot"><span class="annottext">(Env -&gt; SourceName -&gt; IO LoadSourceResult)
-&gt; Action (SourceName -&gt; IO LoadSourceResult)
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">Env -&gt; SourceName -&gt; IO LoadSourceResult
</span><a href="Unison.Codebase.Editor.Command.html#%24sel%3AloadSource%3AEnv"><span class="hs-identifier hs-var hs-var">loadSource</span></a></span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span class="hs-comment">-- | Get the runtime out of the environment.</span><span>
</span><span id="line-267"></span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#askRuntime"><span class="hs-identifier hs-type">askRuntime</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Runtime</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span>
</span><span id="line-268"></span><span id="askRuntime"><span class="annot"><span class="annottext">askRuntime :: Action (Runtime Symbol)
</span><a href="Unison.Codebase.Editor.Command.html#askRuntime"><span class="hs-identifier hs-var hs-var">askRuntime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-269"></span><span>  </span><span class="annot"><span class="annottext">(Env -&gt; Runtime Symbol) -&gt; Action (Runtime Symbol)
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">Env -&gt; Runtime Symbol
</span><a href="Unison.Codebase.Editor.Command.html#%24sel%3Aruntime%3AEnv"><span class="hs-identifier hs-var hs-var">runtime</span></a></span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span class="hs-comment">-- | Get the sandboxed runtime out of the environment.</span><span>
</span><span id="line-272"></span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#askSandboxedRuntime"><span class="hs-identifier hs-type">askSandboxedRuntime</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Runtime</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span id="askSandboxedRuntime"><span class="annot"><span class="annottext">askSandboxedRuntime :: Action (Runtime Symbol)
</span><a href="Unison.Codebase.Editor.Command.html#askSandboxedRuntime"><span class="hs-identifier hs-var hs-var">askSandboxedRuntime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-274"></span><span>  </span><span class="annot"><span class="annottext">(Env -&gt; Runtime Symbol) -&gt; Action (Runtime Symbol)
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">Env -&gt; Runtime Symbol
</span><a href="Unison.Codebase.Editor.Command.html#%24sel%3AsandboxedRuntime%3AEnv"><span class="hs-identifier hs-var hs-var">sandboxedRuntime</span></a></span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span class="hs-comment">-- | Get the server base url out of the environment.</span><span>
</span><span id="line-277"></span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#askServerBaseUrl"><span class="hs-identifier hs-type">askServerBaseUrl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Server.BaseUrl</span></span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span id="askServerBaseUrl"><span class="annot"><span class="annottext">askServerBaseUrl :: Action (Maybe BaseUrl)
</span><a href="Unison.Codebase.Editor.Command.html#askServerBaseUrl"><span class="hs-identifier hs-var hs-var">askServerBaseUrl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-279"></span><span>  </span><span class="annot"><span class="annottext">(Env -&gt; Maybe BaseUrl) -&gt; Action (Maybe BaseUrl)
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">Env -&gt; Maybe BaseUrl
</span><a href="Unison.Codebase.Editor.Command.html#%24sel%3AserverBaseUrl%3AEnv"><span class="hs-identifier hs-var hs-var">serverBaseUrl</span></a></span><span>
</span><span id="line-280"></span><span>
</span><span id="line-281"></span><span class="hs-comment">-- | Lookup a config value by key.</span><span>
</span><span id="line-282"></span><span id="local-6989586621680023021"><span class="annot"><a href="Unison.Codebase.Editor.Command.html#getConfig"><span class="hs-identifier hs-type">getConfig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Configurator.Configured</span></span><span> </span><span class="annot"><a href="#local-6989586621680023021"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Unison.Codebase.Editor.Command.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621680023021"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-283"></span><span id="getConfig"><span class="annot"><span class="annottext">getConfig :: SourceName -&gt; Action (Maybe a)
</span><a href="Unison.Codebase.Editor.Command.html#getConfig"><span class="hs-identifier hs-var hs-var">getConfig</span></a></span></span><span> </span><span id="local-6989586621680023020"><span class="annot"><span class="annottext">SourceName
</span><a href="#local-6989586621680023020"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-284"></span><span>  </span><span id="local-6989586621680023019"><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621680023019"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Env -&gt; Config) -&gt; Action Config
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">Env -&gt; Config
</span><a href="Unison.Codebase.Editor.Command.html#%24sel%3Aconfig%3AEnv"><span class="hs-identifier hs-var hs-var">config</span></a></span><span>
</span><span id="line-285"></span><span>  </span><span class="annot"><span class="annottext">IO (Maybe a) -&gt; Action (Maybe a)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Config -&gt; SourceName -&gt; IO (Maybe a)
forall a. Configured a =&gt; Config -&gt; SourceName -&gt; IO (Maybe a)
</span><span class="hs-identifier hs-var">Configurator.lookup</span></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621680023019"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="annot"><span class="annottext">SourceName
</span><a href="#local-6989586621680023020"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span>
</span><span id="line-287"></span><span class="hs-keyword">type</span><span> </span><span id="InputDescription"><span class="annot"><a href="Unison.Codebase.Editor.Command.html#InputDescription"><span class="hs-identifier hs-var">InputDescription</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-288"></span></pre></body></html>